\documentclass{article}
% \synctex=1
% \newcommand{\fix}[1]{{\bf *** #1 ***}}
\usepackage{amsfonts,amsmath, amssymb,latexsym,comment, enumerate,mathrsfs,stmaryrd, hyperref, xcolor}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}
\usepackage[OT2,OT1]{fontenc}
\def\SH{\mbox{\fontencoding{OT2}\selectfont\char88}}
%,mathrsfs,array}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\usepackage{multirow}
\usepackage[all]{xy}
%\usepackage{showlabels}
\setlength{\textheight}{8.75in}
\setlength{\textwidth}{6.5in}
\setlength{\topmargin}{0.0in}
\setlength{\headheight}{0.0in}
\setlength{\headsep}{0.0in}
\setlength{\leftmargin}{0.0in}
\setlength{\oddsidemargin}{0.0in}
\setlength{\parindent}{3pc}
\def\Z{{\mathbb Z}}
\def\A{{\mathbb A}}
\def\bbz{{\mathbb Z}}
\def\bbg{{\mathbb G}}
\def\bba{{\mathbb A}}
\def\End{{\rm End}}
\def\SL{{\rm SL}}
\def\s{{\rm s}}
\def\sm{{\rm sm}}
\def\lcm{{\rm lcm}}
\def\odd{{\rm odd}}
\def\even{{\rm even}}
\def\an{{\rm an}}
\def\tr{{\rm tr}}
\def\Tr{{\rm Tr}}
\def\pr{{\rm pr}}
\def\spr{{\rm spr}}
\def\min{{\rm min}}
\def\sk{{\rm sk}}
\def\ind{{\rm ind}}
\def\covol{{\rm covol}}
\def\smax{{\rm smax}}
\def\GL{{\rm GL}}
\def\rad{{\rm rad}}
\def\Rlk{{{\rm Res}_{L/k}}}
\def\tStab{{\rm Stab}}
\def\SO{{\rm SO}}
\def\PSO{{\rm PSO}}
\def\tSpec{{\rm Spec}}
\def\PGL{{\rm PGL}}
\def\Nm{{\rm Nm}}
\def\ca{{\check{a}}}
\def\cb{{\check{b}}}
\def\cI{{\check{I}}}
\def\cJ{{\check{J}}}
\def\ccc{{\check{c}}}
\def\ct{{\rm ct}}
\def\sf{{\rm sf}}
\def\sf{{\rm sf}}
\def\inv{{\rm inv}}
\def\sol{{\rm sol}}
\def\ram{{\rm ram}}
\def\Stab{{\rm Stab}}
\def\Sel{{\rm Sel}}
\def\Inv{{\rm Inv}}
\def\Sym{{\rm Sym}}
\def\Gal{{\rm Gal}}
\def\Cl{{\rm Cl}}
\def\cl{{\rm cl}}
\def\O{{\mathcal O}}
\def\M{{\mathcal M}}
\def\E{{\mathcal E}}
\newcommand{\cO}{{\mathcal O}}
\def\CC{{\mathcal C}}
\def\CS{{\mathcal S}}
\def\B{{\mathcal B}}
\def\P{{\mathbb P}}
\def\I{{\mathrm I}}
\def\Disc{{\rm Disc}}
\def\disc{{\rm disc}}
\def\Det{{\rm Det}}
\def\al{{\alpha}}
\def\Aut{{\rm Aut}}
\def\Pic{{\rm Pic}}
\def\irr{{\rm irr}}
\def\bbp{{\mathbb P}}
\def\sco{{\mathscr O}}
\def\dim{{\rm dim}}
\def\red{{\rm red}}
\def\dcup{{\,\dot\cup}}
\def\pico{{{\rm Pic}^1}}
\def\tTr{{\rm Tr}}
\def\sep{{\rm sep}}
\def\Frob{{\rm Frob}}
\def\tSpan{{\rm Span}}
\def\be{{\beta}}
\def\Gr{{\rm Gr}}
\def\Span{{\rm Span}}
\def\r{{\rm r}}
\def\Res{{\rm Res}}
\def\Vol{{\rm Vol}}
\def\R{{\mathbb R}}
\def\F{{\mathbb F}}
\def\scj{{\mathcal J}}
\def\T{{\mathcal T}}
% \def\L{{\mathcal L}}
\renewcommand{\L}{\mathcal{L}}
\newcommand{\cL}{\mathcal{L}}
\def\tEnd{{\rm End}}
\def\Ind{{\rm Ind}}
\def\tdiv{{\rm div}}
\def\rV{{\mathrm V}}
\def\bbr{{\mathbb R}}
\def\bbq{{\mathbb Q}}
\def\N{{\mathbb N}}
\def\FF{{\mathcal F}}
\def\FFF{{\mathfrak F}}

\def\mfm{{\mathfrak m}}
\def\mfp{{\mathfrak p}}
\def\mfq{{\mathfrak q}}

\def\GG{{\mathcal G}}
\def\RR{{\mathcal R}}
\def\Q{{\mathbb Q}}
\def\bbq{{\mathbb Q}}
\def\sco{{\mathcal O}}
\def\H{{\mathcal H}}
\def\J{{\mathcal J}}
\def\U{{\mathcal U}}
\def\V{{\mathcal V}}
\def\D{{\mathcal D}}
\def\Z{{\mathbb Z}}
\def\G{{\mathbb G}}
\def\P{{\mathbb P}}
\def\F{{\mathbb F}}
\def\Q{{\mathbb Q}}
\def\C{{\mathbb C}}
\def\H{{\mathcal H}}
\def\W{{\mathcal W}}
\def\Sp{{\rm Sp}}
\def\s{{\mathcal S}}
%\def\mathcalJ{{C}}
\def\cc{{\check{c}}}
\def\ci{{\check{I}}}
\def\cj{{\check{J}}}

\def\fz1{{F_{\Z,1}}}
\def\tO{{\rm O}}
\def\tSO{{\rm SO}}
\def\tPSO{{\rm PSO}}
\def\Hom{{\rm Hom}}
\def\PO{{\rm PO}}
\def\tPO{{\rm PO}}
\def\SO{{\rm SO}}
\def\bh{{\bf h}}
\def\ba{{\bf a}}
\def\bb{{\bf b}}
\def\PSO{{\rm PSO}}
\def\max{{\rm max}}
\def\ab{{\rm ab}}
\def\unr{{\rm unr}}
\def\nmax{{\rm nmax}}
\def\LT{{\rm LT}}
\DeclareMathOperator{\nic}{\operatorname{n-ic}}
\def\univ{{\rm univ}}
\def\TT{\mathbb{T}}
\newcommand{\et}{\mathrm{et}}
\newcommand{\kF}{\mathfrak{F}}
\DeclareMathOperator {\spec} {\mathrm{spec}}
\def\v{{\vspace{5pt}}}


\newtheorem{thm}{Theorem}
\newtheorem{theorem}[subsection]{Theorem}
\newtheorem{cor}[subsection]{Corollary}
\newtheorem{lemma}[subsection]{Lemma}
\newtheorem{example}[subsection]{Example}
\newtheorem{remark}[subsection]{Remark}
\newtheorem{proposition}[subsection]{Proposition}
\newtheorem{defn}[subsection]{Definition}
\newenvironment{proof}{\noindent {\bf Proof:}}{$\Box$ \vspace{2 ex}}

\usepackage{xcolor,color,url,lmodern}
\newcommand{\bskip}{\ldots\ldots\ldots \bigskip}
 \newcommand{\micropar}[1]{\marginpar{\raggedright \fontsize{4pt}{1pt}\selectfont\textcolor{gray}{#1}}}
\newcommand{\mpar}[1]{\marginpar{\raggedright \tiny\textcolor{gray}{#1}}}
\newcommand{\add}[1]{{\color{blue} #1}}
\newcommand{\alert}[1]{{\color{red} #1}}

\renewcommand{\lg}[2]{\Big(\frac{#1}{#2}\Big)}
\newcommand{\leg}[2]{\Big(\frac{#1}{#2}\Big)}

\newcommand{\solu}[1]{\noindent{\color{purple} #1}}


\begin{document}
\title{PMATH 145 - Introduction to Number Theory}
\date{}
\maketitle

\section{Greatest Common Divisor}
\begin{center}
    \add{Lecture 1 Wed 09/06}
\end{center}

Number theory is in some sense about the interplay between addition and multiplication. The theorems tend to be very innocent looking but the proofs tend to involve every branch of pure mathematics. For example, Fermat's Last Theorem states that the equation $x^n + y^n = z^n$ has no nonzero integers solutions when $n\geq 3$. The proof by Wiles and Taylor almost 30 years ago uses techniques from geometry, topology, analysis and algebraic number theory. Some examples of innocent looking but unsolved conjectures include Landau's four problems about primes:
\begin{itemize}
    \item (Goldbach) Every even integer at least $4$ is a sum of two primes.
    \item (Twin prime) There are infinitely many primes $p$ such that $p+2$ is prime. 
    \item (Legendre) For any positive integer $n$, there is a prime between $n^2$ and $(n+1)^2$.
    \item (Bunyakovsky) There are infinitely many integers $n$ such that $n^2 + 1$ is prime. 
\end{itemize}
The motivating problem for the first three quarters of this course will be the following result of Dirichlet.

\begin{theorem}
    Suppose $a$ and $m$ are coprime integers. Then there are infinitely many integers $k$ such that $mk + a$ is a prime.
\end{theorem}

We will give proofs of this result for various values of $a$ and $m$ and in the process discuss many abstract ideas in mathematics. You will encounter these ideas again in PMATH 347, 348, 440, 441.

In the beginning, there was nothing. Then god said, let there be $1$. There is not much one can do with just $1$, so addition was added. We can then \textbf{define} $2$ as $1 + 1$ and then $3 = 1 + 2$. We now have two choices for the next number, as $1 + 3$ or as $2 + 2$. Note that
$$1 + 3 = 1 + (1 + 2),\qquad 2 + 2 = (1 + 1) + 2.$$
By requiring that addition is associative, we have that these two numbers are equal and we call it $4$. Continuing forever gives the set of natural numbers
$$\N = \{1,2,3,\ldots\}.$$
We may view the addition $n+m$ as adding $1$ to $n$ a total of $m$ times. 

In order to reverse the process of addition, we need a number that adds $1$ to give $1$. This number is called $0$. Continuing lowering the numbers gives the usual subtraction and expands our set of numbers to the set of integers
$$\Z = \{\ldots,-2,-1,0,1,2,\ldots\}.$$
Another familiar operation now appears. We can define multiplication $n\times m$ as adding $n$ to $0$ a total of $m$ times if $m\geq0$ and as adding $-n$ to $0$ a total of $-m$ times if $m < 0$. The set $\Z$ along with $+,-,\times,0,1$ with the usual laws of arithmetic is a \textbf{commutative ring}. 

In order to reverse the process of multiplication, namely division, the set of rational numbers
$$\Q = \{\frac{a}{b}\colon a,b\in\Z, b\neq 0\}$$
naturally appears. This process in general is called taking the \textbf{field of fractions}.
The next set up is the set $\R$ of real numbers, which is the \textbf{completion} of $\Q$. In other words, one can think of real numbers as limits of sequences of rational numbers that should converge. For example, the sequence $3, 3.1, 3.14, 3.141, 3.1415, \ldots$  should converge and its limit is $\pi$. The sequence $1, -1, 1, -1, \ldots$ shouldn't converge because it keeps fluctuating. ``Should converge'' roughly means that if you go far out enough, any two terms are close enough. The precise terminology is \textbf{Cauchy sequence}, which you will learn in MATH 147. Note here we say two numbers $a,b$ are close if the absolute value $|a - b|$ is small. There are other absolute values that people consider in number theory using prime factorizations, leading to other completions $\Q_p$ of $\Q$.

Finally the set $\R$ is not ``complete'' in the algebraic sense. There are polynomial equations with coefficients in $\R$ that don't have solutions. For example $x^2 + 1 = 0$ has no solutions in $\R$. Adding, or more precisely adjoining, $\sqrt{-1}$ to $\R$, gives the set $\C$ of complex numbers. The quadratic formula then allows us to solve quadratic equations in $\C$. It is only until the 16th century when people wanted to solve cubic equations that we finally sat down to understand how complex numbers work. Around 1800, the Fundamental theorem of Algebra was proved, which states that every non-constant polynomial equation with coefficients in $\C$ has a solution in $\C$. We say $\C$ is \textbf{algebraically closed}. 

At this point, our number system is complete in both analytic and algebraic senses. This is also the reason why you don't hear ``breaking news: mathematicians discovered new numbers''. If we start relaxing the laws of arithmetic, we get the Quarternions where multiplication isn't commutative, or Octonions where multiplication also isn't associative.


\begin{proposition}
The set $\N$ is well-ordered. In other words, every non-empty subset has a smallest element.
\end{proposition}

\begin{proof}
    Let $S$ be a non-empty subset of $\N$. Let $n\in S$ be an element. Let $T = \{x\in S\colon x \leq n\}$. Then $T$ is a non-empty finite set and thus has a smallest element $n_0$. For any $x\in S$, if $x>n$, then $x>n\geq n_0$; if $x\leq n$, then $x\in T$ and so $x\geq n_0$. Therefore, $n_0$ is the smallest element of $S$.
\end{proof}

\begin{cor}
The set $\N\cup\{0\}$ is well-ordered.
\end{cor}

\begin{cor}
    (Induction) For any $n\in\N$, let $P(n)$ be a statement such that the following are true:
    \begin{enumerate}
        \item $P(1)$ is true,
        \item $(P(1)\wedge\cdots\wedge P(n-1))\Rightarrow P(n)$ is true for all integers $n\geq2$.
    \end{enumerate}
    Then $P(n)$ is true for all $n\in\N$.
\end{cor}

\begin{proof}
    Let $S$ be the set of natural numbers $n$ such that $P(n)$ is false. If $S$ is empty, then we are done. Suppose for a contradiction that $S$ is non-empty. Let $m\in S$ be its smallest element. Since $P(1)$ is true, we know that $m\neq 1$ and so $m\geq2$. Since $m$ is the smallest element of $S$, we know that $P(1),\ldots,P(m-1)$ are all true, but then by property 2, we have $P(m)$ is true. Contradiction.
\end{proof}

\noindent\textbf{Remark}: There are variant forms where multiple base cases are needed or where the starting point is $>1$.

\begin{proposition}
    (Division algorithm) Let $a,b$ be integers such that $a>0$. Then there exists integers $q,r$ such that $$b = aq + r,\qquad 0\leq r < a.$$
\end{proposition}

\begin{proof}
    Consider the set $S = \{b - ak\colon k\in\Z, b - ak\geq 0\}$. By taking $k = -|b|$, we have since $a\geq 1$,
    $$b - ka = b + |b|a \geq b + |b| \geq 0.$$
    Hence $S\subseteq \N\cup\{0\}$ is non-empty. Let $r\in S$ be its smallest element. Then $r = b - ak$ for some $k\in\Z$ and $r\geq0$. Let $q = k$ so that $b = aq + r$. It remains to prove that $r < a$. Suppose for a contradiction that $r\geq a$. Then $r-a\geq0$ and $r-a = b-ak-a = b-a(k+1)\in S$. However, $r-a < r$ contradicting the minimality of $r$.
\end{proof}

\noindent\textbf{Remark}: The integers $q,r$ are unique and are called the quotient and remainder when $b$ is divided by $a$. We also have the division algorithm for negative $a$. In general, we have
$$\exists q,r\in\Z,\quad b = aq + r \mbox{ and } 0\leq r < |a|.$$

Suppose we are given two integers $a,b$ not both $0$. Suppose WLOG that $a\neq 0$. Consider $$S = \{ax + by\colon x,y\in\Z, ax + by > 0\}.$$
If $a>0$, then $a = a(1)\in S$. If $a < 0$, then $-a = a(-1)\in S$. Hence $S$ is non-empty. Let $d$ be the smallest element of $S$. Write $d = ax_0 + by_0$ for some $x_0,y_0\in\Z$.

\begin{lemma}
    The number $d$ divides every element of the form $ax + by$ where $x,y\in\Z$. In particular, $d\mid a$ and $d\mid b$.
\end{lemma}

\begin{proof}
    Let $c = ax_1 + by_1$ be an arbitrary element with $x_1,y_1\in\Z$. Suppose for a contradiction that $d\nmid c$. Applying the division algorithm gives $q,r\in \Z$ such that $c = dq + r$ with $0\leq r < d$. The assumption that $d\nmid c$ implies that $r \neq 0$. So $r>0$. Now $$r = c - dq = ax_1 + by_1 - (ax_0 + by_0)q = a(x_1 - x_0q) + b(y_1-y_0q).$$
    Since $r>0$, we have $r\in S$, but this contradicts the minimality of $d$. 
\end{proof}

\begin{lemma}
    Any common divisor of $a,b$ divides $d$. In other words, $d = \gcd(a,b)$ is the \textbf{greatest common divisor} of $a$ and $b$.
\end{lemma}

\begin{proof}
    If $e\mid a$ and $e\mid b$, then $e\mid ax_0 + by_0$. So $e\mid d$.
\end{proof}

We define $\gcd(0,0) = 0$ so that $\gcd(0,a) = |a|$ for any $a\in\Z$.

\begin{cor}
    (Bezout's Lemma) Let $a,b$ be integers. Then there exist integers $x,y$ such that $\gcd(a,b) = ax + by$. 
\end{cor}



\begin{cor}
    Let $a,b$ be integers. Then there exist integers $x,y$ such that $ax + by = 1$ if and only if $\gcd(a,b) = 1$. We say $a$ and $b$ are \textbf{coprime}.
\end{cor}

\begin{proof}
    $(\Leftarrow)$ follows immediately from Bezout's lemma. For $(\Rightarrow)$, we have $1\in S$ and so is its smallest element, implying that $\gcd(a,b) = 1$.
\end{proof}

\noindent\textbf{Example}: (Easiest IMO problem 1959P1) Prove that for any integer $n$, $$\gcd(14n+3, 21n+4) = 1.$$
Follows immediately from $$3(14n+3) + (-2)(21n+4) = 1.$$

\begin{center}
    \add{Lecture 2 Fri 09/08}
\end{center}

\begin{proposition}\label{prop:CAD}
    Let $a,b,c$ be integers such that $\gcd(a,c) = 1$. Then $\gcd(c, ab) = \gcd(c, b)$. In particular, $$c\mid ab \Longleftrightarrow \gcd(c,ab) = c\Longleftrightarrow\gcd(c,b) = c\Longleftrightarrow c\mid b.$$
\end{proposition}

\begin{proof}
    We note that it suffices to prove that 
    \begin{enumerate}[(a)]
        \item $\gcd(c,b) = cx + aby$ for some $x,y\in\Z$,
        \item $\gcd(c, ab) = cx + by$ for some $x,y\in\Z$.
    \end{enumerate}
    Indeed, they would imply that $\gcd(c,ab)\mid\gcd(c,b)$, and $\gcd(c,b)\mid\gcd(c,ab)$, and so $\gcd(c, ab) = \gcd(c, b)$ because they are both non-negative.

    Statement (b) is obvious. We know $\gcd(c,ab) = cx_0 + aby_0$ for some $x_0,y_0\in\Z$. So $x = x_0$ and $y = by_0$ do the job. For statement (a), we have
    \begin{eqnarray*}
        \gcd(c,b) &=& cx_1 + by_1\\
        1 &=& cx_2 + ay_2
    \end{eqnarray*}
    for some integers $x_1,y_1,x_2,y_2$. Multiply them to get
    $$\gcd(c,b) = c(cx_1x_2 + ax_1y_2+bx_2y_1) + ab(y_1y_2).$$
    We take $x = cx_1x_2 + ax_1y_2+bx_2y_1$ and $y = y_1y_2$.
\end{proof}

We can similarly prove that the greatest common divisor $\gcd(a,b,c)$ of three integers $a,b,c$ (that are not all $0$) is the smallest positive integer of the form $ax + by + cz$. Exercise: prove that
$$\gcd(a,b,c) = \gcd(a,\gcd(b,c)).$$



Last time, we give an interpretation of $\gcd(a,b)$ as the smallest positive integer that can be written as an integer combination of $a$ and $b$. For computational purposes, this is pretty useless.

\begin{proposition}
    Let $a,b,q$ be integers. Then $\gcd(a, b) = \gcd(a, b - aq)$.
\end{proposition}

\begin{proof}
    As we saw last time, to prove $\gcd(a,b) = \gcd(c,d)$, it suffices to prove $\gcd(a,b)=cx + dy$ for some $x,y\in\Z$ and $\gcd(c,d) = ax + by$ for some $x,y\in\Z$. This is obvious in this case.
\end{proof}

\noindent\textbf{Euclidean algorithm}: By swapping $a$ and $b$, we may assume $|b|\geq|a|$. If $|b|=|a|$ or if $|a|=0$, then $\gcd(a,b) = |b|$. Suppose $|b|>|a|>0$. Then there is a very natural choice of $q$, namely the quotient when $b$ is divided by $a$, in which case $b - aq$ equals the remainder, which is less than $|a|$. We then repeat this process.

\vspace{5pt}
Note that the above formula holds without requiring $q$ to be the remainder when $b$ is divided by $a$. For example,
$$\gcd(14n+3, 21n+4) = \gcd(14n+3, 21n+4 - (14n+3)) = \gcd(14n+3, 7n+1)$$
and $$\gcd(14n+3, 7n+1) = \gcd(14n+3-(7n+1)2,7n+1) = \gcd(1, 7n+1) = 1.$$

\noindent\textbf{Example}: How many elements does the following set have? $$S = \{\gcd(506-n^2, 506-(n+1)^2)\colon n\in\Z\}.$$
We have
$$\gcd(506-n^2, 506-(n+1)^2) = \gcd(506-n^2, 506-n^2-2n-1) = \gcd(506-n^2, 2n+1).$$
Note that $\gcd(2, 2n+1) = 1$ since $2n+1$ is not divisible by $2$. Hence, we have
\begin{eqnarray*}
    \gcd(506-n^2, 2n+1) &=& \gcd(2(506-n^2),2n+1)\\ &=& \gcd(1012-2n^2+(2n+1)n,2n+1)\\
    &=&\gcd(1012+n, 2n+1)\\
    &=&\gcd(1012+n, (2n+1)-2(1012+n))\\
    &=&\gcd(1012+n, 2023).
\end{eqnarray*}
Now $\gcd(1012+n, 2023)$ is a non-negative divisor of $2023$. Conversely, given any non-negative divisor $d$ of $2023$, by taking $n = d-1012$, we have $\gcd(1012+n,2023) = \gcd(d,2023) = d$. In other words, $S$ is the set of positive divisors of $2023$. The prime factorization of $2023$ is $7\times 17^2$. Hence $2023$ has $6$ positive divisors:
$$1,\quad 17,\quad 17^2,\quad 7,\quad 7\times17,\quad 7\times17^2.$$

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]

    \item Prove that the set $\Z$ with the usual order is not well-ordered.

    \solu{Take $\Z$ as a subset of itself. It's not well-ordered as there's no minimum element. Suppose for a contradiction that $x$ is the smallest element. Then $x-1$ is still in $\Z$; thus $x$ is not the minimum of the subset.}
    
    \item Prove that the set $\Q^{\geq0}$ of non-negative rational numbers with the usual order is not well-ordered.
    
    \solu{We can employ a similar proof by contradiction as in the above exercise. For this problem, given an element $x \in \Q^{\geq 0}$, we take $x/2 < x$ to produce the required contradiction. }
    
    \item Prove that any finite subset of $\R$ with the usual order is well-ordered.

    \solu{Induction on size of the set.}
    
    \item (Uniqueness of division algorithm) Given integers $a,b$ such that $a\neq 0$, prove that the integers $q,r$ such that $b = aq + r$ and $0\leq r < |a|$ are unique.

    \solu{Let $(q,r)$ and $(q',r')$ be two such pairs. Then $a(q-q')=r'-r$, that $a|r'-r$. This indicates that $r=r'$, and thus $q=q'$.}
    
    \item Prove that if $a,b,c\in\Z$ such that $a\mid c$ and $b\mid c$ and $\gcd(a,b) = 1$, then $ab\mid c$.\label{exer:1.5}

    \solu{Let $c=am$, then $\gcd(am,b)=\gcd(m,b)=b$, and $b\mid m$.}
    
    \item Given $a,b,c\in\Z$ that not all $0$, let $\gcd(a,b,c)$ be the smallest positive integer of the form $ax + by + cz$. Prove that $\gcd(a,b,c) = \gcd(a, \gcd(b,c)).$

    \solu{To show $\gcd(a,b,c)=\gcd(a,\gcd(b,c))$, simply show that $\gcd(a,b,c)=xa+y\gcd(b,c)$ and $\gcd(a,\gcd(b,c))=xa+yb+zc$ for some coefficients.}
    
    \item Let $a,b,c,d$ be nonzero integers such that $ad - bc = \pm\gcd(a,c).$ Prove that $\gcd(an + b, cn + d) = 1$ for every integer $n$.

    \solu{Let $\gcd(a,c)=e$ and $a=ef,c=eg$. There is then $fd-bg=\pm 1$. Consider $(an+b)g-(cn+d)f$.}
    
    \item Find an example for $a,b,c,d\in\Z$ such that $\gcd(an + b, cn + d) = 1$ for every integer $n$ but $ad - bc \neq \pm\gcd(a,c).$ 

    \solu{Answers may vary. For example $a=c=6,b=1,d=3$.}
    
\end{enumerate}


\section{Prime factorization}
A \textbf{prime} is an integer $p>1$ such that its only positive divisors of $1$ and $p$. For any integer $a$,
$$\gcd(p,a) = \begin{cases}1&\mbox{if }p\nmid a,\\ p&\mbox{if }p\mid a.\end{cases}$$

\begin{proposition}
    (Euclid's Lemma) Let $p$ be a prime. Then for any integers $a,b$, if $p\mid ab$, then $p\mid a$ or $p\mid b$.
\end{proposition}

\begin{proof}
    Suppose $p\nmid a$. Then $\gcd(p,a) = 1$. Then from $p\mid ab$, we get $p\mid b$.
\end{proof}

The converse of Euclid's Lemma is also true: 

\begin{proposition}
    Let $n>1$ be an integer such that whenever $n$ divides a product of integers, $n$ must divide one of the factors. Then $n$ is a prime.
\end{proposition}

\begin{proof}
    Let $d\mid n$ be a positive divisor of $n$. Then $n = de$ for some $e\in\Z$. Since $d,n>0$, we have $e>0$ and $e\mid n$. From $n\mid de$, we get $n\mid d$ or $n\mid e$. If $n\mid d$, then along with $d\mid n$, we get $d = n$. If $n\mid e$, then along with $e\mid n$, we get $e = n$ and so $d = 1$.
\end{proof}

\noindent\textbf{Remark}: The proof of EL$\Rightarrow$prime uses only division, whereas the proof of prime$\Rightarrow$EL requires the theory of gcd. There are number systems in general where the notion of gcd doesn't exist, or worse where unique factorization doesn't hold.

\begin{theorem}
(Fundamental Theorem of Arithmetic) Every positive integer can be written as a product of primes, unique up to reordering.
\end{theorem}

For any prime $p$ and any integer $n\neq 0$, we define $\nu_p(n)$ to be the largest integer $k$ such that $p^k\mid n$. A commonly used notation is
$$p^{\nu_p(n)} \mid\mid n.$$
Alternatively, $\nu_p(n)$ is the unique non-negative integer $k$ such that
$$p^k\mid n\qquad\mbox{and}\qquad p\nmid\frac{n}{p^k}.$$
We use the convention $\nu_p(0) = \infty$.



\begin{proposition}
    Let $p$ be any prime and let $n,m$ nonzero integers. Then
    $$\nu_p(nm) = \nu_p(n) + \nu_p(m),\qquad \nu_p(n+m) \geq \min\{\nu_p(n),\nu_p(m)\}.$$
    If $\nu_p(n)\neq \nu_p(m)$, then $$\nu_p(n+m) = \min\{\nu_p(n),\nu_p(m)\}.$$
\end{proposition}

\begin{proof}
    Let $k = \nu_p(n)$ and $\ell = \nu_p(m)$. From $p^k\mid n$ and $p^\ell\mid m$, we have $p^{k+\ell}\mid nm$. From $p\nmid n/p^k$ and $p\nmid m/p^\ell$, we have $p\nmid nm/p^{k+\ell}$ by the contrapositive of EL. Therefore, $\nu_p(nm) = k + \ell$.

    Suppose WLOG that $k\leq \ell$. Then $p^k\mid p^\ell$ and so $p^k\mid m$. Since $p^k\mid n$, we have $p^k\mid n+m$. Thus $\nu_p(n+m)\geq k$. Suppose $k<\ell$. Then $p\mid m/p^k$ but $p\nmid n/p^k$. Hence $p\nmid (n+m)/p^k$. So $\nu_p(n+m) = k$.
\end{proof}

\begin{center}
    \add{Lecture 3 Mon 09/11}
\end{center}

It then follows by induction on $\ell$ that for any $\ell\in\N$ and nonzero integers $n_1,\ldots,n_\ell$, we have
$$\nu_p(n_1\cdots n_\ell) = \nu_p(n_1) + \cdots + \nu_p(n_\ell).$$
Note that for primes $p,q$ we have $\nu_p(q) = 0$ for $p\neq q$ and $\nu_p(p) = 1$. Hence, we have the following result.

\begin{cor}
    Let $n_q$ be non-negative integers for primes $q$ such that all but finitely many of them are $0$. Then for any prime $p$,
    $$\nu_p\left(\prod_q q^{n_q}\right) = n_p.$$
    In particular, prime factorizations are unique. (Unless otherwise specified, a sum or product over an index $p$ or $q$ is running only over primes $p$.)
\end{cor}

We prove next the existence of prime factorization.






\begin{theorem}
    Let $n\in\N$. Then $\nu_p(n) = 0$ for all but finitely many primes $p$ and $$n = \prod_{p}p^{\nu_p(n)}.$$
    In particular, prime factorizations exist.
\end{theorem}

\begin{proof}
    If $p>n$, then clearly $p\nmid n$ and so $\nu_p(n)=0$.
    We prove the second statement by induction on $n$. Suppose first that $n = 1$. Then $\nu_p(1) = 0$ for all primes $p$ and $\prod_p p^0 = 1$.

    Suppose now $n\geq 2$ and $n=q$ is a prime. In this case, $$\prod_p p^{\nu_p(q)} = q^1 \prod_{p\neq q} p^0 = q.$$

    Suppose now $n\geq2$ and $n$ is not a prime. Let $d$ be a positive divisor of $n$ with $1<d<n$. Let $e = n/d$. Then $1<e<n$. By induction, we have $$d = \prod_{p}p^{\nu_p(d)},\qquad e = \prod_{p}p^{\nu_p(e)}.$$ Multiplying them gives $$n = de = \prod_p p^{\nu_p(d)+\nu_p(e)} = \prod_p p^{\nu_p(n)}$$
    since $\nu_p(d)+\nu_p(e) = \nu_p(de) = \nu_p(n).$
\end{proof}

We can extend $\nu_p$ to all rational numbers by defining $\nu_p(a/b) = \nu_p(a) - \nu_p(b).$ The multiplicative property of $\nu_p$ implies that if $a/b = c/d$, then $ad = bc$ and so $\nu_p(a) + \nu_p(d) = \nu_p(b) + \nu_p(c)$. In other words,  $$\nu_p(a) - \nu_p(b) = \nu_p(c) - \nu_p(d).$$
Hence $\nu_p(a/b)$ is independent on the choices of $a$ and $b$.

\begin{cor}
    Let $r\in\Q$ be nonzero. Then $\displaystyle r = \pm\prod_p p^{\nu_p(r)}.$ Moreover,
    \begin{enumerate}
        \item $r\in\Z$ if and only if $\nu_p(r)\geq 0$ for all primes $p$;
        \item $r = \pm 1$ if and only if $\nu_p(r) = 0$ for all primes $p$.
    \end{enumerate}
\end{cor}

\begin{cor}
    Let $d,n$ be nonzero integers. Then $d\mid n$ if and only if $\nu_p(d)\leq\nu_p(n)$ for all primes $p$.
\end{cor}

\begin{proof}
\begin{comment}
    Suppose $d\mid n$. Write $n = de$ for some nonzero integer $e$. Then for any primes $p$, $$\nu_p(n) = \nu_p(d) + \nu_p(d)\geq\nu_p(d).$$
    Conversely, suppose $\nu_p(d)\leq\nu_p(n)$ for all primes $p$. Let $m_p = \nu_p(n) - \nu_p(d)$. Then $m_p\geq 0$ for all primes $p$, and $m_p\leq \nu_p(n) = 0$ for all but finitely primes $p$. Then $m = \prod_p p^{m_p}\in\Z$ and $n = dm$.
\end{comment}
    We have $d\mid n$ if and only if $n/d\in\Z$ if and only if $\nu_p(n/d) = \nu_p(n) - \nu_p(d)\geq0$ for all primes $p$.
\end{proof}

\begin{cor}
    Let $n$ be a nonzero integer. Then the number of positive divisors of $n$ is $$\prod_p (1 + \nu_p(n)).$$
\end{cor}

\begin{proof}
    Any positive divisor $d$ is uniquely determined by $\nu_p(d)$ for all primes $p$. There are $1+\nu_p(n)$ possible values for $\nu_p(d)$ in order for $\nu_p(d)\leq\nu_p(n)$.
\end{proof}

\begin{cor}
    Let $n,m$ be nonzero integers. Then for any prime $p$, $$\nu_p(\gcd(n,m)) = \min\{\nu_p(n),\nu_p(m)\}.$$
\end{cor}

\begin{proof}
    Since $\gcd(n,m)$ divides $n$ and $m$, we see that for any prime $p$, $\nu_p(\gcd(n,m))\leq\nu_p(n)$ and also $\leq\nu_p(m)$. Hence $\nu_p(\gcd(n,m)) \leq \min\{\nu_p(n),\nu_p(m)\}.$ For the other inequality, let $d_p = \min\{\nu_p(n),\nu_p(m)\}$. Note that $d_p = 0$ for $p>\max\{n,m\}$. We let $d = \prod_p p^{d_p}$. From $d_p\leq \nu_p(n)$ for all $p$, we get $d\mid n$ and similarly $d\mid m$. Hence $d\mid \gcd(n,m)$ and so $d_p\leq \nu_p(\gcd(n,m))$ for all primes $p$.
\end{proof}

Similarly for nonzero integers $x,y,z$, we have
$$\nu_p(\gcd(x,y,z)) = \min\{\nu_p(x),\nu_p(y),\nu_p(z)\}.$$

A related concept is the least common multiple $\lcm(m,n)$ of two integers $m,n$, or of multiple integers. One easily checks that $$\nu_p(\lcm(n,m)) = \max\{\nu_p(n),\nu_p(m)\}.$$
Since $$\min\{a,b\} + \max\{a,b\} = a + b,$$
we get $$\gcd(n,m)\lcm(n,m) = nm.$$

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
        \item Prove Proposition \ref{prop:CAD} using $\nu_p$: Let $a,b,c$ be integers such that $\gcd(a,c) = 1$. Then $\gcd(c, ab) = \gcd(c, b)$
    \item Prove Exercise 1.\ref{exer:1.5} using $\nu_p$: If $a,b,c\in\Z$ such that $a\mid c$ and $b\mid c$ and $\gcd(a,b) = 1$, then $ab\mid c$.
    \item Let $k\in\N$. Prove that $n\in\N$ is a perfect $k$-th power (that is, $n = m^k$ for some $m\in\N$) if and only if $k\mid\nu_p(n)$ for any prime $p$.
    \item Prove that if $x,y\in\N$ are coprime and $k\in\N$ such that $xy$ is a perfect $k$-th power, then $x$ and $y$ are both perfect $k$-th powers.
    \item Prove that the equation $x^2 = 2y^2$ has no non-zero integer solutions. This implies that $\sqrt{2}$ is irrational.
    \item Prove that the equation $2^x = 3^y$ has no positive integer solutions. This implies that $\log_23$ is irrational.
    \item Let $p$ be a prime. Define $|r|_p$ for any nonzero $r\in\Q$ by $|r|_p = p^{-\nu_p(r)}$ and define $|0|_p = 0$. Then for any $r,s\in\Q$, prove that
    \begin{enumerate}
        \item $|rs|_p = |r|_p|s|_p$,
        \item $|r+s|_p \leq \max\{|r|_p,|s|_p\}\leq |r|_p + |s|_p.$
    \end{enumerate}
    In other words, $|.|_p$ behaves similar to the usual absolute value, and is called the $p$-adic absolute value.
    \item Prove that the equation $x^3 = 2y^3 + 4z^3$ has no non-zero integer solutions.
\end{enumerate}


\section{Prime counting function}
The number $$L_n = \lcm(1,2,\ldots, n)$$
is closely related to the prime counting function. Let $p$ be any prime. Let $k$ be a nonnegative integer such that $p^k\leq n < p^{k+1}$. Then no integer from $1$ to $n$ is divisible by $p^{k+1}$ and $p^k\leq n$ with $\nu_p(p^k) = k$. In other words $$\nu_p(L_n) = \max\{\nu_p(1),\ldots,\nu_p(n)\} = k = \left\lfloor\frac{\log n}{\log p}\right\rfloor,$$ which is also the number of integers from $1$ to $n$ that are powers of $p$. We define the von Mangoldt function $$\Lambda(m) = \begin{cases}
    \log p&\mbox{if }m\mbox{ is a positive power of a prime }p\\
    0&\mbox{otherwise}.
\end{cases}$$
Then $$\log L_n = \sum_{p\leq n}\left\lfloor\frac{\log n}{\log p}\right\rfloor\log p = \sum_{m\leq n}\Lambda(m) =: \psi(n),$$
is the Chebyshev's $\psi$-function.

\begin{theorem}\label{thm:PMT1}
    (Prime number theorem) We have $$\lim_{x\rightarrow\infty}\frac{\psi(x)}{x} = 1.$$
\end{theorem}
\noindent As a consequence, we have $L_n\sim e^n$.

\begin{center}
    \add{Lecture 4 Wed 09/13}
\end{center}

You might be more familiar with the Prime number theorem stated in terms of the prime counting function
$\pi(x)$ which counts the number of primes less than or equal to $x$. From the trivial bound $$\left\lfloor\frac{\log n}{\log p}\right\rfloor \leq \frac{\log n}{\log p},$$
we see that $\psi(n) \leq \pi(n)\log n$.

\begin{theorem}\label{thm:PMT2}
        The Prime number theorem is equivalent to
    $$\lim_{x\rightarrow\infty}\frac{\pi(x)}{x/\log x} = 1.$$
\end{theorem}
\noindent The other inequality needs a bit of estimate. See below for a proof of the equivalence of Theorems \ref{thm:PMT1} and \ref{thm:PMT2}. 

You will also prove in HW2 a lower bound for $L_n$ of the form $$L_{n}\geq 2^n$$ for $n\geq 7$, which will then give a lower bound for $\pi(x)$ of the form $C_1x/\log x$ for some constant $C_1>0$. We will prove next that $$L_n\leq 4^{n-1}$$
which gives an upper bound of $\pi(x)$ of the form $C_2x/\log x$ for some constant $C_2>0$.

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item For any $n\in\N$, we use the notation $\displaystyle\sum_{d\mid n}$ to denote a sum over the positive divisors of $n$. Prove that $$\sum_{d\mid n}\Lambda(d) = \log n.$$
    \solu{Each prime power factor contributes a log.}
    \item Compute $L_{126}/L_{120}$ and $L_{145}/L_{135}.$
\end{enumerate}

%\vspace{15pt}
\noindent\alert{This following subsection is only for personal entertainment and will not be covered in class or the exam.}
\vspace{-5pt}

\subsection*{A very sketchy sketch of the proof of the prime number theorem}

We prove first the following comparison between $\psi(x)$ and $\pi(x)$:
$$\frac{\pi(x)}{x/\log x}\left(1 - \frac{\log\log x + \log\log\log x}{\log x}\right) - \frac{1}{\log\log x} \leq \frac{\psi(x)}{x} \leq \frac{\pi(x)}{x/\log x}.$$
Then by taking limit as $x\rightarrow\infty$, we have the equivalence of Theorems \ref{thm:PMT1} and \ref{thm:PMT2} by the Squeeze Theorem.
The upper bound was already proved. For the lower bound, let
$$\theta_1(x) = \sum_{x/(\log x\cdot\log\log x)\leq p\leq x}\log p \leq \psi(x).$$
We can now bound $\theta_1(x)$ from below by
\begin{eqnarray*}
    \theta_1(x) &\geq& \sum_{x/(\log x\cdot\log\log x) \leq p\leq x}\log(\frac{x}{\log x\log\log x})\\
    &=&\sum_{p\leq x}\log(\frac{x}{\log x\log\log x}) - \sum_{p<x/(\log x\cdot\log\log x) }\log(\frac{x}{\log x \log\log x})\\
    &\geq&\pi(x)(\log x - \log\log x - \log\log\log x) - \frac{x}{\log x\log\log x}\log x\\
    &=&\pi(x)\log x\left(1 - \frac{\log\log x + \log\log\log x}{\log x}\right) - \frac{x}{\log\log x}.
\\\end{eqnarray*}
Dividing by $x$ gives the desired lower bound.

\vspace{5pt}
We now give a sketch for the proof of Theorem \ref{thm:PMT1}. We define the Riemann-zeta function
$$\zeta(s) = \sum_{n=1}^\infty \frac{1}{n^s},$$
which a priori is only defined for $s>1$. For example,
$$\zeta(2) = \sum_{n=1}^\infty\frac{1}{n^2} = \frac{\pi^2}{6},\qquad \zeta(4) = \sum_{n=1}^\infty\frac{1}{n^4} =  \frac{\pi^4}{90}.$$
The value of $\zeta$ at an even positive integer $n$ is some rational multiple of $\pi^n$. It is known that $\zeta(3)$ is irrational and that infinitely many of the $\zeta(2k+1)$ are irrational. They are of course all conjectured to be transcendental.

\vspace{5pt}
Using prime factorization, we have the factorization
$$\zeta(s) = \prod_p \left(1 + \frac{1}{p^s} + \frac{1}{p^{2s}} + \cdots\right) = \prod_p \frac{1}{1-p^{-s}}.$$
Note that if there were only finitely many primes, then this product is a finite product and thus always exist. However, $\zeta(1)$ is the harmonic series which diverges. This is Euler's proof of the infinitude of primes.

\vspace{5pt}
We take the logarithmic derivative of $\zeta(s)$ to get
$$\frac{d}{ds}\log\zeta(s) = - \sum_p \frac{d}{ds}\log(1 - p^{-s}) = -\sum_p \frac{p^{-s}\log p}{1-p^{-s}} = -\sum_p \log p\left(\frac{1}{p^s} + \frac{1}{p^{2s}} + \cdots\right).$$
In other words, we see the von Mangoldt function popping up: $$-\frac{\zeta'(s)}{\zeta(s)} = \sum_n \frac{\Lambda(n)}{n^s}.$$

There is a somewhat reasonable way to define $\zeta(s)$ for $0<s<1$. We note that
$$2^{-s}\zeta(s) = \sum_{n=1}^\infty\frac{1}{(2n)^s} = \sum_{n\text{ even}}\frac{1}{n^s} = \sum_{n=1}^\infty \frac{1+(-1)^n}{2}\frac{1}{n^s} = \frac{1}{2}\left(\sum_{n=1}^\infty\frac{1}{n^s}+\sum_{n=1}^\infty\frac{(-1)^n}{n^s}  \right).$$
So $$\zeta(s) = \frac{1}{1-2^{1-s}}\sum_{n=1}^\infty\frac{(-1)^{n+1}}{n^s}$$
and the alternating series converges for $s>0$. To connect the two regions $s>1$ and $0<s<1$, we go to the complex world! The exponential $n^s$ is defined as
$$n^s = e^{s\ln n} = e^{\text{Re}(s)\ln n + i\text{Im}(s)\ln n} = n^{\text{Re}(s)}(\cos(\text{Im}(s)\ln n) + i\sin(\text{Im}(s)\ln n).$$

\begin{theorem}\label{thm:psis}
    The function $\zeta(s)$ is analytic for $\text{Re}(s)>1$. It has a simple pole at $s = 1$ with residue $1$ and admits a (unique) analytic continuation to all $s\in\C\backslash\{1\}$. Moreover, 
    $$\psi(x) = x - \log(2\pi) - \sum_{\zeta(\rho) = 0}\frac{x^\rho}{\rho}.$$
\end{theorem}
Here:
\begin{enumerate}
    \item \textbf{analytic} means differentiable in the complex world. It turns out that being differentiable implies being infinitely differentiable.
    \item \textbf{simple pole} at $s=1$ \textbf{with residue $1$} means that for $s$ near $1$, $\zeta(s)\sim\frac{1}{s-1}.$
    \item \textbf{analytic continuation} means that there is a function $L$ that is analytic on $\C\backslash\{1\}$ such that $L(s) = \zeta(s)$ for $\text{Re}(s)>1$. (The meme where $1+2+\cdots = -1/12$ is the statement that $L(-1) = -1/12$. Another notable value is $L(0) = -1/2$.)
    \item $\zeta$ has \textbf{trivial zeroes} at the negative even integers and the contribution from them is $$\sum_{n=1}^\infty \frac{1}{2nx^{2n}} = \frac12\log(1 - x^{-2}).$$
    All other zeroes of $\zeta$, called \textbf{nontrivial zeroes}, lie in the \textbf{critical strip} where $0 \leq \text{Re}(s) \leq 1$ and are symmetric under $s\mapsto 1-s$.
\end{enumerate}

Theorem \ref{thm:PMT1} then follows from the following result on the zeroes of the zeta function.

\begin{theorem}\label{thm:zerofree}
    If $\zeta(\beta+ it) = 0$ where $1/2\leq\beta\leq 1$, then $$\beta \leq 1 - \frac{1}{71\log(|t|+2)}.$$
\end{theorem}

These results are enough to conclude that $\psi(x)\sim x$. Theorem \ref{thm:zerofree} has been improved to
$$\beta \leq 1 - \frac{1}{57.54(\log |t|)^{2/3}(\log\log|t|)^{1/3}}.$$
The \textbf{Riemann hypothesis} predicts that $\beta = 1/2$.

\section{Binomial coefficients}

Our goal now is to prove that
$$L_n = \lcm(1,2,\ldots,n) \leq 4^{n-1}$$
without using the prime number theorem. This implies Erd\"{o}s' bound
$$\prod_{p\leq n}p \leq 4^{n-1}.$$

Recall the binomial coefficients
$$\binom{n}{r} = \frac{n!}{r!(n-r)!} = \frac{n(n-1)\cdots(n-r+1)}{r!}$$
for $0\leq r\leq n$. We define it to be $0$ if $r<0$ or if $r>n$. They have combinatoric interpretations as the number of ways to pick $r$ objects from a collect of $n$ objects. Some well-known identities include:
\begin{enumerate}
    \item Binomial Theorem: $\displaystyle (a+b)^n = \sum_{r=0}^n \binom{n}{r}a^rb^{n-r}$.
    \item Hypergeometric Identity: $\displaystyle \binom{n}{m} = \sum_{r=0}^n \binom{a}{r}\binom{n-a}{m-r}.$ When $a=1$, we have Pascal's Identity $\displaystyle \binom{n}{m} = \binom{n-1}{m-1} + \binom{n-1}{m}.$
\end{enumerate}
Pascal's identity (or the above combinatorial interpretation) can be used to prove that the binomial coefficients are all integers. Alternatively, we can use Legendre's formula:

\begin{proposition}
    For any prime $p$ and any positive integer $n$,
    $$\nu_p(n!) = \sum_{k=1}^\infty \left\lfloor\frac{n}{p^k}\right\rfloor = \left\lfloor\frac{n}{p}\right\rfloor + \left\lfloor\frac{n}{p^2}\right\rfloor + \left\lfloor\frac{n}{p^3}\right\rfloor + \cdots$$
\end{proposition}

\begin{proof}
    For any $k\in\N$, let $u(k)$ denote the number of integers from $1$ to $n$ that are multiplies of $p^k$. Then $u(k) - u(k+1)$ is the number of integers from $1$ to $n$ with $\nu_p = k$. Then
    $$\nu_p(n!) = (u(1)-u(2)) + 2(u(2)-u(3)) + 3(u(3)-u(4)) + \cdots = u(1) + u(2) + u(3) + \cdots.$$
    We are done because $u(k) = \lfloor n/p^k\rfloor.$
\end{proof}

\begin{lemma}\label{lem:ind}
    Let $a,m,n\in\N$ with $m < n$. Let $n_a,m_a$ be the remainders when $n,m$ are divided by $a$. Then
    $$\left\lfloor\frac{n}{a}\right\rfloor - \left\lfloor\frac{m}{a}\right\rfloor - \left\lfloor\frac{n-m}{a}\right\rfloor = \begin{cases}
        1&\mbox{if }n_a < m_a,\\
        0&\mbox{if }n_a\geq m_a.
    \end{cases}$$
\end{lemma}

\begin{proof}
    We have
    $$\left\lfloor\frac{n}{a}\right\rfloor = \frac{n-n_a}{a},\qquad\left\lfloor\frac{m}{a}\right\rfloor = \frac{m-m_a}{a}$$ and $$\frac{n-m}{a} = \frac{n-n_a}{a} - \frac{m-m_a}{a} + \frac{n_a-m_a}{a} = \left\lfloor\frac{n}{a}\right\rfloor - \left\lfloor\frac{m}{a}\right\rfloor+ \frac{n_a-m_a}{a}.$$
    Since $n_a,m_a$ are remainders, we know that $-1 < (n_a-m_a)/a < 1$. If $n_a\geq m_a$, then $(n_a-m_a)/a \in [0,1)$ and so $$\left\lfloor\frac{n-m}{a}\right\rfloor = \left\lfloor\frac{n}{a}\right\rfloor - \left\lfloor\frac{m}{a}\right\rfloor.$$
    If $n_a < m_a$, then $(n_a-m_a)/a \in (-1,0)$ and so $$\left\lfloor\frac{n-m}{a}\right\rfloor = \left\lfloor\frac{n}{a}\right\rfloor - \left\lfloor\frac{m}{a}\right\rfloor - 1.$$
    Hence we are done.
\end{proof}

\begin{cor}\label{cor:notdiv}
    Suppose $p$ is a prime and $n$ is a positive integer. Let $k$ be an integer such that $p^k\leq n < p^{k+1}$. Then for any integer $m=0,\ldots,n$, we have
    $$0\leq \nu_p\left(\binom{n}{m}\right) \leq k\qquad\mbox{and}\qquad p\nmid \binom{n}{p^k}.$$
\end{cor}

\begin{proof}
    By Legendre's formula, we have
    $$\nu_p\left(\binom{n}{m}\right) = \sum_{j=1}^k \left(\left\lfloor\frac{n}{p^j}\right\rfloor - \left\lfloor\frac{m}{p^j}\right\rfloor - \left\lfloor\frac{n-m}{p^j}\right\rfloor\right).$$
    By Lemma \ref{lem:ind}, every term in the above sum is at most $1$. Moreover, if $m = p^k$, then the remainder of $m$ when divided by $p^j$ for any $j = 1,\ldots,k$ is $0$, and so each term is $0$.
\end{proof}

\begin{cor}\label{cor:ndivp}
    Suppose $p$ is a prime and $m<n$ are positive integers. Suppose $n = p^k$ for some positive integer $k$. Then
    $$\nu_p\left(\binom{n}{m}\right) = k - \nu_p(m) > 0.$$
\end{cor}

\begin{proof}
    The remainder when $n$ is divided by a power $p^a$ of $p$ is $0$ for all $a = 1,\ldots,k$. So $\nu_p\left(\binom{n}{m}\right)$ is the number of these $a$ such that $p^a\nmid m$.
\end{proof}


\begin{center}
    \add{Lecture 5 Fri 09/15}
\end{center}
The aim of this section is to prove $L_n \leq 4^{n-1}$ giving an upper bound for the product of primes, which will then allow us to prove Bertrand's postulate that there is always a prime in $(n, 2n]$. We begin with some basic bounds on the binomial coefficients $\binom{2n+1}{n}$ and $\binom{2n}{n}$: for $n\in\N$, we have
$$\frac{4^n}{n+1} < \binom{2n+1}{n} < 4^n,\qquad \frac{4^n}{2n+1} < \binom{2n}{n}< 4^n.$$
They follow from $$2^{2n+1} = \sum_{r=0}^{2n+1}\binom{2n+1}{r},\qquad 2^{2n} = \sum_{r=0}^{2n}\binom{2n}{r}$$
and that $\binom{2n+1}{n} = \binom{2n+1}{n+1}$ is the largest binomial coefficient of the form $\binom{2n+1}{r}$, and $\binom{2n}{n}$ is the largest binomial coefficient of the form $\binom{2n}{r}$. From the Stirling's approximation
$$n!\sim \sqrt{2\pi n}\left(\frac{n}{e}\right)^n,$$
we can get the more precise estimate $$\binom{2n}{n}\sim \frac{4^n}{\sqrt{\pi n}}.$$
One may view the above as an ``archimedean'' estimate for these binomial coefficients. In our applications below, we will be making ``$p$-adic'' estimates for them. Fun fact: $10!$ seconds is exactly $6$ weeks.
\begin{theorem}
    For any $n\in\N$, we have $L_n\leq 4^{n-1}.$
\end{theorem}

\begin{proof}https://www.overleaf.com/project/64f228620d0139d74f910c98
    We prove it by induction on $n$. When $n=1$, we have $L_1 = 1 = 4^{1-1}$. Suppose now $n\geq 2$. Suppose first $n = 2k$ is even. Then $k\leq n-1$ so $k\mid L_{n-1}$ and we have $L_n \leq 2L_{n-1} \leq 2\cdot 4^{n-2} < 4^{n-1}$. Hence, it remains to consider the case where $n = 2k+1$ is odd, where $k\geq 1$.

    Let $p$ be a prime. We see that $\nu_p(L_{2k+1}) > \nu_p(L_{k+1})$ if and only if there is a positive integer $a$ with $$k+2 \leq p^a \leq 2k+1.$$ Since $2k+1 < 2(k+2)$, we also have
    $$p^{a-1} < k+2 \leq p^a \leq 2k+1 < p^{a+1}.$$
    This implies that $\nu_p(L_{k+1}) = a - 1$ and $\nu_p(L_{2k+1}) = a$. %In other words, $L_{2k+1}$ has an extra factor of $p$ compared to $L_{k+1}$ if and only if there is a power of $p$ between $k+2$ and $2k+1$. 
    Moreover, if $k+2 \leq p^a \leq 2k+1,$ then
    $$\left\lfloor\frac{k}{p^a}\right\rfloor=0,\quad \left\lfloor\frac{k+1}{p^a}\right\rfloor=0,\quad\left\lfloor\frac{2k+1}{p^a}\right\rfloor=1.$$
    That is, we have $$\displaystyle p\mid \binom{2k+1}{k}\qquad\mbox{and so}\qquad L_{2k+1} \leq L_{k+1} \binom{2k+1}{k} \leq 4^k\cdot 4^k\leq 4^{2k}.$$
    by induction.
\end{proof}



Let's now consider the binomial coefficient $\displaystyle\binom{2n}{n}$. For any positive integer $a$, write $(2n)_a$ and $n_a$ for the remainders as last time. We note that if $n_a < a/2$, then $(2n)_a = 2(n_a) \geq n_a$; and if $n_a \geq a/2$, then $(2n)_a = 2(n_a) - a < n_a$. Hence
$$\left\lfloor\frac{2n}{a}\right\rfloor - 2\left\lfloor\frac{n}{a}\right\rfloor = \begin{cases}
        1&\mbox{if }n_a \geq a/2,\\
        0&\mbox{if }n_a < a/2.
    \end{cases}$$

\begin{cor}
    For any positive integer $n$, we have $\displaystyle n+1 \mid \binom{2n}{n}$. The quotients $\displaystyle\frac{1}{n+1}\binom{2n}{n}$ are the Catalan numbers.
\end{cor}

\begin{proof}
    One can prove this directly by checking that
    $$\frac{1}{n+1}\binom{2n}{n} = \binom{2n}{n} - \binom{2n}{n+1} \in\Z.$$
    Alternatively, suppose $\nu_p(n+1) = k$. Then for any $a = p,p^2,\ldots,p^k$, we have $n_a = a - 1\geq a/2$. So $\nu_p(\binom{2n}{n}) \geq k.$
\end{proof}

\begin{cor}
    Let $n\geq3$ and let $p$ be a prime such that $2n/3 < p \leq 2n$. Then
    $$\nu_p\left(\binom{2n}{n}\right) = \begin{cases}
        1&\mbox{if }n < p \leq 2n\\
        0&\mbox{if }2n/3 < p \leq n
    \end{cases}$$
\end{cor}

\begin{proof}
    The statement for $n<p\leq 2n$ is obvious because $\lfloor 2n/p\rfloor = 1$ and $\lfloor n/p\rfloor = 0$. Suppose now $2n/3 < p \leq n$. Then $n-p <3p/2-p = p/2$. So $\lfloor\frac{2n}{p}\rfloor - 2\lfloor\frac{n}{p}\rfloor = 0$. Now $p^2 > 4n^2/9 \geq 2n$ for $n\geq 5.$ When $n = 4$, we have $8/3 < p \leq 4$ and so $p = 3$ and $p^2 > 2n$. When $n = 3$, we have $2 < p \leq 3$ and so $p = 3$ and $p^2 > 2n$. 
\end{proof}

For primes $p \leq 2n/3$, we have the ``trivial'' bound
$$\nu_p\left(\binom{2n}{n}\right) \leq \frac{\log 2n}{\log p}.$$
Note for $\sqrt{2n}<p\leq 2n/3$, we have 
$$\nu_p\left(\binom{2n}{n}\right) \leq \frac{\log 2n}{\log p} < 2\qquad\Longrightarrow\qquad \nu_p\left(\binom{2n}{n}\right) = 1.$$
Combining these, we find that
$$\frac{4^n}{2n+1}\leq \binom{2n}{n} \leq \prod_{p\leq \sqrt{2n}} p^{\log 2n/\log p} \cdot \prod_{\sqrt{2n} < p\leq 2n/3} p\cdot\prod_{n < p \leq 2n}p \leq (2n)^{\sqrt{2n}} \cdot 4^{2n/3-1} \cdot (2n)^{\pi(n,2n)}$$
where $\pi(n,2n)$ denotes the number of primes in $(n, 2n]$. Taking $\log$, we get
$$\pi(n, 2n) \geq \frac{(n/3+1)\log 4 - \log(2n+1)}{\log 2n} - \sqrt{2n} \geq C \frac{n}{\log n}$$
for some positive constant $C>0$ when $n$ is sufficiently large.

\begin{theorem}
    (Bertrand's postulate) For any positive integer $n$, there is a prime $p \in (n, 2n]$.
\end{theorem}

\begin{proof}
    The above lower bound is positive for $n\geq 459$. We can verify the result directly for small $n$ using the primes $2,3,5,7,13,23,43,83,163,317,631$.
\end{proof}

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Prove that for any non-negative integers $r,n$, $$\sum_{r=0}^k\binom{n+r}{r} = \binom{n+k+1}{k}.$$
    \item Prove that for every prime $p$, there exists a positive integer $n$, an integer $a = 0,1$ and an integer $b = 0,1,\ldots,n-1$ such that $p = n^2 + an + b$.
    \item How many $0$'s does the number $40!$ ends in? 
    
    Can you figure out what the last nonzero digit of $40!$ is?
    \item Prove that for any $n\in\N$, we have that $\nu_2(n!) = n - \#1$'s in the binary representation of $n$.
    \solu{Corollary of HW2 Q2 when $p=2$.}
    \item Prove that for any $n\in\N$ and any prime $p$, we have $\nu_p(n!) < n/(p-1).$\label{exer:5}
    \solu{Corollary of HW2 Q2, digits in representation cannot be all zero.}
    \item Prove that for any $n\in\N$, if $n\mid\binom{n}{m}$ for all $m = 1,\ldots,n-1$, then $n$ is a prime.
    \item According to the Prime number theorem, we know that $L_n\sim e^n$. Prove (without using the PNT) that for any $\alpha > 0$, we have $L_n \geq 4^{n-\alpha}$ for $n$ sufficiently large (depending on $\alpha$).
    \item Use Exercise 4.\ref{exer:5} to conclude that $$\sum_{p}\frac{\log p}{p-1}\rightarrow\infty.$$
    With a little bit more effort, one can prove that $$\sum_{p\leq n}\frac{\log p}{p} = \log n + O(1).$$
    In other words, there exists an absolute constant $C>0$ such that for any $n\in\N$, $$\left|\sum_{p\leq n}\frac{\log p}{p} - \log n\right| \leq C.$$
\end{enumerate}

\begin{center}
    \add{Lecture 6 Mon 09/18}
\end{center}
\section{Euclid's proof of the infinitude of primes}

Before all of these fancy results on the prime counting function, the very first proof of the infinitude of primes was due to Euclid. Here is another way to think about the proof. The key ideas are as follows:
\begin{enumerate}[(a)]
    \item Every integer $n\geq 2$ has a prime divisor.
    \item Construct an infinite sequence of pairwise coprime integers at least $2$.
\end{enumerate}
The sequence constructed from Euclid's proof is $a_1 = 2$ and 
$$a_{n+1} = a_1a_2\cdots a_n + 1,\qquad\mbox{ for }n\geq1.$$
Then for $i < j$, we have $a_i\mid a_1a_2\cdots a_{j-1}$ and so $\gcd(a_i,a_j) = \gcd(a_i, 1) = 1.$

Alternatively, if we take $a_1$ odd and use $a_{n+1} = a_1\cdots a_n + 2$, we also have $\gcd(a_i,a_j) = \gcd(a_i,2) = 1$ since each $a_i$ is odd.

\begin{proposition}
    The sequence defined by $F_0 = 3$ and $$F_{n+1} = F_0F_1\cdots F_n + 2,\qquad\mbox{ for }n\geq 0$$
    is the sequence of Fermat numbers $F_n = 2^{2^n}+1$.
\end{proposition}

\begin{proof}
    It suffices to prove that $F_n = 2^{2^n}+1$ satisfies the recursion formula. This follows easily from induction along with $F_{n+1} - 1 = (F_n - 1)^2$.
\end{proof}

There is a more general result on the infinitude of primes satisfying congruence conditions. Recall that $a\equiv b\pmod{m}$ means that $m\mid a - b$, or equivalently that $a$ and $b$ have the same remainder when divided by $m$. Since numbers congruent to $a$ mod $m$ form an arithmetic progression, this result is also referred to as the infinitude of primes in arithmetic progressions. It marks the beginning of modern analytic number theory.

\begin{theorem}
    (Dirichlet) Let $a,m$ be coprime positive integers. Then there are infinitely many primes $p\equiv a\pmod{m}$.
\end{theorem}

We now know (Siegel-Walfisz) that there are an equal number of them, asymptotically, over all possible congruence classes. More precisely, if $p\equiv a\pmod{m}$, then $\gcd(p,m) = \gcd(a,m)$. If $p$ is prime large enough to not divide $m$, then $\gcd(p,m) = 1$. The number of integers $a = 1,\ldots,m$ such that $\gcd(a,m)$ is $\phi(m)$, the Euler-$\phi$ (or the Euler-Totient) function of $m$. Then 
$$\lim_{x\rightarrow\infty}\frac{\#\,\text{primes }p\leq x,p\equiv a \,\,(\text{mod }m)}{x/\log x} = \frac{1}{\phi(m)}.$$
We can give an Euclid's type proof for this result in some special cases.

\subsection*{Primes of the form $4k+3$} 

We modify the key idea of Euclid's proof to:
\begin{enumerate}[(a)]
    \item Every integer $n\geq2$ of the form $4k+3$ has a prime divisor of the form $4k+3$.
    \item Construct an infinite sequence of pairwise coprime integers at least $2$ that are of the form $4k+3$.
\end{enumerate}
Property (a) follows because products of numbers of the form $4k+1$ are still of the form $4k+1$. In terms of congruences, we can say that if $a\equiv 1\pmod{4}$ and $b\equiv 1\pmod{4}$, then $ab\equiv 1\pmod{4}$. Hence a number of the form $4k+3$ has a prime divisor that is not of the form $4k+1$. Since it can't be divisible by $2$, primes of the form $4k+3$ are the only possibilities left. For the sequence in (b), we take $a_1 = 7$ and $$a_{n+1} = 4(a_1\cdots a_n) + 3.$$
Then similar to before, for $i<j$, $$\gcd(a_i,a_j) = \gcd(a_i,3) = \gcd(a_1\cdots a_{i-1},3) = 1$$
by induction.

\vspace{5pt}
The same idea also works for primes of the form $3k+2$ and primes of the form $6k+5$ because $\phi(3) = \phi(6) = 2$ so that if not all the prime divisors are of the form $3k+1$ (resp. $6k+1$), and it is not divisible by $3$ (resp. $2$ or $3$), then it has a prime divisor of the form $3k+2$ (resp. $6k+5$).

\subsection*{Primes of the form $4k+1$}

This is a bit trickier. Let $p$ be an odd prime. We consider the congruence equation $$x^2\equiv -1\pmod{p}.$$
Suppose it has a solution $x = a$. Then clearly $p\nmid a$ for if otherwise, we would have $a^2\equiv 0$. So by Fermat's little Theorem, $$a^{p-1}\equiv 1\pmod{p}.$$
On the other hand, $$a^{p-1} = (a^2)^{(p-1)/2} \equiv (-1)^{(p-1)/2}\pmod{p}.$$
Since $p$ is an odd prime, we see that $$1\equiv(-1)^{(p-1)/2}\pmod{p} \qquad\Rightarrow\qquad 1 = (-1)^{(p-1)/2} \qquad\Rightarrow\qquad p\equiv 1\pmod{4}.$$
In other words, if $p$ is an odd prime divisor of an integer of the form $n^2 + 1$, then $p$ is of the form $4k+1$. By taking $4n^2 + 1$ instead, we remove the possibility of $p=2$. So we have:
\begin{enumerate}[(a)]
    \item Every integer $n\geq2$ of the form $4k^2+1$ has a prime divisor of the form $4k+1$.
    \item Construct an infinite sequence of pairwise coprime integers at least $2$ that are of the form $4k^2+1$.
\end{enumerate}
To construct our sequence, we take $a_1 = 5$ and
$$a_{n+1} = 4(a_1\cdots a_n)^2 + 1.$$

%\noindent\textbf{Exercise}: Use the polynomial $n^2 + 4$ and $n$ odd to prove there are infinitely many primes of the form $8k + 5$.

\vspace{5pt}
The crucial idea here is that if $a^2\equiv -1\pmod{p}$, then 
$$a^4\equiv 1\pmod{p}$$
but
$$a^3\equiv -a\not\equiv 1\pmod{p},\qquad a^2\equiv -1\not\equiv 1\pmod{p},\qquad a\not\equiv 1\pmod{p}.$$
We define the \textbf{order} of an integer $n$ mod $m$, where $\gcd(n,m) = 1$, denoted $o_m(n)$, to be the smallest positive integer $d$ such that $n^d \equiv 1\pmod{m}.$ So here we have $o_p(a) = 4$. Then from Fermat's little theorem, we know that $p-1$ is an exponent that gives $1$ mod $p$ when $p$ is a prime. It is then natural to expect that the smallest exponent $o_p(a)$ to divide $p-1$, which would give us $p\equiv 1\pmod{4}$.


\begin{center}
    \add{Lecture 7 Wed 09/20}
\end{center}

\begin{proposition}\label{prop:lag}
    Let $a,m$ be coprime integers. Suppose $n\in\N$ with $a^n\equiv 1\pmod{m}$. Then $o_m(a)\mid n$. In particular, when $m = p$ is a prime, by Fermat's little theorem, $o_p(a)\mid p-1$.
\end{proposition}

\begin{proof}
    Note that $o_m(a)\leq n$. Apply the division algorithm to get integers $s,t$ such that $n = o_m(a)s + t$ where $0\leq t < o_m(a)$ and $s\geq 0$. Then
$$a^t \equiv a^t (a^{o_m(a)})^s = a^{t + o_m(a)s} = a^{n}\equiv 1\pmod{m}.$$
Hence it follows from the minimality of $o_m(a)$ that $t = 0$. Therefore, $o_m(a)\mid n$.
\end{proof}

\noindent\textbf{Remark}: The generalization of Fermat's little theorem to arbitrary positive integers is $$a^{\phi(m)}\equiv 1\pmod{m}$$
for any integer $a$ coprime to $m$. So we have in general, $o_m(a)\mid \phi(m)$. Note that $\phi(m) \leq m - 1$ with equality if and only if $m$ is a prime.

\subsection*{Primes of the form $qk+1$ where $q$ is a prime}

Suppose now $a$ is an integer such that $a^q\equiv 1\pmod{p}$ and $a\not\equiv 1\pmod{p}$. Then $o_p(a)\mid q$ and $o_p(a)\neq 1$. So $o_p(a)=q$ and $q\mid p-1$. In terms of division, we have
$$p\mid a^q - 1,\qquad p\nmid a - 1.$$
So $p$ divides the quotient $a^{q-1} + a^{q-2} + \cdots + 1$. We define the $q$-th \textbf{cyclotomic polynomial} to be
$$\Phi_q(x) = \frac{x^q - 1}{x - 1} = x^{q-1} + x^{q-2} + \cdots + 1.$$

\begin{proposition}
    Let $q$ be an odd prime. If $p$ is a prime divisor of $\Phi_q(n)$ for some integer $n$, then $p\equiv 1\pmod{q}$ or $p=q$.
\end{proposition}


\begin{proof}
    Since $\Phi_q(n)\mid n^q - 1$, we have $p\mid n^q - 1$. So $o_p(n)\mid q$. If $o_p(n) = 1$, then $n\equiv 1\pmod{p}$ and $$\Phi_q(n) \equiv 1^{q-1} + \cdots + 1 \equiv q\pmod{p},$$
    which implies that $p\mid q$ and so $p=q$. If $o_p(n) = q$, then we have $p\equiv 1\pmod{q}$.
\end{proof}

We can remove the possibility of $p=q$ by taking $\Phi_q(qn) = 1 + q(\ldots).$ Then we take the sequence $a_1 = \Phi_q(q)$ and $$a_{n+1} = \Phi_q(qa_1a_2\cdots a_n).$$
This gives infinitely many primes of the form $qk+1$.

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Use the polynomial $n^2 + 4$, and a small modification, to prove that there are infinitely many primes of the form $8k + 5$.
    
    \solu{ Assume contrariwise, that there are finitely many primes $p_1, p_2, \cdots p_m$ in the form $8k+5$. Let $n = \prod_{i=1}^m p_i$ and note that $\gcd(n^2+4,n) = 1$. Some basic modular arithmetic shows that there is a new prime $q \equiv 5 \pmod{8}$ that divides $n^2 +4$. We are done. 
    }

    \item Let $h(x)$ be a polynomial with integer coefficients with $h(0) = 1$. Prove that the sequence defined by $a_1 = 1$ and $a_{i+1} = h(a_1a_2\cdots a_i)$ for $i\geq 1$, consists of pairwise coprime integers.
    
    \solu{
    We want to show that $\gcd(a_i, a_j) = 1$ for all $i>j$. \[a_i = h(a_{i-1}a_{i-2} \cdots a_1) +1 \equiv 1 \pmod{a_j}\]
    We are done. 
    }

    \item Let $h(x) = ax + b$ where $a,b$ are coprime integers. Prove that the sequence defined by $a_1 = 1$ and $a_{i+1} = h(a_1a_2\cdots a_i)$ for $i\geq 1$, consists of pairwise coprime integers.
    
    \solu{
     We want to show that $\gcd(a_i, a_j) = 1$ for all $i>j$. We have \[a_i = a(a_{i-1}a_{i-2} \cdots a_1) +b \equiv b \pmod{a_j}\]
    } It suffices to show that $\gcd(b,a_i) = 1$ for all $i$. Suppose that $\gcd(b,a_n) = 1$ for some $n$, then $ \gcd(b,a_{n+1})= \gcd(b,aa_n + b) = 1$. Induction on base case $a_1 = 1$ gives us the result. 

    \item Prove that there does not exist a non-constant polynomial $h(x)$ with integer coefficients such that $h(n)$ is a prime for all integers $n$.
    \newline
    \solu{
    Note that $h(0) = p$ for some prime $p$. Then, $p \mid h(pn)$ for all $n$ implying that $h(pn) = p$ for all $n$. Define a new polynomial such that $R(x) = h(x)-p$. Note that $R$ is a zero polynomial because has infinitely many zeroes. Therefore, $h$ is a constant polynomial. We are done. 
    }

    \item Prove that $2^{2^n}-1$ has at least $n+1$ distinct prime divisors.
    
    \solu{
    Base case $n=6$ is obviously true. We proceed with induction. Suppose that $2^{2^n} - 1$ has $n+1$ distinct divisors. $2^{2^{n+1}} - 1 = \left(2^{2^n}+1\right)\left(2^{2^n} - 1\right)$. Note that $\gcd(2^{2^n}+1,2^{2^n} - 1) = 1$ So there is a new prime $p \mid 2^{2^n}+1$. We are done. 
    }

    \item Prove that $\phi(m)$ is even for any integer $m\geq 3$. (Note that $\phi(1) = \phi(2) = 1$.)
    
    \solu{Solution 1:
    For $4 \mid n$, $\phi(n)$ is obviously even. For $2 \parallel n$, $\phi(n) = \phi\left(\frac{n}{2}\right)$. WLOG assume $n$ is odd. Take the smallest prime $p$ that divides $n$. Note that $\gcd(p-1,n)=1$ and we are done.  
    }

    \solu{Solution 2: $o_m(-1) = 2$ so $2\mid\phi(m)$.}

    \item Let $m$ be a positive integer. Prove that there exists some real number $C>0$ such that $\displaystyle\phi(m) \geq \frac{Cm}{\log m}.$
    \solu{If $m$ has $k$ prime factors $p_1,\ldots,p_k$, then $m\geq p_1p_2\cdots p_k\geq 2^k$. This implies that $\frac{\log m}{\log 2}\geq k$ (as $\log$ is increasing). Hence the number of prime factors of $m$ is less than or equal to $\frac{\log m}{\log 2}$. We see that all primes $p$ which are not a prime factor of $m$ must satisfy $\gcd(m,p)=1$. This implies that $$\phi(m)\geq \pi(m)-\frac{\log m}{\log 2}\geq E\frac{m}{\log m}$$
    for some positive constant $E>0$ when $m$ is sufficiently large. Hence there exist a cutoff $N$ where for all $m>N$, $\phi(m)\geq E\frac{m}{\log m}$. Let
    $$D=\min\left\{\frac{\phi(m)}{\frac{m}{\log m}}: 1\leq m\leq N,m\in\mathbb Z^+\right\}$$
    Note that $D$ is positive since both $\frac{m}{\log m}$ and $\phi(m)$ are positive. Moreover, $D$ satisfy the property that for all $1\leq m\leq N$, $\phi(m)\geq D\frac{m}{\log m}$. Let $C=\min(D,E)>0$ and we see
    $$\phi(m)\geq \frac{Cm}{\log m}$$
    both when $1\leq m\leq N$ and when $N\leq m$, as desired.}

    \item Let $q$ be a prime and $n$ be an integer. Prove that if $q\mid n^q - 1$, then $q^2\mid n^q - 1$. \newline
    \solu{
    This problem is trivial by LTE (Lifting the Exponent lemma). We provide a more elementary proof. FLT gives $n^q -1 \equiv n - 1\equiv 0 \pmod{q}$. Now write $n = 1+kq$. Note that \[n^q - 1\equiv (1+kq)^q - 1 \equiv 1 + \binom{q}{1}kq + \binom{q}{2}\left(kq\right)^2 + \cdots \left(kq\right)^q - 1 \equiv 1 - 1 \equiv 0 \pmod{q^2}\] as desired. 
    }

    \item Prove that for any $k\in\N$, we have $o_{7^k}(2) = 3\cdot7^{k-1}$. 
    \newline 
    \solu{
    The statement is obviously true when $k=1$. Now we can use LTE (Lifting the Exponent Lemma) to get \[8^{7^m} - 1 = \nu_7(8-1) + \nu_7(7^m) = m+1\] Therefore, $3\cdot 7^m$ is the smallest value of $m$ such that $7^{m+1} \mid 2^{3 \cdot 7^m}$. Substitute $k = m+1$ to get our desired result.
    }

    \item Let $q > 3$ be a prime. Prove that there does not exist integers $x,y$ such that $x^{q-1} + \cdots + x + 1 = y^{q-2} - 1.$
    \solu{
    It is well known that all the prime factors of $\Phi_q(x)$ are $q$ or $1 \pmod{q}$. Write $y-1 \equiv 0,1 \pmod{q}$ and $y^{q-3}+y^{q-4}+ \cdots 1 \equiv 0,1 \pmod{q}$.Both of which cannot hold. $y \equiv 1 \pmod{q}$ is obvious and $y \equiv 2$ implies $2^{q-2} \equiv 1 \pmod{q} \Longrightarrow 2^{-1} \equiv 1 \pmod{q}$
    }
\end{enumerate}

\section{Primes of the form $mk+1$ and Cyclotomic polynomials}

Suppose now $m$ is a positive integer, that is not necessarily a prime. It is still true that if $o_p(a) = m$, then $p\equiv 1\pmod{m}$. The difficulty lies in finding the polynomial $\Phi_m(x)$ whose roots mod $p$ have orders exactly $m$, and not proper divisors of $m$. Let's try some small values to see what they should be. When $m = 6$, we should remove solutions to $x^2-1$, as they have order dividing $2$, and $x^3 - 1$, as they have order dividing $3$, but $$\frac{x^6-1}{(x^2-1)(x^3 - 1)} = \frac{x^6-1}{x^5 - x^3 - x^2 + 1}$$
isn't a polynomial. The problem is that when we remove the solutions to $x^2 - 1$, we have already removed the solution to $x - 1$, so we shouldn't remove it again from $x^3 - 1$. In other words, we should take
$$\Phi_6(x) = \frac{x^6 - 1}{(x^2 - 1)\big((x^3 - 1)/(x-1)\big)} = \frac{x^3 + 1}{x + 1} = x^2 - x + 1.$$
What about something more complicated like $\Phi_{105}(x)$? Using the same ``inclusion-exclusion sieve'', we should take
$$\Phi_{105}(x) = \frac{(x^{105}-1)(x^3-1)(x^5-1)(x^7-1)}{(x^{15}-1)(x^{21}-1)(x^{35}-1)(x-1)} = x^{48} + \cdots - 2x^{41} + \cdots + 1.$$
It seems quite random that it is actually a polynomial. We need a better definition that is easier to work with. One thing to note is that we seem to have forgotten about the prime $p$. So let's forget it completely and think in $\C$.

What are the solutions to $x^m = 1$ in $\C$? They are given by $\zeta_m^k$ for $k = 1,2,\ldots, q$ where $\zeta_m = e^{2\pi i/m}$ is the \textbf{primitive} $m$-th root of unity, as the smallest positive integer $d$ such that $\zeta_m^d = 1$ is $m$. We have the factorization 
$$x^m - 1 = \prod_{k=1}^m (x - \zeta_m^k).$$
Since we want the roots of our polynomial $\Phi_m(x)$ to have order $m$, we define the \textbf{$m$-th cyclotomic polynomial} as
$$\Phi_m(x) = \prod_{\substack{1\leq k\leq m\\ o(\zeta_m^k) = m}}(x - \zeta_m^k)$$
where $o(\zeta_m^k)$ is the smallest positive integer $d$ such that $(\zeta_m^k)^d = 1$. We know
$$\zeta_m^{kd} = 1 \Leftrightarrow m\mid kd \Leftrightarrow \frac{m}{\gcd(m,k)}\mid\frac{k}{\gcd(m,k)}d\Leftrightarrow \frac{m}{\gcd(m,k)}\mid d.$$
So $o(\zeta_m^k) = m/\gcd(m,k).$ Hence, it is $m$ if and only if $\gcd(m,k) = 1$. In other words, we have
$$\Phi_m(x) = \prod_{\substack{1\leq k\leq m\\ \gcd(k,m)=1}}(x - \zeta_m^k).$$
 The polynomial $\Phi_q(x)$ is monic with coefficients in $\C$ and has degree $\phi(q)$. Our next goal is to show that all the coefficients of $\Phi_m(x)$ are integers, and that $\Phi_m(x)$ can be used to prove the infinitude of primes of the form $mk + 1$.
 
\begin{center}
    \add{Lecture 8 Fri 09/22}
\end{center}

\begin{proposition}
    Let $m\in\N$. We have the factorization $$x^m - 1 = \prod_{d\mid m}\Phi_d(x).$$
\end{proposition}

\begin{proof}
    In the factorization of $x^m - 1$, we can group the factors $x - \zeta_m^k$ by the order $o(\zeta_m^k)$. Since $o(\zeta_m^k) = m/\gcd(m,k)$ is a positive divisor of $m$, we have
    $$x^m - 1 = \prod_{d\mid m} \prod_{\substack{1\leq k\leq q\\ o(\zeta_m^k) = d}}(x - \zeta_m^k).$$
    Note that $o(\zeta_m^k) = d$ if and only if $\gcd(m,k) = m/d$ if and only if $k = (m/d)j$ for some integer $j$ with $\gcd(m,(m/d)j) = m/d.$ Now
    $$\gcd(m,(m/d)j) = \gcd((m/d)d,(m/d)j) = (m/d)\gcd(d,j).$$
    Hence $o(\zeta_m^k) = d$ if and only if $k = (m/d)j$ for some integer $j$ with $\gcd(d,j) = 1$. The condition $1\leq k\leq m$ becomes $1\leq j\leq d$. Moreover, the complex number $$\zeta_m^k = e^{\frac{2\pi i}{m}\frac{m}{d}j} = e^{\frac{2\pi i}{d}j} = \zeta_j^d.$$ Therefore, the product
    $$\prod_{\substack{1\leq k\leq m\\ o(\zeta_m^k) = d}}(x - \zeta_m^k) = \prod_{\substack{1\leq j\leq d\\ \gcd(j,d)=1}}(x - \zeta_d^j) = \Phi_d(x).$$
    We are now done.
\end{proof}

\begin{cor}\label{cor:sumphi}
    Let $m\in\N$. Then $\displaystyle m = \sum_{d\mid m}\phi(d).$
\end{cor}

\begin{cor}
    Let $m\in\N$. Then $\Phi_m(x)$ is a polynomial with integer coefficients. Moreover, $\Phi_1(0) = -1$ and $\Phi_m(0) = 1$ for $m\geq 2$.
\end{cor}

\begin{proof}
    We prove by induction on $m$. We have $\Phi_1(x) = x - 1$. Suppose now $m\geq 2$. We know that
    $$x^m - 1 = \Phi_m(x)\cdot\Phi_1(x)\prod_{\substack{d\mid m\\ 1 <d < m}}\Phi_d(x) = \Phi_m(x)\cdot(x - 1)\prod_{\substack{d\mid m\\ 1 <d < m}}\Phi_d(x).$$
    By induction, each of the $\Phi_d(x)$ for $d<m$ is a monic polynomial with integer coefficient and so is their product. Therefore, so is the quotient of $x^m - 1$ by it. Also by induction, we have $\Phi_d(0) = 1$ for $1<d<m$. So setting $x = 0$ gives $\Phi_m(0) = 1$.
\end{proof}

\noindent\textbf{Remark}: There is a more direct proof of $\Phi_m(0) = 1$ for $m>2$. Let $S$ be the set of integers $1\leq j < m/2$ that are coprime to $m$. Then the set of integers $m/2 < k \leq m$ coprime to $m$ are all of the form $m - j$ for some $j\in S$. If $m/2$ is an integer, then it is at least $2$ and divides $m$, so it is not coprime to $m$. Now
$$\Phi_m(0) = \prod_{j\in S}(-\zeta_m^j)(-\zeta_m^{m-j}) = 1.$$

\begin{proposition}
    Let $n\in\N$ and let $n>1$ be an integer coprime to $m$. Let $a\in\Z$ with $n\mid \Phi_n(a)$. Then $o_n(a) = m$.
\end{proposition}

\begin{proof}
    We write $x^m - 1$ as $F(x)\Phi_m(x)$ where $F(x)\in\Z[x]$ is the product of $\Phi_d(x)$ over all positive integers $d\mid m$ with $d<m$. Then $\Phi_m(a)\mid a^m - 1$ and we have $n\mid a^m - 1$. Hence $o_n(a)\mid m$.
    Suppose for a contradiction that $\ell:=o_n(a)<m$. Then we have $n\mid a^\ell - 1$.  Since $\ell\mid q$ and $\ell < q$, we know that any divisor of $\ell$ is a divisor of $q$ and is less than $q$. In other words, $$F(x) = \prod_{d\mid \ell}\Phi_d(x)\cdot\prod_{\substack{d\mid m\\ d<m \\ d\nmid\ell}}\Phi_d(x) = (x^\ell - 1)G(x)$$ for some $G(x)\in\Z[x]$. We thus have the factorization
    $$a^q - 1 = (a^\ell - 1)\Phi_q(a)G(a).$$
    Fix some prime $p$ dividing $n$, which exists since $n>1$. From $p\mid n$ and $n\mid \Phi_m(a)$, we have $p\mid\Phi_m(a)$ and so
    $$\nu_p(a^m - 1) = \nu_p(a^\ell - 1) + \nu_p(\Phi_m(a)) + \nu_p(G(a)) > \nu_p(a^\ell - 1).$$
    Since $\ell\mid q$, we write $q = \ell k$ for some positive integer $k$. Then
    $$a^q - 1 = (a^\ell - 1)((a^\ell)^{k-1} + (a^\ell)^{k-2} + \cdots + 1).$$
    Since $n\mid a^\ell-1$ and $p\mid n$, we have $a^\ell\equiv 1\pmod{p}$ and so
    $$(a^\ell)^{k-1} + (a^\ell)^{k-2} + \cdots + 1 \equiv 1+1+\cdots+1 = k\pmod{p}.$$
    Since $\gcd(n,m) = 1$ and $k\mid m$ and $p\mid n$, we have $p\nmid k$. This implies that $\nu_p(a^q - 1) = \nu_p(a^d - 1)$. Contradiction.
\end{proof}

\begin{cor}
    Let $n\in\N$. Suppose there exists $a\in\Z$ such that $n\mid\Phi_{n-1}(a)$, then $n$ is a prime.
\end{cor}

\begin{proof}
    Since $n$ is coprime to $n-1$, we have $o_n(a) = n-1$ but $o_n(a)\leq\phi(n)\leq n - 1$. So $\phi(n) = n - 1$. Hence $n$ is a prime.
\end{proof}

\begin{cor}
    Let $m\in\N$. Let $a\in\Z$. Then any prime divisor of $\Phi_m(ma)$ is of the form $mk+1$.
\end{cor}

\begin{proof}
    Let $p$ be prime divisor of $\Phi_m(ma)$. Since the constant term of $\Phi_m(x)$ is $\pm1$, we see that $\gcd(m,\Phi_m(ma)) = 1$ and so $p\nmid m$. Hence $o_p(a) = q$ which implies that $q\mid p-1$.
\end{proof}

\begin{theorem}
    Let $m\in\N$. There are infinitely many primes of the form $mk + 1$.
\end{theorem}

\begin{proof}
    Since $\Phi_m(x)$ is monic, we know that $\Phi_m(x)\rightarrow\infty$ as $x$ goes to infinity. Let $N$ be a large integer such that $\Phi_m(x) > 1$ for all $x\geq N$. We now construct the sequence by taking $a_1 = N$ and
    $$a_{n+1} = \Phi_m(Nma_1a_2\cdots a_n).$$
    Then we have a sequence of pairwise coprime (because the constant term of $\Phi_m(x)$ is $\pm1$) integers at least $2$, each having only prime divisors of the form $mk+1$.
\end{proof}

\begin{center}
    \add{Lecture 9 Mon 09/25}
\end{center}

It makes one wonder for which coprime positive integers $a$ and $m$ does there exist a Euclid type proof for the infinitude of primes congruent to $a$ mod $m$. All of these proofs lead to the construction of an \textbf{Euclidean polynomial} for $a$ mod $m$, which is a polynomial $h(x)$ with integer coefficients such that the prime divisors of $h(n)$ for integers $n$ (either belong to a fixed finite set, or) are $1$ mod $m$, or are $a$ mod $m$; and that infinitely many primes that are $a$ mod $m$ arise this way.

\begin{theorem}
    A Euclidean polynomial for $a$ mod $m$ exists if and only if $a^2\equiv 1\pmod{m}$.
\end{theorem}

Schur (1912) proved the backwards direction and Murty (1988) proved the forwards direction. For example, this implies that there are no Euclid type argument for the infinitude of primes of the form $5k+2$. 

Here are some Euclidean polynomials in small moduli:
\begin{enumerate}[(a)]
    \item Primes dividing $5(2n)^2 - 1$ are congruent to $1$ or $4$ mod $5$. 
    \item Primes dividing $2n^2+1$ are congruent to $1$ or $3$ mod $8$. 
    \item Primes dividing $2n^2-1$ are congruent to $1$ or $7$ mod $8$.
   % \item Odd primes dividing $n^2+4$ are congruent to $1$ or $5$ mod $8$.
    \item Primes dividing $(7n)^3 + (7n)^2 - 2(7n) - 1$ are congruent to $1$ or $6$ mod $7$.
    \item Primes dividing $(3n)^3 - 3(3n) - 1$ are congruent to $1$ or $8$ mod $9$.
\end{enumerate}
Statements (a) - (c) are results in Quadratic Reciprocity. Statement (d) and (e) use the theory of finite fields. Schur's result uses a bit more of the theory of fields and Galois theory. We will spend the remainder of this semester working towards these theories. Murty's result is about the splitting of primes and uses Chebotarev's density theorem, which is ironic because it is actually a generalization of Dirichlet's result on primes in arithmetic progression! %Statement (d) was already proved since being $1$ or $5$ mod $8$ is the same as being $1$ mod $4$ and $x^2\equiv -4\pmod{p}$ has a solution for odd prime $p$ if and only if $x^2\equiv -1\pmod{p}$ has a solution. We are simply using $n^2+4$ so that it is congruent to $5$ mod $8$ when $n$ is odd, as opposed to taking $4n^2+1$ to gaurantee that it is $1$ mod $4$.

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Compute $\Phi_9(x)$ and find a polynomial $f(x)$ such that $x^3f(x + x^{-1}) = \Phi_9(x)$. \newline
    \solu{
    Recall the well known fact on cyclotomic polynomials: \[p \mid n \Longrightarrow \Phi_{pn}(x) = \Phi_n(x^p)\]
    Note that $\Phi_3(x) = x^2 + x+1$ and $\Phi_9(x) = \Phi_3(x^3) = x^6 + x^3 + 1$. Since this is palindromic, we can write it in multiples of $x+ \frac{1}{x}$. Note that \[x^3 + \frac{1}{x^3} = \left(x + \frac{1}{x}\right)^3 - 3\left(x + \frac{1}{x}\right)\] Therefore, $f(x) = x^3 - 3x+1$
    }
    \item Prove that for any $k\in\N$, we have $\Phi_{2^k}(x) = x^{2^{k-1}}+1$.\newline
    \solu{
    Note that $k=1$ is obviously true. Then apply the well known fact $p \mid n \Longrightarrow \Phi_{pn}(x) = \Phi_n(x^p)$ with $p=2$ to get the result. 
    }
    
    \item Prove that for any $k\in\N$, we have $\Phi_{3^k}(x) = x^{2\cdot 3^{k-1}}+x^{3^{k-1}} + 1$.
    \newline
    \solu{
    The $k=1$ case is obviously true as $\Phi_3(x) = x^2 + x+1$ Using the well known fact that $p \mid n \Longrightarrow \Phi_{pn}(x) = \Phi_n(x^p)$ with $p = 3$ gives the result. 
    }
    \item Prove that for any $h,k\in\N$, we have $\Phi_{2^h3^k}(x) = x^{2^h 3^{k-1}}-x^{2^{h-1}3^{k-1}} + 1$.
    \newline 
    \solu{
    First, verify that this is true when $(h,k) = (1,1)$ This is obvious because $\Phi_6(x) = x^2 - x +1$. Then double induction with the well known fact $p \mid n \Longrightarrow \Phi_{pn}(x) = \Phi_n(x^p)$ and $p_1 = 2, p_2 = 3$ kills the problem. 
    }
    \item Suppose $q\in\N$ such that $\Phi_q(x) = x^{2s} + cx^s + 1$ for some nonzero integer $c$, where $s = \phi(q)/2$. Prove that $c = \pm1$.
    \newline
    \solu{
    Let $\zeta$ be a primitive $q$th root of unity. Then we have \[\Phi_q(\zeta) = \zeta^{2s}+ c\zeta^s + 1 = 0 \Longrightarrow c = \left\vert \zeta^s + \frac{1}{\zeta^s}\right\vert \]
    $|c|>2$ is obviously impossible. Suppose that $|c| =2$. Triangle inequality gives \[ 2 = |\zeta^{s}|+ \left|\frac{1}{\zeta^s}\right| = 1+1 \geq \left\vert \zeta^s + \frac{1}{\zeta^s}\right\vert\] Equality case holds iff the arguments of $\zeta^s$ and $\zeta^{-s}$ equal. This only happens when $\zeta = \pm 1$ which is not possible since $q \neq 1,2$. %Finally, $c \neq 0$ otherwise $\Phi_{q} = x^{\phi(q)}+1$ and $\zeta_{2q}$ is a root of the polynomial. We are done. 
    }
    \item Prove that if $p$ is a prime at least $5$, then there exists a polynomial $h(x)$ with integer coefficients such that $x^{2p} + x^p + 1 = (x^2 + x + 1)h(x).$
    \newline
    \solu{
    Notice that $\{0,p,2p\}$ forms a complete residue class $\pmod{3}$ when $p \ge 3$. Hence $\zeta_3$ and $\zeta_3^2$ are distinct roots of $x^{2p}+x^p + 1$. Hence $x^{2p}+x^p+1$ is divisible by $(x - \zeta_3)(x - \zeta_3^2) = x^2 + x + 1$.%Plugging in the primitive $3$rd roots of unity reduces it to $\zeta_3^2 + \zeta_3+1 = 0$ so $\Phi_3(x) \mid x^{2p} + x^p + 1$
    }
    \item We will see later that the cyclotomic polynomials $\Phi_q(x)$ are all irreducible in the sense that they do not admit a factorization into a product of polynomials with integer coefficients with smaller degrees. You will prove in HW 3 that $\Phi_q(x)$ is reciprocal in the sense that $\Phi_q(x^{-1}) = x^{-\phi(q)}\Phi_q(x).$ Prove that if $\Phi_q(x)$ is a trinomial, that is of the form $x^{\phi(q)} + cx^s + 1$ for some nonzero integers $c,s$, then $q = 2^h3^k$ for some non-negative integer $h$ and positive integer $k$.
    \newline 
    \solu{
    Solution 1 (without using irreducibility): We establish some well known facts proven in previous exercises. Since $\Phi_n(x)$ is palindromic for all $n>2$, we have $s = \frac{\phi(q)}{2}$. Furthermore, $c = \pm 1$. Suppose that $c = -1$. Then $x = \zeta_{6s}$ is a root of $\Phi_q(x)$. Additionally, note that $\zeta_{6s}$ is a primitive $(6s)$th root of unity so \[q = 6s \Longrightarrow \phi(q) = \frac{q}{3}\] For contradiction, assume that there is a $p \neq 2,3$ that divides $q.$ Then, \[\phi(q) \le \frac{1}{2} \cdot \frac{2}{3} \cdot \frac{p-1}{p}q < \frac{q}{3},\] a contradiction. Therefore, when $c = -1$, $q = 2^m3^n$ for $m,n \in \mathbb N^2.$ \newline Suppose that $c = 1$, then $\zeta_{3s}$ is a $(3s)$th root of unity, giving $q = 3s$. Substituting, we get $\frac{2}{3}q = \phi(q)$. For contradiction, assume that there is a prime $p \neq 3$ that divides $q$. Then, \[\phi(q) \le \frac{2}{3} \cdot \frac{p-1}{p} q < \frac{2}{3}q\] a contradiction. We are done. 

    Solution 2: By irreducibility and 6.6, we see that $\phi(q)$ cannot have any prime divisor at least $5$. The case of $c = -1$ is covered by 6.4. The case of $c = 1$ and $s$ odd is covered by 6.3. If $c = 1$ and $s = 2k$ is even, then
    $$x^{4k} + x^{2k} + 1 = (x^{2k} + x^k + 1)(x^{2k} - x^k + 1)$$
    is reducible. Therefore, we see that there exists some non-negative integer $h$ and positive integer $k$ such that $\Phi_q(x) = \Phi_{2^h3^k}(x)$. Hence $q = 2^h3^k$.
    }
    \item Using the fact that primes dividing $2n^2 + 1$ are congruent to $1$ or $3$ mod $8$, prove that there are infinitely many primes of the form $8k+3$. \newline 
    \solu{
    Suppose there are finitely many primes $p_1,p_2,\cdots p_i$ of the form $8k+3$. Take $n = \prod_{k=1}^i p_k$ and deduce that $2n^2+1 \equiv 3 \pmod{8}$. Note that $\gcd(2n^2 + 1, n) = 1$ and since all primes that divide $2n^2 +1$ are $1,3 \pmod{8}$, there is at least one new prime $3 \pmod{8}$ that divides $2n^2 +1$. We are done. 
    }
    
\end{enumerate}


\section{Abstract Algebra}

We have seen so many beautiful results about the integers and if you think about it, everything really just boils down to addition and multiplication, and a notion of size. The sets $\Q$, $\R$, $\C$ or the sets of polynomials with coefficients in them also have addition and multiplication and a notion of size. Can we try defining primes and gcd and do all of the above? For example, what should a prime in $\R$ mean, what should a prime in $\R[x]$ mean?

The key in defining a prime is the notion of divisibility. We say $a\mid b$ in $\Z$ if $b = ka$ for some $k\in\Z$. The natural extension to $\R$ would be that $a\mid b$ in $\R$ if $b = ka$ for some $k\in\R$. This is a little silly because we can divide in $\R$ so if $a\neq 0$, then by taking $k = b/a$, we have $b = ka$. This is more meaningful in $\R[x]$ where we say $a\mid b$ in $\R[x]$ if $b = ka$ for some $k\in \R[x]$. Then we have non-divisions like $x+1 \nmid x^2 + 1$. Note that the definition of division only uses multiplication.

In abstract algebra, we step away from numbers and consider any set for which arithmetic operations like addition and multiplication can be defined.

\vspace{5pt}
\noindent\textbf{Definition}: A \textbf{commutative ring} $R$ is a set equipped with two binary operations: $$(a,b)\mapsto a+b:R\times R\rightarrow R,\qquad (a,b)\mapsto ab:R\times R\rightarrow R,$$
one unary operation: $$a\mapsto -a: R\rightarrow R$$
and two nullary operations: $$0\in R,\qquad 1\in R$$
such that the usual laws of arithmetic hold:
\begin{enumerate}[(1)]
    \item (Commutative) $a + b = b + a$ and $ab = ba$;
    \item (Associative) $a + (b + c) = (a + b) + c$ and $a(bc) = (ab)c$;
    \item (Distributive) $a(b + c) = ab + ac$;
    \item (Additive identity) $a + 0 = a$ and $a + (-a) = 0$;
    \item (Multiplicative identity) $a\cdot 1 = a$.
\end{enumerate}

\noindent\textbf{Remark}: More generally, we do not assume multiplication to be commutative (for example matrix multiplication is not commutative) in which case we will add $(b+c)a = ba + ca$ to (3) and $1\cdot a = a$ to (5). All rings are assumed to be commutative in this class.

\vspace{5pt}
We do not assume that a multiplicative inverse $a^{-1}$ always exist. We say $a\mid b$ in $R$ if there exists $k\in R$ such that $b = ka$. If $a\mid 1$, that is if $ab = 1$ for some $b\in R$, then we say $a$ is a \textbf{unit} and write $b = a^{-1}$. We define the \textbf{group of units} as $$R^\times = \{a\in R\colon \exists b\in R, ab = 1\}.$$

\noindent\textbf{Examples}:
\begin{enumerate}
    \item The set $\Z$ of integers with the usual $0,1,+,\times,-$ is a commutative ring. An integer $a\in\Z$ is a unit if and only if $a\mid 1$ if and only if $a = \pm 1$. So $\Z^\times = \{1,-1\}$.
    \item The sets $\Q$, $\R$, $\C$ with the usual operations are all commutative rings. Every nonzero element is a unit.

    A commutative ring $R$ is \textbf{field} if $R^\times = R \backslash \{0\}.$
    \item If $R$ is a commutative ring, then the set $R[x]$ of polynomials with coefficients in $R$ is a commutative ring. When $R = \Z,\Q,\R,\C$, we know that $\deg(fg) = \deg(f)\deg(g)$; so if $fg = 1$, then $\deg(f) = 0$ and $\deg(g) = 0$. So they are constants in $R$. Hence when $R = \Z,\Q,\R,\C$, $R[x]^\times = R^\times.$

    In general, we can still define the degree $\deg(f)$ of a polynomial $f\in R[x]$ as the largest integer $n$ such that the coefficient of $x^n$ in $f$ is nonzero. An essential step in proving $\deg(fg) = \deg(f)\deg(g)$ requires knowing that if $a,b\neq0$, then $ab\neq 0$.

    A commutative ring is an \textbf{integral domain} if $a\neq 0\wedge b\neq 0\Rightarrow ab\neq 0$.

    \begin{lemma}\label{lem:degfg}
        If $R$ is an integral domain, then $R[x]$ is also an integral domain and $R[x]^\times = R^\times$. Moreover, for any $f,g\in R[x]$ that are nonzero, $\deg(fg) = \deg(f) + \deg(g)$.
    \end{lemma}

    \begin{lemma}\label{lem:fieldid}
        If $R$ is a field, then $R$ is an integral domain.
    \end{lemma}

    \item Can we make $R = \{0\}$ into a ring? Take $1 = 0$ and $0+0=0\times0 = -0 = 0.$ This is the trivial ring. We will henceforth assume $0\neq 1$ for rings.

    \item Can we make $R = \{0,1\}$ (where $0\neq 1$) into a ring? We must have $$0+0 = 0,\quad 0 + 1 = 1, \quad 1\times 1 = 1,\quad -0 = 0.$$
    The next two lemmas force $$0\times 1 = 0,\quad 0\times 0 = 0,\quad 1 + 1 = 0,\quad -1 = 1.$$ Since $1\times 1 = 1$, we see that $\{0,1\}$ is a field (and an integral domain). We denote this ring suggestively by $\Z/2\Z$ or $\F_2$. It is then a boring exercise to prove that $\times$ and $+$ satisfy associativity and distributivity. We will see a better way to check this next time.

    \begin{lemma}\label{lem:multi0}
        Let $R$ be a commutative ring. Then $a\cdot 0 = 0$, $a\cdot(-1) = -a$ and $-(-a) = a$ for any $a\in R$.
    \end{lemma}

    %We note also some immediate restrictions on the addition and multiplication tables of $R$.
    \begin{lemma}\label{lem:perm}
        Let $R$ be a commutative ring. Let $a\in R$. The map $x\mapsto x + a$ defines a bijection $R\rightarrow R$. The map $x\mapsto xa$ is a bijection $R\rightarrow R$ if and only if $a\in R^\times$.
    \end{lemma}

    \begin{proof}
        The map $x\mapsto x + (-a)$ is the inverse of $x\mapsto x+a$. If $a\in R^\times$, then $x\mapsto xa^{-1}$ is the inverse of $x\mapsto xa$. Conversely, if $x\mapsto xa$ is surjective, then $ba = 1$ for some $b\in R$ and so $a\in R^\times$.
    \end{proof}

    \begin{cor}
        Let $R$ be an integral domain. Suppose $R$ is finite. Then $R$ is a field.
    \end{cor}

    \begin{proof}
        Let $a$ be a nonzero element. Then for any $x\neq y$, we have $x - y\neq 0$ and so $(x - y)a\neq 0$, implying that $xa\neq ya$. So the map $x\mapsto xa:R\rightarrow R$ is injective. An injective map between two finite sets of the same size is surjective (by the Pigeonhole principle).
    \end{proof}

    \begin{center}
    \add{Lecture 10 Wed 09/27}
\end{center}

    The above arithmetic on $\{0,1\}$ looks just like the addition and multiplication property of even and odd numbers. More precisely, consider a map $f:\Z\rightarrow\{0,1\}$ sending all even numbers to $0$ and all odd numbers to $1$. Then for any $a,b\in\Z$, we have
    $$f(a+b) = f(a) + f(b),\qquad f(ab) = f(a)f(b),\qquad f(-a) = -f(a),\qquad f(0) = 0,\qquad f(1) = 1.$$
    In other words, $f$ respects the ring operations on $\Z$ and on $\{0,1\}$. Since $f$ is surjective and we know the usual addition and multiplication on $\Z$ are associative and distributive, we can also use it to prove that $+,\times$ on $\{0,1\}$ satisfy associativity and distributivity.

    In general, a \textbf{ring homomorphism} is a map $f:R_1\rightarrow R_2$ between two rings $R_1,R_2$ such that for any $a,b\in R_1$, $$f(a+b) = f(a) + f(b),\qquad f(ab) = f(a)f(b),\qquad f(1) = 1.$$
    Take $a = b = 0$, we get $f(0) = f(0) + f(0)$ and so $f(0) = 0$. Then take $b = -a$ to get $f(-a) = -f(a)$. The assumption $f(1) = 1$ is required to rule-out the $0$ map.

    \item What about a ring with 3 elements?

    Suppose $R$ is a ring with 3 elements, namely $0$, $1$, $\alpha$. Let's write down its addition and multiplication table. Each row and column of the addition table should be a permutation of $0,1,\alpha$ by Lemma \ref{lem:perm}. To find $\alpha^2$, we use $\alpha\alpha = \alpha(1+1) = \alpha + \alpha = 1.$
    \begin{center}
    \begin{tabular}{c|c|c|c}
             $+$&$0$&$1$&$\alpha$  \\ \hline
             $0$&$0$&$1$&$\alpha$  \\ \hline
             $1$&$1$&$\add{\alpha}$&$\add{0}$  \\ \hline
             $\alpha$&$\alpha$&$\add{0}$&$\add{1}$  
    \end{tabular}
    \hspace{50pt}
    \begin{tabular}{c|c|c|c}
             $\times$&$0$&$1$&$\alpha$  \\ \hline
             $0$&$0$&$0$&$0$  \\ \hline
             $1$&$0$&$1$&$\alpha$  \\ \hline
             $\alpha$&$0$&$\alpha$&$\add{1}$  
    \end{tabular}
    \end{center}
    Since there is only one way to fill out the addition and multiplication tables, we know there is at most ``one'' ring with 3 elements. More precisely, suppose $R'$ is another ring with $3$ elements, namely $0$, $1$, $\beta$. We can define a map $f:R\rightarrow R'$ by $$f(0) = 0,\qquad f(1) = 1,\qquad f(\alpha) = \beta.$$
    Then $f$ is a ring homomorphism that is also a bijection. An \textbf{isomorphism} is a ring homomorphism that is a bijection. We say the two rings $R$ and $R'$ are \textbf{isomorphic} if there is an isomorphism between them and we write $R\cong R'$. Isomorphic rings are really the ``same thing'' but just with different labels. Any two rings with $3$ elements are isomorphic and they are fields.

    Finally to prove that a ring with 3 elements exists, we can take the above addition and multiplication and verify distributivity and associativity. Alternatively, we can use the surjective map $f:\Z\rightarrow \{0,1,\alpha\}$ sending integers of the form $3k$ to $0$, $3k+1$ to $1$, and $3k+2$ to $\alpha$. We denote this ring suggestively by $\Z/3\Z$ or $\F_3$.


    \item When we go to $4$ elements, we encounter the first ring that is not an integral domain (and so not a field). We can use the surjective map $f:\Z\rightarrow \{0,1,\alpha,\beta\}$ sending integers of the form $4k$ to $0$, $4k+1$ to $1$, $4k+2$ to $\alpha$, and $4k+3$ to $\beta$, to define a ring structure on $\{0,1,\alpha,\beta\}$. The addition and multiplication table look like
    \begin{center}
    \begin{tabular}{c|c|c|c|c}
             $+$&$0$&$1$&$\alpha$&$\beta$  \\ \hline
             $0$&$0$&$1$&$\alpha$&$\beta$  \\ \hline
             $1$&$1$&$\alpha$&$\beta$&$0$  \\ \hline
             $\alpha$&$\alpha$&$\beta$&$0$&$1$   \\ \hline
             $\beta$&$\beta$&$0$&$1$&$\alpha$
    \end{tabular}
    \hspace{50pt}
    \begin{tabular}{c|c|c|c|c}
             $\times$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $0$&$0$&$0$&$0$&$0$  \\ \hline
             $1$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $\alpha$&$0$&$\alpha$&$0$&$\alpha$  \\ \hline
             $\beta$&$0$&$\beta$&$\alpha$&$1$
    \end{tabular}
    \end{center}
    Note that we have $\alpha^2 = 0$ in this ring. So it is not an integral domain. We denote this ring suggestively by $\Z/4\Z$.
    
    In the above addition table, the key is that $1 + 1 \notin \{0,1\}$. We may assume, by renaming, that $1 + 1 = \alpha$, which then forces $1+\alpha = \beta$ and $1 + \beta = 0$ and then the rest of the addition table will be identical to the above. Note that since every element here is a sum of $1$'s, the multiplication is also determined because by distributivity,
    $$\underbrace{(1+\cdots+1)}_{n}\cdot \underbrace{(1+\cdots+1)}_{m} = \underbrace{(1+\cdots+1)}_{nm}.$$ 
    This also implies that there is a unique ring structure on $\Z$ if $+$ is the usual addition.

    There are three other (non-isomorphic) rings with 4 elements where $1 + 1\in\{0,1\}$, that is $1 + 1 = 0$. Note that we must have $\alpha + \alpha = \alpha(1+1) = 0$. The addition table is now uniquely determined.
    \begin{center}
    \begin{tabular}{c|c|c|c|c}
             $+$&$0$&$1$&$\alpha$&$\beta$  \\ \hline
             $0$&$0$&$1$&$\alpha$&$\beta$  \\ \hline
             $1$&$1$&$\add{0}$&$\add{\beta}$&$\add{\alpha}$  \\ \hline
             $\alpha$&$\alpha$&$\add{\beta}$&$\add{0}$&$\add{1}$   \\ \hline
             $\beta$&$\beta$&$\add{\alpha}$&$\add{1}$&$\add{0}$
    \end{tabular}
    \hspace{20pt}
    \begin{tabular}{c|c|c|c|c}
             $\times_1$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $0$&$0$&$0$&$0$&$0$  \\ \hline
             $1$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $\alpha$&$0$&$\alpha$&$\add{0}$&$\add{\alpha}$ \\ \hline
             $\beta$&$0$&$\beta$&$\add{\alpha}$&$\add{1}$
    \end{tabular}
    \hspace{10pt}
    \begin{tabular}{c|c|c|c|c}
             $\times_2$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $0$&$0$&$0$&$0$&$0$  \\ \hline
             $1$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $\alpha$&$0$&$\alpha$&$\add{\alpha}$&$\add{0}$ \\ \hline
             $\beta$&$0$&$\beta$&$\add{0}$&$\add{\beta}$
    \end{tabular}
    \hspace{10pt}
    \begin{tabular}{c|c|c|c|c}
             $\times_3$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $0$&$0$&$0$&$0$&$0$  \\ \hline
             $1$&$0$&$1$&$\alpha$&$\beta$   \\ \hline
             $\alpha$&$0$&$\alpha$&$\add{\beta}$&$\add{1}$ \\ \hline
             $\beta$&$0$&$\beta$&$\add{1}$&$\add{\alpha}$
    \end{tabular}
    \end{center}
    There are now multiple options for the multiplication table. We note that it is determined by $\alpha^2$ as $$\alpha\beta = \alpha(\alpha+1) = \alpha^2 + \alpha,\qquad\beta^2 = (\alpha+1)^2 = \alpha^2 + 1.$$ There are now three isomorphism classes. If $\alpha^2\in\{0,1\}$, then either $\alpha^2 = 0$ or $\beta^2 = 0$ and so by renaming, we may assume $\alpha^2 = 0$ and we get the ring $\F_2[x]/(x^2)$. If $\alpha^2 = \alpha$, then we get the ring $\F_2[x]/(x^2 - x).$ If $\alpha^2 = \beta$, then we get the ring $\F_4$. We list the special property that they each have to show that they are all non-isomorphic.
    \begin{enumerate}
        \item $\Z/4\Z$ has an element $a$ such that $a + a\neq 0$.
        \item $\F_2[x]/(x^2)$ has a nonzero element $a$ such that $a^2 = 0$.
        \item $\F_2[x]/(x^2 - x)$ has the property that every element $a$ is idempotent, that is $a^2 = a$.
        \item $\F_4$ is an integral domain (and also a field).
    \end{enumerate}

    \begin{lemma}\label{lem:can}
        Let $R$ be a commutative ring. There is a unique ring homomorphism $f:\Z\rightarrow R$.
    \end{lemma}

    If this map $f$ is injective, then we say that the \textbf{characteristic} of $R$ is $0$. If $f$ is not surjective, then there is some nonzero integer $a$ such that $f(a) = 0$. Now $f(-a) = -f(a) = 0$, so we may assume $a$ is positive. The smallest positive integer $d$ such that $f(d) = 0$ is the \textbf{characteristic} of $R$.

    \begin{lemma}
        If $R$ is an integral domain, then its characteristic is either $0$ or a prime.
    \end{lemma}

    \begin{proof}
        Suppose the characteristic $d$ of $R$ is positive. Let $q$ be a positive divisor of $d$ so $d = qk$ for some $k\in\N$. Then $f(q)f(k) = f(d) = 0$. Since $R$ is an integral domain, either $f(q) = 0$ or $f(k) = 0$. By minimality of $d$, we have $q = d$ in the first case, and $k = d$ so $q = 1$ in the second case. Hence we have shown that the only positive divisors of $d$ are $1$ and $d$. In other words, $d$ is a prime.
    \end{proof}

    The ring $\Z/4\Z$ has characteristic $4$ while the other 3 has characteristic $2$. In (b), (c), (d), the subset $\{0,1\}$ with addition and multiplication in the respective rings forms a ring, isomorphic to $\F_2$. A \textbf{subring} of a ring $R$ is a subset $R'$ that is closed under all the operations of $R$: namely it contains $0$ and $1$, contains $a+b$, $ab$ and $-a$ for any $a,b\in R'$.

    \item If $R_1,R_2$ are two rings, then $R_1\times R_2 = \{(a,b)\colon a\in R_1,b\in R_2\}$ has a ring structure by coordinate-wise operations. It is the unique ring structure on $R_1\times R_2$ so that the projection maps $(a,b)\mapsto a$ and $(a,b)\mapsto b$ are ring homomorphisms. The ring $\F_2\times\F_2$ has 4 elements $(0,0), (0,1), (1,0), (1,1)$ and every element is idempotent. Hence $\F_2\times\F_2 \cong \F_2[x]/(x^2 - x)$. 

    Note that if $R$ is a ring and $f_1:R\rightarrow R_1$ and $f_2:R\rightarrow R_2$ are ring homomorphisms, then the map $f:R\rightarrow R_1\times R_2$ defined by $f(r) = (f_1(r), f_2(r))$ is a ring homomorphism. 

\end{enumerate}

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Let $R$ be a commutative ring with $a,b,c\in R$. Prove that if $ab = 1 = ac$, then $b = c$.
    \solu{
    Multiplicative inverse of an element is unique if it exists. Take $b = b1 = bac = 1c = c \Longrightarrow b = c$
    }
    \item Prove Lemmas \ref{lem:degfg}, \ref{lem:fieldid}, \ref{lem:multi0}, \ref{lem:can}.
    \solu{
    trivial
    }
    \item Let $R$ be a commutative ring and let $S$ be a set with $+,\times,-,0,1$. Let $f:R\rightarrow S$ be a surjective map such that for any $a,b\in R$, we have $$f(a+b) = f(a) + f(b),\qquad f(ab) = f(a)f(b),\qquad f(-a) = -f(a),\qquad f(0) = 0,\qquad f(1) = 1.$$
    Prove that $S$ with $+,\times,-,0,1$ is a commutative ring.
    \solu{
    Map is surjective and $S$ satisfies all five of the ring axioms. 
    }
    \item Let $R_1,R_2,R_3$ be commutative rings and let $f:R_1\rightarrow R_2$ and $g:R_2\rightarrow R_3$ be ring homomorphisms. Prove that $g\circ f:R_1\rightarrow R_3$ defined by $(g\circ f)(a) = g(f(a))$ is a ring homomorphism.
    \solu{
    Additive: \[g(f(x+y)) = g(f(x)+ f(y)) = g(f(x)) + g(f(y))\]
    Multiplicative: 
    \[ g(f(xy)) = g(f(x)f(y)) =g(f(x))g(f(y))\]
    $g(f(1)) = 1$ is trivial to see and so is $g(f(0)) = 0$
    }
    
    \item Let $f:R\rightarrow R'$ be an isomorphism between two commutative rings. Prove that its inverse $f^{-1}:R'\rightarrow R$ is a ring homomorphism, and so is also an isomorphism. (Recall that $f^{-1}$ is defined so that for any $b\in R'$, $f^{-1}(b)$ is the unique $a\in R$ such that $f(a) = b$.)
    \solu{
    Note that $f(f^{-1}(x) + f^{-1}(y)) = x+y \Longrightarrow f^{-1}(x+y) = f^{-1}(x) + f^{-1}(y)$ Proving that $f$ is multiplicative is similar.
    }
    \item Let $R$ be a commutative ring with characteristic $d$. Let $f:\Z\rightarrow R$ be the unique ring homomorphism. Prove that if $f(n) = 0$ for some integer $n$, then $d\mid n$. 
    \solu{
    We have $n \cdot 1_R = 0$. Let $n = dq + r$ where $0 \le  r \le d -1$. Then we get $r \cdot 1_R = 0$. This forces $r = 0$ so $d \mid n $
    }
    \item Let $R$ be a commutative ring with characteristic $d$ and let $R'$ be a commutative ring with characteristic $e$. Let $f:R\rightarrow R'$ be a ring homomorphism. Prove that $e\mid d$.
    \solu{
    We have $ 0=f(0)=f(d \cdot 1_R) = d \cdot 1_{R'}$. The rest is trivial by a Euclidean division argument as shown in $7.6.$
    }
    \item Prove that a subring of a field is an integral domain.
    \solu{
    No element of a field is a zero divisor as they are all units. 
    }
    \item Prove that $\R$ and $\C$ are not isomorphic.
    \solu{
    If the two are isomorphic, then there exists a homomorphism from $f: \mathbb C \rightarrow \mathbb R$
    \[f(i)^2 = f(i^2) = f(-1) = -1\] 
    an impossibility. 
    }
    \item Let $R = \Z^2 = \Z\times\Z$. Let $r = (0,1)$. Prove that: 
    \begin{enumerate}
        \item whenever $r\mid ab$ for some $a,b\in R$, we have $r\mid a$ or $r\mid b$;
        \item there exist $a,b\in R\backslash R^\times$ such that $r = ab$.
        \solu{
        $a =b = (0,-1)$
    }
    \end{enumerate}\label{exer:7.10}
    \item Let $R = \Q + x\R[x] = \{f(x)\in \R[x]\colon f(0)\in\Q\}$. Verify that $R$ is a subring of $\R[x]$. Prove that:
    \begin{enumerate}
        \item there exist $a,b\in R$ such that $x\mid ab$ but $x\nmid a$ and $x\nmid b$;
        \solu{
        
        }
        \item there do not exist $a,b\in R\backslash R^\times$ such that $x = ab$.
    \end{enumerate}\label{exer:7.11}
    \end{enumerate}

    \section{Quotients}

It is time to stop beating around the bush and talk about what $/$ means. Let $R$ ba a commutative ring. An \textbf{ideal} is a subset $I\subseteq R$ such that
\begin{enumerate}[(a)]
    \item for any $a,b\in I$, we have $a + b \in I$;
    \item for any $a\in I$ and any $r\in R$, we have $ra\in I$.
\end{enumerate}
Suppose $f:R\rightarrow R'$ is a ring homomorphism between two rings $R$ and $R'$. We define the \textbf{kernel} of $f$ to be $$\ker(f) = \{a\in R\colon f(a) = 0\}.$$
Then for any $a,b\in \ker(f)$, we have $a + b\in\ker(f)$ since
$$f(a+b) = f(a) + f(b) = 0 + 0 = 0$$
and for any $r\in R$, we have $ra\in\ker(f)$ since
$$f(ra) = f(r)f(a) = f(r)\cdot 0 = 0.$$
In other words, the kernel of a ring homomorphism is a \textbf{proper} ideal, that is an ideal not equal to $R$. The punchline is that conversely, every proper ideal arises as the kernel of some ring homomorphism from $R$.


\vspace{5pt}
\noindent\textbf{Examples}:
\begin{enumerate}
    \item Let $R$ be a commutative ring. Let $a\in R$ be any element. The set
    $$aR = (a) = \{ra\colon r\in R\}$$
    is the smallest ideal containing $a$. It is easy to check that $r_1a + r_2a = (r_1+r_2)a$ and $r(r_0a) = (rr_0)a$. For example, this gives the ideals $(d) = d\Z$ of $\Z$ for any integer $d$, and the ideals $(f(x))$ of $R[x]$ for any polynomial $f(x)\in R[x]$. When $a = 0$, we have the zero ideal $(0) = \{0\}$ and when $a = 1$, we have the full ring $(1) = R$. %We say $I$ is a \textbf{proper} ideal if $I\neq R$. 


    Ideals of the form $(a)$ are called \textbf{principal} ideals. Note that $b\in (a)$ if and only if $a\mid b$. Then $(a) = (b)$ if and only if $a\mid b$ and $b\mid a$. When $R$ is an integral domain, the latter is equivalent to $b = au$ for some unit $u\in R^\times$.
    \item If an ideal $I$ contains a unit $u\in R^\times$, then $I$ contains $uu^{-1} = 1$ and so $I = R$. If $R$ is a field, then any nonzero ideal contains a nonzero element, which we know is a unit. So then a field (e.g. $\Q,\R,\C,\F_2,\F_3,\F_4$) has only the zero ideal and the full ring as ideals.
    \item If $I_1$ and $I_2$ are ideals, then so are $I_1\cap I_2$ and $I_1 + I_2 = \{a + b\colon a\in I_1, b\in I_2\}$. An arbitrary intersection of ideals is also an ideal. Given any set $S$, we can define the ideal generated by $S$, denoted $(S)$, as the intersection of all the ideals containing $S$.

    Suppose $a,b\in\Z$. Then 
    \begin{eqnarray*}
        a\Z + b\Z &=& \{ax + by\colon x,y\in\Z\}\quad\! =\quad\! \gcd(a,b)\Z\\
        a\Z\cap b\Z &=& \{n\in\Z\colon a\mid n,b\mid n\}\quad\! =\quad \!\lcm(a,b)\Z.
    \end{eqnarray*}
    The set $\{ab\colon a\in I_1, b\in I_2\}$ is generally not an ideal since it may not be closed under addition. The ideal generated by it is denoted $I_1I_2 = \{a_1b_1 + \cdots + a_nb_n\colon a_i\in I_1, b_i\in I_2\}.$ Note each $a_ib_i\in I_1\cap I_2$. So $I_1I_2\subseteq I_1\cap I_2$. In $\Z$, we have $(a\Z)(b\Z) = (ab)\Z$.
\end{enumerate}
We now construct the quotient ring given a commutative ring $R$ and a proper ideal $I$. A \textbf{coset} of $I$ is a subset of $R$ of the form $$a + I = \{a + b\colon b\in I\} = \{c\in R\colon c - a\in I\}.$$ Such a coset is called the coset of $I$ containing $a$, since it literally contains $a$ as a set. We see that two cosets $a_1 + I$ and $a_2 + I$ are equal if and only if $a_1 - a_2 \in I$. Let $R/I$ be the set of all cosets of $I$. So 
$$R/I = \{a + I\colon a\in R\}.$$
The assumption that $I$ is a proper ideal instead of just an ideal ensures that $R/I$ contains at least $2$ elements. When $R = \Z$ and $I = m\Z$, a coset $a + m\Z$ is the set of integers congruent to $a$ mod $m$, i.e. is what we know to be a congruence class. The set $\Z/m\Z$ is then the set of all congruence classes mod $m$.



There is now an obvious way to define arithmetic on $R/I$:
$$(a + I) + (b + I) = (a+b) + I,\qquad (a + I)(b + I) = (ab) + I, \qquad -(a + I) = (-a)+ I$$
with $0+I$ as $0$ and $1+I$ as $1$. In other words, to add (resp. multiply, negate) two cosets, we simply pick any element from them and add (resp. multiply, negate) them in $R$, and then take the coset containing them. We need to check that this definition does not depend on the choice of the elements picked. Suppose $a+I = a'+I$ and $b+I = b'+I$. Then $a - a'\in I$ and $b - b'\in I$. Now
$$(a + b) - (a' + b') = (a - a') + (b - b') \in I,\qquad (-a') - (-a) = a - a'\in I,$$
and
$$ab - a'b' = ab - ab' + ab' - a'b' = a(b - b') + (a - a')b' \in I.$$
When $R = \Z$ and $I = m\Z$, these are just the usual laws on adding and multiplying numbers mod $m$.

There is natural surjective map $\pi:R\rightarrow R/I$ defined by $a\mapsto a+I$. It is a ring homomorphism by construction of $R/I$ and its kernel
$$\ker(\pi) = \{a\in R\colon a + I = I\} = \{a\in R\colon a\in I\} = I.$$
This proves that every proper ideal arises as the kernel of some ring homomorphism. In fact, every ring homomorphism is ``basically'' a quotient map. %Note that if $I = (0)$, then the map $R\rightarrow R/I$ is bijective since its kernel is trivial. So $R/(0)\cong R$.

\begin{theorem}
    (First isomorphism theorem) Let $f:R_1\rightarrow R_2$ be a homomorphism of rings. Then the image $\text{im}(f) = \{f(r)\colon r\in R_1\}$ is a subring of $R_2$ and the map $R_1/\ker(f)\rightarrow\text{im}(f)$ sending $r + \ker(f)$ to $f(r)$ is an isomorphism.
\end{theorem}

\begin{proof}
    Exercise. Just check definitions.
\end{proof}

\begin{cor}
    If $R$ has characteristic $m$, then $R$ has a subring isomorphic to $\Z/m\Z$. This subring is called the prime subring of $R$, or prime subfield if $m$ is prime. 
\end{cor}

\begin{proof}
    The unique homomorphism $\Z\rightarrow R$ has kernel $m\Z$ (by Section 7 Exercise 6). Hence, its image is a subring of $R$ isomorphic to $\Z/m\Z$.
\end{proof}


\vspace{5pt}
We may also view $R/I$ as the set of equivalence classes. Recall that a relation $\sim$ is an \textbf{equivalence relation} if:
\begin{enumerate}[(a)]
    \item (Reflexive) $a\sim a$;
    \item (Symmetric) $a\sim b\Rightarrow b\sim a$;
    \item (Transitive) $a\sim b \wedge b\sim c\Rightarrow a\sim c$
\end{enumerate}
An equivalence class containing $a$ is the set $[a] = \{b\in R\colon b\sim a\}.$ Two distinct equivalence classes are disjoint so that $R$ is a disjoint union of equivalence classes. We then define the set $R/\!\!\sim$ of equivalence classes as $\{[a]\colon a\in R\}.$ Now given an ideal $I$, we define $a\sim b$ by $b - a \in I$.

\begin{center}
    \add{Lecture 12 Mon 10/02}
\end{center}

We remark that the definition of cosets and $R/I$ only uses the addition of $R$ and the fact that $I$ is closed under addition. So if $J$ is a subset of $R$ that is closed under addition and subtraction, then we can still define the set $R/J$ of cosets of $J$ and we can still define $+$ on it. One example where this may be useful is when $J$ is the image of a ring homomorphism $f:R_1\rightarrow R_2$. The quotient $R_2/\text{im}(f)$ is called the \textbf{cokernel} of $f$, denoted $\text{coker}(f)$. It is not a ring.

\begin{theorem}
    (Chinese remainder theorem) Let $R$ be a commutative ring. Let $I$ and $J$ be two ideals of $R$ such that $I + J = R$. Then the natural map $$\varphi:r\mapsto (r+I, r+J) \colon R\rightarrow R/I \times R/J$$
    is a surjective homomorphism with kernel $IJ$. In other words,
    $$R/(IJ)\cong R/I\times R/J.$$
\end{theorem}

\noindent\textbf{Remark}: When $R = \Z$ and $I = m_1\Z$, $J = m_2\Z$, we saw before that $I + J = \gcd(m_1,m_2)\Z$ and $IJ = m_1m_2\Z$. So the condition that $I+J = R$ is the same as $\gcd(m_1,m_2) = 1$. The conclusion gives
$$\Z/m_1m_2\Z \cong \Z/m_1\Z \times \Z/m_2\Z.$$
An integer mod $m_1m_2$ is uniquely determined by what it is mod $m_1$ and mod $m_2$ and all combinations occur.

\vspace{5pt}
\begin{proof}
    The assumption $I + J = R$ means that there exist $a\in I$ and $b\in J$ such that $a + b = 1$. We prove $\varphi$ is surjective. Take any $s,t\in R$. We need to find an $r\in R$ such that $r - s\in I$ and $r - t\in J$. Let $r = ta + sb$. Then 
    \begin{eqnarray*}
        r - s &=& ta + s(b - 1) = ta - sa\in I,\\
        r - t &=& t(a - 1) + sb = -tb + sb \in J.
    \end{eqnarray*}
    The kernel of $\varphi$ is clearly $I\cap J$. We already know that $IJ\subseteq I\cap J$, so it remains to prove $I\cap J \subseteq IJ$. Let $r\in I\cap J$. Then $r = r(a + b) = ra + rb \in IJ$. 
\end{proof}

We consider the application to modular arithmetic. Suppose $m\geq2$ with prime factorization $$m = p_1^{k_1}\cdots p_r^{k_r}.$$
Then
\begin{eqnarray*}
    \Z/m\Z &\cong& \Z/p_1^{k_1}\Z\times\cdots\times\Z/p_r^{k_r}\Z\\
    \Big(\Z/m\Z\Big)^\times &\cong& \Big(\Z/p_1^{k_1}\Z\Big)^\times\times\cdots\times\Big(\Z/p_r^{k_r}\Z\Big)^\times
\end{eqnarray*}


\begin{lemma}
    Let $m\geq2$. Then $(\Z/m\Z)^\times = \{a + m\Z\colon \gcd(a,m) = 1\}$. Its size is $\phi(m)$.
\end{lemma}

\begin{proof}
    The coset $a + m\Z$ is a unit if and only if there exists $b + m\Z$ such that $(a+m\Z)(b+m\Z) = 1+m\Z$. In other words, $ab\equiv 1\pmod{m}$. This is the same requiring $ax + my = 1$ to have an integer solution, which is the same as $\gcd(a,m) = 1$.
\end{proof}

\begin{cor}
    Let $m\geq2$. Then $\Z/m\Z$ is a field if and only if $m = p$ is a prime. We write $\F_p$ for $\Z/p\Z$.
\end{cor}

\begin{cor}
    Let $m\in\N$. Then $$\displaystyle\phi(m) = \prod_{i=1}^r\left(p_i^{k_i}-p_i^{k_i-1}\right)=m\prod_{p\mid m}\left(1-\frac{1}{p}\right).$$
\end{cor}

\begin{proof}
    We have $\phi(m) = \prod_{i=1}^r \phi(p_i^{k_i}).$ It is easy to see that for any prime $p$ and positive integer $k$, $\phi(p^k) = p^k - p^{k-1}$ since there are $p^{k-1}$ numbers in $1,2,\ldots,p^k$ that are divisible by $p$.
\end{proof}

\begin{theorem}
    Let $R$ be a finite commutative ring. Then for any $a\in R$, we have $|R|\cdot a = 0$. For any $a\in R^\times$, we have $a^{|R^\times|} = 1.$
\end{theorem}

\begin{proof}
    We prove the statement for $R^\times$. The statement for $R$ follows by a similar argument. We note that if $b\in R^\times$, then so it $ab$ since $ab(b^{-1}a^{-1}) = 1$. Hence the map $x\mapsto xa$ defines a permutation on $R^\times$. Let $a_1,\ldots,a_n$ denote all the elements of $R^\times$. Then $aa_1,\ldots,aa_n$ also are all the elements of $R^\times$. Multiplying them together gives
    $$a_1\cdots a_n = (aa_1)\cdots(aa_n) = a^{|R^\times|}(a_1\cdots a_n).$$
    Multiplying both sides by $a_n^{-1}\cdots a_1^{-1}$ gives $a^{|R^\times|} = 1.$
\end{proof}

\begin{cor}
    (Euler's Theorem, Fermat's little Theorem) Let $m\in\N$. Let $a$ be an integer coprime to $m$. Then $a^{\phi(m)}\equiv 1\pmod{m}$. If $m = p$ is a prime and $p\nmid a$, then $a^{p-1}\equiv 1\pmod{p}$.
\end{cor}

We write $o_+(a)$, the additive order of $a$ in $R$, for the smallest positive integer $d$ such that $da = 0$. Then by a standard division algorithm argument (see for example the proof of Proposition \ref{prop:lag}, we have $o_+(a)\mid |R|$. We write $o(a)$, the order of $a$ in $R^\times$, for the smallest positive integer $d$ such that $a^d = 1$ if $a\in R^\times$. Then $o(a)\mid |R^\times|$.


\vspace{3pt}
\noindent\textbf{Example}: Let's find the last 2 digits of $3^{3^{3^3}} = 3^{3^{27}}$. This is the same finding what it is mod $100$, which is the same as finding what it is mod $25$ and mod $4$.

\begin{lemma}
    Suppose $n\in\N$ and $n\equiv 7\pmod{20}$. Then $3^n\equiv 87\pmod{100}$.
\end{lemma}

\begin{proof}
    Since $n$ is odd, we see that $3^n\equiv (-1)^n \equiv -1\pmod{4}$. Since $\phi(25) = 20$, we see that $3^{20}\equiv 1\pmod{25}$. Then for any positive integer of the form $20k+7$, we have
    $$3^{20k+7} = (3^{20})^k3^7\equiv 3^7 \equiv 27 \times 27 \times 3 \equiv 12\pmod{25}.$$
    Since $87$ is 1 mod 4 and 12 mod 25, we have $3^n\equiv 87\pmod{100}$.
\end{proof}

Now $3^n\equiv 87\pmod{100}$ implies $3^n\equiv 7\pmod{20}$ and so $3^{3^n}\equiv 87\pmod{100}$ and we may repeat this forever. In other words, $3^{3^3}, 3^{3^{3^3}}, 3^{3^{3^{3^3}}},\ldots$ all end in $87$.

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item (Correspondence Theorem) Let $R$ be a commutative ring and let $I$ be an ideal of $R$. Prove that the ideals of $R/I$ are of the form $$J/I := \{a + I\colon a\in J\}$$
    for some ideal $J$ of $R$ containing $I$. 
    
    \item (Second Isomorphism Theorem) Let $R$ be a commutative ring and let $I$ be an ideal of $R$. Let $S$ be a subring of $R$. Prove that:
    \begin{enumerate}
        \item $S+I = \{s + a\colon s\in S, a\in I\}$ is a subring of $R$;
        \item $S\cap I$ is an ideal of $S$;
        \item $(S+I)/I\cong S/(S\cap I).$
    \end{enumerate}
    \solu{Consider $\phi:S\to (S+I)/I$ by $s\mapsto s+I$.}
    \item (Third Isomorphism Theorem) Let $R$ be a commutative ring and let $I$ be an ideal of $R$. Let $J$ be an ideal of $R$ containing $I$. Prove that $$(R/I)/(J/I) \cong R/J.$$
    \solu{Consider $\phi:R/I\to R/J$ by $r+I\mapsto r+J$.}
    \item Let $R$ be a commutative ring and let $I$ be an ideal of $R$. Let $$I[x] = \{a_nx^n + \cdots + a_0 \in R[x]\colon a_i\in I\}.$$
    Prove that $R[x]/I[x] \cong (R/I)[x].$
    \solu{Consider $\phi:R[x]\to (R/I)[x]$ by $\sum r_ix^i\mapsto \sum (r_i+I)x^i$.}
    \item Prove that the ideals of $\Z$ are all of the form $d\Z$ for some non-negative integer $d$. What are the subrings of $\Z$? For a general commutative ring $R$, which ideal can also be a subring?
    \item Let $R$ be the ring of continuous (real-valued) functions on $[0,3]$ with pointwise addition and multiplication, and the constant functions $0$ and $1$ as $0$ and $1$. Consider
    $$a(x) = \begin{cases}
        1-x&\mbox{if }0\leq x\leq 1\\
        0&\mbox{if }1\leq x\leq 2\\
        x-2&\mbox{if }2\leq x\leq 3
    \end{cases},\qquad b(x) = \begin{cases}
        1-x&\mbox{if }0\leq x\leq 1\\
        0&\mbox{if }1\leq x\leq 2\\
        2-x&\mbox{if }2\leq x\leq 3
    \end{cases}.$$
    Prove that $a(x)R = b(x)R$ but there does not exist a unit $u(x)\in R^\times$ such that $b(x) = a(x)u(x)$.

    \item Let $R$ be a commutative ring and let $a\in R^\times$ with $o(a)$ finite. Prove that for any $k\in\N$, we have $$o(a^k) = \frac{o(a)}{\gcd(o(a),k)}.$$\label{exer:8.7}
    
    \item Let $n = 2\cdot 11\cdot 43$. Prove that $n\mid 2^n+2$.

    It is a lot trickier to prove that if $n$ is odd, then it is impossible for $n\mid 2^n + 2$.
    
    \item Let $c,m$ be any positive integers. Prove that the sequence $a_1 = c$, $a_{n+1} = c^{a_n}$ is eventually constant mod $m$.

    \solu{It is sufficient to prove for $m=p^k$.\\
    If $p|c$, trivial. If not, then $a_{n+1}\equiv c^r\pmod{m}$, where $r\equiv a_n\pmod{\phi(m)}$. Use induction.}
\end{enumerate}

\begin{center}
    \add{Lecture 13 Wed 10/04}
\end{center}
\section{Polynomials over a field}

In this section, we focus on the polynomial ring $F[x]$ where $F$ is a field. We saw before that the units of $F[x]$ are the nonzero constants $F^\times$. Recall that the degree of a polynomial $a_nx^n + \cdots + a_0$ is the largest index $n$ such that $a_n\neq 0$. We follow the convention of $\deg(0) = -\infty$.

\begin{proposition}
    (Division algorithm for polynomials) Let $R$ be an integral domain. Let $f(x)\in R[x]$ and let $g(x)\in R[x]$ such that the leading coefficient of $g$ is a unit in $R$. Then there exist polynomials $q(x),r(x)\in R[x]$ such that $$f(x) = g(x)q(x) + r(x),\qquad\mbox{and}\qquad \deg(r) < \deg(g).$$
\end{proposition}

\begin{proof}
    Standard induction on the degree of $f(x)$. Let $a$ denote the leading coefficient of $g(x)$. So $a\in R^\times$. If $g(x) = a$ has degree $0$, then we take $q(x) = a^{-1}f(x)$ and $r(x) = 0$. Suppose now $\deg(g) > 0.$ We prove by induction on $\deg(f)$. If $\deg(f) < \deg(g)$, we simply take $q = 0$ and $r = f$. Suppose now $\deg(f) \geq \deg(g)$. Let $b\in R$ be the leading coefficient of $f(x)$. Then $$f(x) - ba^{-1}x^{\deg(f) - \deg(g)}g(x)$$
    is a polynomial with less degree than $f$. Apply induction.
\end{proof}

When $R = \Z$, the condition that the leading coefficient of $g$ is unit means that it is $\pm1$. When $R = F$ is a field, we just need $g$ to be nonzero. In the language of HW 4 Problem 4, $F[x]$ is a Euclidean domain. All ideals are generated by one element. An integral domain where every ideal is generated by one element is called a \textbf{Principal ideal domain} or PID. In a PID $R$, the ideal $(a,b)$ generated by two elements $a,b$ is of the form $(c)$. Since $R$ is an integral domain, we know that $(c) = (c')$ if and only if $c' = uc$ for some unit $u\in R^\times$. One can choose a generator of the ideal $(c)$ (sometimes the ideal itself) as the gcd of $a$ and $b$. When $R = \Z$, we can choose the generator to be positive. When $R = F[x]$, we can choose the generator to be monic.


A polynomial $f(x)\in F[x]$ is \textbf{irreducible} if $\deg(f)\geq1$ and there do not exist polynomials $a(x),b(x)\in F[x]$ of degree at least $1$ such that $a(x)b(x) = f(x)$. The analogue of Euclid's lemma and the fundamental theorem of arithmetic are left as HW 5 Problem 1.
\begin{proposition}
    Let $F$ be a field.
    \begin{enumerate}[(a)]
        \item Suppose $f(x)\in F[x]$ is irreducible. If $f(x)\mid a(x)b(x)$ in $F[x]$, then $f(x)\mid a(x)$ or $f(x)\mid b(x)$.
        \item Every non-constant polynomial in $F[x]$ can be factored into a product of irreducible polynomials in $F[x]$.
    \end{enumerate}
\end{proposition}

\noindent\textbf{Remark}: In general, for a commutative ring $R$, we say a nonzero element $r\in R$ is \textit{irreducible} if it is not a unit and there do not exist $a,b\in R\backslash R^\times$ such that $r = ab$. We say a nonzero element $r\in R$ is \textit{prime} if whenever $r\mid ab$ for some $a,b\in R$, we have $r\mid a$ or $r\mid b$. In an integral domain, prime implies irreducible. As Exercise 7.\ref{exer:7.10} shows, this is not true if $R$ is not an integral domain. Conversely, as Exercise 7.\ref{exer:7.11} shows, there are also integral domains where irreducible does not imply prime. 

\vspace{5pt}

For any ring $R$ and any $\alpha\in R$, there is an evaluation homomorphism $\text{ev}_\alpha:R[x]\rightarrow R$ sending $$a_nx^n + a_{n-1}x^{n-1} + \cdots + a_0\,\,\, \mapsto \,\,\,a_n\alpha^n + a_{n-1}\alpha^{n-1} + \cdots + a_0.$$
We write $f(\alpha)\in R$ for the image of $f$ under this map.

\begin{proposition}\label{prop:rem}
    Let $R$ be an integral domain. Let $f(x)\in R[x]$ and let $c\in R$. The remainder when $f(x)$ is divided by $x - c$ is the constant polynomial $f(c)$.
\end{proposition}

\begin{proof}
    The remainder $r(x)$ satisfies $\deg(r) < \deg(x - c) = 1$. So $r(x) = r_0$ is a constant. Apply $\text{ev}_c$ to $f(x) = (x - c)q(x) + r_0$ to get $r_0 = f(c)$.
\end{proof}

\begin{cor}
    Let $R$ be an integral domain. Let $f(x)\in R[x]$ and let $c_1,\ldots,c_n\in R$ be distinct. Then $c_1,\ldots,c_n$ all are roots of $f(x)$ if and only if $(x - c_1)(x - c_2)\cdots(x - c_n) \mid f(x)$.
\end{cor}

\begin{proof}
    Only the forwards direction needs to be proved. We prove by induction on $n$. The case $n = 1$ follows immediately from Proposition \ref{prop:rem}. Suppose now $n\geq 2$. By induction using $c_1,\ldots,c_{n-1}$, we see that there exists $g(x)\in R[x]$ such that $f(x) = (x - c_1)\cdots(x - c_{n-1})g(x)$. Apply $\text{ev}_{c_n}$ to get $$0 = (c_n-c_1)\cdots(c_n-c_{n-1})g(c_n).$$
    Since each $c_n - c_i\neq 0$ and $R$ is an integral domain, we see that $g(c_n) = 0$. Then $g(x) = (x - c_n)h(x)$ for some $h\in R[x]$. So $f(x) = (x - c_1)\cdots(x - c_n)h(x)$.
\end{proof}

\begin{cor}
    Let $R$ be an integral domain. Let $f(x)\in R[x]$ with degree $d\geq0$. Then $f(x)$ has at most $d$ distinct roots in $R$.
\end{cor}

\begin{cor}
    Let $F$ be a field. Linear (degree $1$) polynomials in $F[x]$ are all irreducible. Quadratic (degree 2) and cubic (degree 3) polynomials in $F[x]$ are irreducible if and only if they don't have a root in $F$.
\end{cor}

\begin{proof}
    Any factorization of a polynomial of degree at most $3$ into polynomials of smaller degrees must involve a linear polynomial, which will produce a root of $f$ in $F$.
\end{proof}

We say $c\in R$ is a repeated root of $f(x)$ if $(x-c)^2\mid f(x) $. Repeated roots can be checked using the formal \textbf{derivative} of $f(x)$ defined as
$$f'(x) = na_nx^{n-1} + \cdots + 2a_2x + a_1.$$ The word ``formal'' is referring to the fact that this has nothing to do with taking limits.
The same rules of derivatives in calculus apply here:
$$(f+g)'(x) = f'(x) + g'(x),\qquad (fg)'(x) = f(x)g'(x) + f'(x)g(x),\qquad (f\circ g)'(x) = f'(g(x))g'(x).$$
Additivity is easy to check from the definition. Then one can use it to reduce the product rule and the chain rule to the case $f(x) = a_nx^n$.

\begin{proposition}
    Let $R$ be an integral domain. Let $f(x)\in R[x]$ and let $c\in R$. Then $c$ is a repeated root of $f(x)$ if and only if $f(c) = f'(c) = 0$.
\end{proposition}

\begin{proof}
    For both directions, we may assume $c$ is a root. So $f(x) = (x - c)g(x)$ for some $g(x)\in R[x]$. Differentiate it to get $f'(x) = g(x) + (x - c)g'(x)$. Hence $f'(c) = g(c)$. So $g(x)$ has another factor of $x - c$ if and only if $f'(c) = 0$.
\end{proof}

The moral of the story is that $F[x]$ and $\Z$ are very similar, except we have an extra operation of differentiation for $F[x]$. This differentiation allows one to prove versions of the abc conjecture (Mason's Theorem) and Fermat's last theorem over $F[x]$. One can test for existence of repeated roots by applying the Euclidean algorithm to find the gcd of $f(x)$ and $f'(x)$. However, testing for squarefree integers is as difficult as factorization.

The process of turning $\Z$ into $\Q$ is the process of taking the field of fraction. We have
$$\Q = \{\frac{a}{b}\colon a,b\in\Z, b\neq 0\}.$$
We can do the same thing with $F[x]$ (in fact with any integral domains) to define the field $F(x)$ of rational functions:
$$F(x) = \left\{\frac{a(x)}{b(x)}\colon a(x),b(x)\in F[x], b(x)\neq 0\right\}.$$
Arithmetic works just as you expect with fractions. For example
$$\frac{a(x)}{b(x)} + \frac{c(x)}{d(x)} = \frac{a(x)d(x) + b(x)c(x)}{b(x)d(x)}.$$

\noindent\textbf{Remark:} To be more precise, we need the notion of \textit{localizations}. Let $R$ be a commutative ring. Let $S$ be a multiplicatively closed subset of $R$ that does not contain $0$. In other words, $1\in S$ and $ab\in S$ for any $a,b\in S$. We denote an element $(r,s)$ of $R\times S$ suggestively as $\frac{r}{s}$, and define a relation $\sim$ on $R\times S$ by 
$$\frac{r_1}{s_1}\sim\frac{r_2}{s_2} \,\,\Longleftrightarrow\,\, \exists s_3\in S,\, s_3(r_1s_2 - r_2s_1) = 0.$$
When $R$ is an integral domain, this is equivalent to simply $r_1s_2 = r_2s_1$. It is easy to check that $\sim$ defines an equivalence relation on $R\times S$. We define the localization $S^{-1}R$ as the set $(R\times S)/\sim$ of equivalence classes. In other words, one may think of elements of $S^{-1}R$ as fractions $r/s$ where $r\in R$ and $s\in S$, keeping in mind that multiple fractions could correspond to the same elements. We can then define the ring operations on $S^{-1}R$ by
$$\frac{r_1}{s_1} + \frac{r_2}{s_2} = \frac{r_1s_2 + r_2s_1}{s_1s_2},\qquad \frac{r_1}{s_1} \cdot \frac{r_2}{s_2} = \frac{r_1r_2}{s_1s_2},\qquad 0 = \frac{0}{1},\qquad 1 = \frac{1}{1}.$$
It is easy to check that the above addition and multiplication do not depend on the choice of representatives. In other words, 
$$\mbox{if }\frac{r_1}{s_1}\sim\frac{r_1'}{s_1'}\mbox{ and }\frac{r_2}{s_2}\sim\frac{r_2'}{s_2'},\mbox{ then }\frac{r_1s_2 + r_2s_1}{s_1s_2}\sim\frac{r_1's_2' + r_2's_1'}{s_1's_2'}\mbox{ and }\frac{r_1r_2}{s_1s_2}\sim\frac{r_1'r_2'}{s_1's_2'}.$$
There is a ring homomorphism $R\rightarrow S^{-1}R$ sending $r$ to $r/1$. Note that elements of the form $s/1$ where $s\in S$ are units in $S^{-1}R$ since $1/s\in S^{-1}R$. In this sense, one can think of the localization $S^{-1}R$ is an ``extension'' of $R$ where we add inverses of elements of $S$, hence the notation. Since elements in $S$ become units, the proper ideals of $S^{-1}R$ correspond to ideals of $R$ disjoint from $S$, i.e. contained in $R\backslash S$, hence the name ``localization''.

When $R$ is an integral domain, the set $R\backslash\{0\}$ of nonzero elements of $R$ is multiplicatively closed. In the localization $(R\backslash\{0\})^{-1}R$, we are adding inverses to every nonzero element of $R$. In this case, $(R\backslash\{0\})^{-1}R$ is a field, and is the proper definition for the \textit{field of fraction} of an integral domain.

\begin{center}
    \add{Lecture 14 Fri 10/06}
\end{center}

We consider the quotient $F[x]/(g(x))$ for some fixed $g(x)\in F[x]$ of degree $d\geq 1$. By the division algorithm, any $f(x)\in F[x]$ is of the form $g(x)q(x) + r(x)$ where $\deg(r) < d$. So $$f(x) + (g(x)) = r(x) + (g(x)).$$
Moreover, by considering degrees, we see that no two of such $r(x) + (g(x))$ are equal. Hence
$$F[x]/(g(x)) = \{r(x) + (g(x)) \colon  \deg(r) \leq d-1\}.$$

\begin{proposition}\label{prop:F/g}
    Let $F$ be a field and let $g(x)\in F[x]$ with degree at least $1$. Then the following are equivalent:
    \begin{enumerate}[(a)]
        \item $F[x]/(g(x))$ is a field;
        \item $F[x]/(g(x))$ is an integral domain;
        \item $g(x)$ is irreducible.
    \end{enumerate} 
\end{proposition}

\begin{proof}
    Suppose first that $g(x)$ is not irreducible. Then it factors as $a(x)b(x)$ for some $a(x),b(x)\in F[x]$ with degrees between $1$ and $\deg(g) - 1$. Then $a(x) + (g(x))$ and $b(x) + (g(x))$ are nonzero in $F[x]/(g(x))$ but their product is $g(x) + (g(x))$ which is zero. Hence $F[x]/(g(x))$ is not an integral domain. This proves $(b)\Rightarrow(c).$ 
    
    Suppose now $g(x)$ is irreducible. Let $f(x)+(g(x))\in F[x]/(g(x))$ be any nonzero element. The ideal $I = (f(x),g(x))$ is of the form $h(x)$ for some $h(x)\in F[x]$. We prove that $I = F[x]$. From $g(x)\in (h(x))$, we have $g(x) = h(x)j(x)$ for some $j(x)\in F[x]$. Since $g(x)$ is irreducible, we have either $h(x)$ or $j(x)$ is a nonzero constant. If $j(x)$ is a nonzero constant $j_0$, then it is a unit in $F[x]$ and so $(h(x)) = (g(x))$ contradicting $f\notin (g)$. So $h(x)$ is a nonzero constant, implying that $(f(x),g(x)) = F[x]$. Hence there exist $a(x),b(x)\in F[x]$ such that $a(x)f(x) + b(x)g(x) = 1$. In other words, $a(x)f(x) + (g(x)) = 1 + (g(x)).$ Hence $F[x]/(g(x))$ is a field. This proves $(c)\Rightarrow(a)$. Finally $(a)\Rightarrow(b)$ is trivial.
\end{proof}

We consider $F = \F_2 = \{0,1\}$. There are $4$ degree $2$ polynomials: $x^2$, $x^2 + 1$, $x^2 + x$ and $x^2 + x + 1$. The first three are reducible, note that $x^2 + 1 = (x + 1)^2$, and the last one is irreducible. The ring $\F_2[x]/(g(x))$ has size $4$ and characteristic $2$. It is easy to check that
$$f(x) + (x^2)\mapsto f(x+1) + ((x+1)^2)$$ defines an isomorphism $\F_2[x]/(x^2) \cong \F_2[x]/((x+1)^2).$ Note also that $x^2 + x = x(x+1)$ with $(x, x+1) = (1)$. Hence by the Chinese Remainder Theorem, $$\F_2[x]/(x^2 + x) \cong \F_2[x]/(x) \times \F_2[x]/(x+1) \cong \F_2\times\F_2.$$ This leaves $\F_2[x]/(x^2 + x + 1)$ as the field $\F_4$. In degree $3$, there are two irreducible polynomials $x^3 + x + 1$ and $x^3 + x^2 + 1$. Are the two fields $\F_2[x]/(x^3 + x + 1)$ and $\F_2[x]/(x^3 + x^2 + 1)$ of size 8 isomorphic?

\begin{cor}
    Let $p$ be a prime. Let $g(x)\in\F_p[x]$ be an irreducible polynomial of degree $d$. Then $\F_p[x]/(g(x))$ is field of $p^d$ elements.
\end{cor}

In HW5, you will prove that any finite commutative ring has a decomposition of the form $$R\cong R_1\times R_2\times\cdots R_r$$ 
where $|R_i| = p_i^{d_i}$ and $p_1,\ldots,p_r$ are distinct primes. It follows then that any finite field $F$ (i.e. integral domain) has size $p^d$ for some prime $p$. We saw before that the characteristic of an integral domain is a prime, and in HW4 that the characteristic divides the size of the ring. Hence the prime $p$ is necessarily the characteristic of $F$. Hence the prime subfield of $F$ is $\Z/p\Z = \F_p$.

\subsection*{Exercise}
\begin{enumerate}[\thesection .1]
    \item Prove that the ideal $(2,x)$ in $\Z[x]$ is not principal.
    \solu{
     Suppose that $(2,x) = (h(x))$. Then we have $h(x) \in \{\pm 1, \pm 2 \}$. Note that $h(x) \neq 2$ because $x \in (2,x)$ but $x \not\in (h(x))$. Furthermore, $h(x) = \pm 1 \Longrightarrow (h(x)) = \mathbb Z$, impossible since $x \not\in (2,x)$
    }
    \item What are the irreducible polynomials in $\C[x]$? What are the irreducible polynomials in $\R[x]$?
    \solu{
    A polynomial is irreducible in $\mathbb{C}[x]$ if and only if degree of polynomial is $1.$ Proof is trivial by fundamental theorem of algebra. A polynomial is irreducible in $\R[x]$ if it has no real roots. This implies that it must have even degree (converse obviously is not true). 
    }
    \item Let $R$ be a commutative ring and let $I$ be a proper ideal of $R$. We say $I$ is a \textbf{maximal ideal} of $R$ if there does not exist a proper ideal $J$ such that $I$ is a proper subset of $J$. Prove that $I$ is maximal if and only if $R/I$ is a field. 
    \solu{ 
    Suppose that $I$ is maximal. Take a nonzero element $a \in R/I$ and by the definition of a maximal ideal, $(a, I) = \{ax + i: a \in R, i \in I\} = R$. This implies that there exists $x_0 \in R$ and $i_0 \in I$ such that $ax_0+ i_0 = 1$. In $R/I$ this means $ax_0  = 1$. Therefore, $R/I$ is a field. Converse is trivial if you just reverse the steps. 
    }\\
    Unpickled: \solu{Suppose that $I$ is a maximal ideal, take $a+I\in R\setminus I$ to be a non-zero element of $R\setminus I$. The set $J=\{ax+i:x\in R,i\in I\}$ is an ideal of $R$: $$\forall y\in R(j\in J\implies j=ax+i\land i\in I\land x\in R\implies iy\in I\land xy\in R\implies (ax+i)y=a(xy)+iy\in J)$$
    Note that $2a\in J$ but $2a\not\in I$, because if $2a\in I$ then $a\in I$ and $a+I=0+I$ is the zero element of $R/ I$, contradicting our assumption that $a+I$ is non-zero. $0+I$ is the zero element since $(0+I)+(b+I)=b+I$ for any $b+I\in R/ I$. Hence $I\subsetneq J$ and $I$ is a maximal ideal, then $J$ must not be a proper ideal of $R$, that is, $R=J$. Therefore $1\in\{ax+i:x\in R,i\in I\}$ so there exist $x_0,i_0$ such that $ax_0+i_0=1$. This gives us $(a+I)(x_0+I)=ax_0+I=1+I$. Clearly $1+I$ is the identity in $R/ I$ as $(1+I)(a+I)=(a+I)$. Therefore the above proves that $R/ I$ is a field. 
    
    Conversely, if $R/ I$ is a field. We pick any ideal $J$ of $R$ such that $I\subsetneq J\subseteq R$, we will show that $J=R$. Pick any element $j\in J, j\not\in I$. Since $j+I\neq 0+I$, that is, $j+I$ is not the zero element of $0+I$, then there exist $k+I$ such that $(j+I)(k+I)=1+I$. This implies that $1-jk\in I\subsetneq J$. As well we have that $(j+J)(k+J)=(0+J)(k+J)=0+J$ so $jk\in J$. Hence, by the definition of ideal, $1=(1-jk)+jk\in J$. So $R=(1)\subseteq J$ and it must be the case that $J=R$. As a result, we have proven that any ideal containing $I$ must not be a proper ideal, proving that $I$ is maximal.}

    There is also a notion of a \textbf{prime ideal}. Can you guess what its definition is and how it relates to $R/I$?
    \solu{
    The definition is well-known. An ideal $I$ is prime if $ab \in I \Longrightarrow a \in I$ or $b \in I.$
    }\\
    Unpickled: \solu{
        An ideal $I$ is prime if for any $a,b\in R$, $ab\in I\implies a\in I\lor b\in I$. We can show that $R/I$ is an integral domain if and only if $I$ is a prime ideal. The proof is as follows:

        Suppose that $I$ is a prime ideal, for any $(a+I)(b+I)=(0+I)$ we have that $ab-0=ab\in I$. Since $I$ is prime, we have that $a\in I\lor b\in I$. This implies that $a+I=0+I\lor b+I=0+I$. Since $0+I$ is the zero element, this proves that $R/I$ is an integral domain. 

        Conversely, suppose that $R/I$ is an integral domain. To show that $I$ is a prime ideal, we will show that for any $a,b\in R$ such that $ab=0$, we have $a\in I$ or $b\in I$. Note that in this case, $(a+I)(b+I)=(ab+I)=(0+I)$, which, by the definition of integral domain, implies that $a+I=0+I\lor b+I=0+I$. This shows that either $a-0=a\in I\lor b-0=b\in I$, proving that $I$ is a prime ideal.
        
    }
    \item Give an example of a commutative ring $R$, a maximal ideal $I$, and a subring $S$ such that $S\cap I$ is not maximal in $S$.\label{exer:9.4}
    \solu{
    Take $R = \Q$, $I = \{0\}$, and $S = \Z$. We get $S \cap I = \{ 0 \}$. Done. 
    }
    \item What are all the maximal ideals of $\Z[x]$?
    \solu{
    Let $S$ be the maximal ideal of $Z[x]$. Since $S$ is also a prime ideal, $S \cap \mathbb Z$ is a prime ideal of $\mathbb Z$. This is because if $a,b \in S$ and $ab \in S \cap \Z$, $a,b \in \Z$ because $\Z$ is prime. So we have $S \cap \Z = (0)$ or $S \cap \Z =  (p)$. 
    }

    \item For any commutative ring $R$, we write $R[x,y]$ for the ring $(R[x])[y]$. Prove that the maximal ideals of $\C[x,y]$ are of the form $(x-a, y-b)$ for some $a,b\in\C$. (Hint: recall the similarity between $\C[x]$ and $\Z$, and mimic your solution for Exercise 4.)

    It is in fact true that the maximal ideals of $\C[x_1,\ldots,x_n]$ are of the form $(x_1-a_1,\ldots,x_n-a_n)$ for some $a_1,\ldots,a_n\in\C$. This result is known as Hilbert's Nullstellensatz (theorem of zeros in German). The rings $\C[x_1,\ldots,x_{n-1}]$ for $n\geq 3$ are no longer PID so your solutions for Exercise 5 and 6 above likely will not generalize.
    
    \item Find all irreducible polynomials of degree $4$ in $\F_2[x]$.
    %\item Let $f(x)\in\F_2[x]$ be any polynomial. Prove that $x^2 + x + 1 \mid f(x^2) + f(x) + f(1)$.
    \solu{
    $x^4 + x^3 + x^2 + x+1, x^4 + x^3 +1, x^4 + x+1$
    }
    \item Let $p$ be a prime. Prove that $x^2 + x + 1\in \F_p[x]$ is irreducible if and only if $p\not\equiv1\pmod{3}$.\label{exer:9.8}
    \solu{
    Solution 1: 
    $x^2+x+1$ is degree two so it is irreducible iff there is a root. Suppose that $a^2 + a+ 1 \equiv 0 \pmod{p} \Longrightarrow (2a+1)^2 \equiv -3 \pmod{p}$. By Law of Quadratic Reciprocity, we have \[ 1 = \left( \frac{-3}{p} \right) =  (-1)^{\frac{p-1}{2}}\left(\frac{3}{p}\right) = \left(\frac{p}{3}\right) (-1)^{\frac{p-1}{2}} (-1)^{\frac{3-1}{2}} (-1)^{\frac{p-1}{2}} \iff \left(\frac{p}{3}\right) = -1 \]
    Therefore $p \not\equiv 1 \pmod{3}$. All steps are reversible. 
    }
    \solu{
    Solution 2: $p \neq 3$ so $x \neq 1$ and we get $x^3 \equiv 1 \pmod{p}$. So we must have $3 \mid p-1$ by order. Done.    
    }
\end{enumerate}

\section{Finite fields}

The main theorem in the theory of finite fields is:
\begin{theorem}
    For every prime $p$ and every positive integer $d$, there is a unique field of size $p^d$ up to isomorphism, given by $$\F_{p^d}\cong\F_p[x]/(g(x))$$
    where $g(x)\in\F_p[x]$ is irreducible of degree $d$.
\end{theorem}

The key theorem is the existence of a primitive element.

\begin{theorem}
    Let $F$ be a finite field of size $p^n$ for some prime $p$ and some positve integer $n$. Then there exists $a\in F^\times$ such that $o(a) = p^n - 1$.
\end{theorem}
Such an element $a$ is called a \textbf{primitive} element of $F$ as every nonzero element is a power of $a$:
$$F^\times = \{a,a^2,\ldots,a^{p^n - 1}\}.$$

\begin{proof}
    Write $m = p^n - 1$. For any positive divisor $d$ of $m$, let $N_d$ denote the number of elements in $F$ with order exactly $d$. We prove that $N_d\leq\phi(d)$. If $N_d = 0$, then this is obviously true. Suppose $N_d > 0$ and let $\alpha$ be an element of order $d$. Any element of order $d$ is a root of the degree $d$ polynomial $x^d - 1\in F[x]$ and $\alpha,\alpha^2,\ldots,\alpha^{d}$ already give $d$ of them, which are all distinct since $d = o(\alpha)$. In other words, any element of order $d$ must be one of these $d$ powers of $\alpha$. Recall from Exercise 8.\ref{exer:8.7} that for any integer $k$, $$o(\alpha^k) = \frac{o(\alpha)}{\gcd(k, o(\alpha))}.$$ Hence we see that $o(\alpha^k) = d$ if and only if $\gcd(k, o(\alpha)) = 1$. Therefore, $N_d = \phi(d)$. 

    Since every element in $F^\times$ has order dividing $m$, we have
    $$m = \sum_{d\mid m}N_d \leq \sum_{d\mid m}\phi(d) = m,$$
    by Corollary \ref{cor:sumphi}. Therefore, $N_d = \phi(d)$ for every $d\mid m$. In particular, $N_m = \phi(m) > 0$.
\end{proof}


\begin{cor}
    Let $F$ be a finite field of size $p^n$ for some prime $p$ and some positive integer $n$. Then $F\cong \F_p[x]/(f(x))$ for some irreducible polynomial $f(x)\in\F_p[x]$ of degree $n$.
\end{cor}

\begin{proof}
    Let $a\in F^\times$ be an element of order $p^n - 1$. Then every element of $F^\times$ is a power of $a$. Hence the evaluation map $\text{ev}_a:\F_p[x] \rightarrow F$ is a surjective homomorphism. The kernel of $\text{ev}_a$ is an ideal of $\F_p[x]$ and so is of the form $(f(x))$ for some $f(x)\in\F_p[x]$. By the first isomorphism theorem, $F$ is isomorphic to $\F_p[x]/(f(x))$. In order for this quotient to be a field, $f(x)$ must be irreducible by Proposition \ref{prop:F/g}.
\end{proof}

To see that an irreducible polynomial of degree $n$ exists, we need the following result.

\begin{theorem}\label{thm:fact}
    Let $p$ be a prime and let $n\in\N$. Then $x^{p^n}-x$ is the product of all monic irreducible polynomials in $\F_p[x]$ of degree dividing $n$.
\end{theorem}

For example, when $p = 2$, we have
\begin{eqnarray*}
    x^4 - x &=& x(x + 1)(x^2 + x + 1)\\
    x^8 - x &=& x(x + 1)(x^3 + x^2 + 1)(x^3 + x + 1)
\end{eqnarray*}

\begin{cor}
    Let $S_p(n)$ denote the number of monic irreducible polynomials in $\F_p[x]$ of degree $n$. Then $S_p(n)>0$ for any $n\in\N$.
\end{cor}

\begin{proof}
 Since degree is additive, we have 
$$p^n = \sum_{d\mid n}dS_p(d) \qquad\Longrightarrow\qquad nS_p(n) = \sum_{d\mid n}\mu(d)p^{n/d},$$
by HW 3 Problem 3, where $\mu$ is the Mobius function.
Note that if $d>1$, then $n/d \leq n/2$. Hence
$$|p^n - nS_p(n)|  = \left|\sum_{d\mid n,d>1} \mu(d)p^{n/d}\right| \leq p^{\lfloor n/2\rfloor} + p^{\lfloor n/2\rfloor-1} + \cdots + 1 < p^{\lfloor n/2\rfloor+1} \leq p^n.$$
This implies that $nS_p(n) > 0$.
\end{proof}

For example
$$S_2(6) = \frac{1}{6}\Big(2^6 - 2^3 - 2^2 + 2^1\Big) = 9.$$

\begin{center}
    \add{Lecture 15 Mon 10/16}
\end{center}

\begin{cor}\label{cor:iso}
    Let $p$ be a prime and let $n\in\N$. Let $f(x),g(x)\in\F_p[x]$ be two irreducible polynomials of degree $n$. Then $\F_p[x]/(f(x))\cong \F_p[x]/(g(x)).$
\end{cor}

We need a straightforward lemma on how to define a homomorphism out of these quotients.
\begin{lemma}\label{lem:mapf}
    Let $p$ be a prime. Suppose $f(x)$ is an irreducible polynomial in $\F_p[x]$. Suppose $R$ is a ring of characteristic $p$, so that the prime subfield of $R$ is $\F_p$. Then any ring homomorphism $\F_p[x]/(f(x))\rightarrow R$ is of the form $j(x) + (f(x))\mapsto j(\alpha)$ for any $j(x)\in\F_p[x]$ where $\alpha\in R$ is a root of $f(x)$. Any such ring homomorphism is automatically injective.
\end{lemma}

\begin{proof}
    Easy exercise. Any ring homomorphism must be identity on the prime subfield $\F_p$. If it sends $x + (f(x))$ to $\alpha$, then it sends $j(x) + (f(x))$ to $j(\alpha)$ for any $j(x)\in\F_p[x]$. Since $f(x) + (f(x))$ is $0$, we must have $f(\alpha) = 0$. The kernel is a proper ideal of the field $\F_p[x]/(f(x))$ and so must be $\{0\}$.
\end{proof}

\noindent\textbf{Proof of Corollary \ref{cor:iso}}:
    Let $F = \F_p[x]/(g(x))$. It suffices to find a root $\alpha$ of $f(x)$ in $F$, since then we would have an injective homomorphism $\F_p[x]/(f(x))\rightarrow \F_p[x]/(g(x))$, which is also surjective because they have the same size. 

    We may assume $f(x)$ and $g(x)$ are monic. Every nonzero element $\alpha\in F^\times$ satisfies $\alpha^{p^n-1} - 1 =0$. Hence, every element of $F$ is a root of $x^{p^n}-x\in F[x]$. Since $x^{p^n}-x$ has at most $p^n$ roots in $F$, we see that it splits completely in $F[x]$ as $$x^{p^n} - x = \prod_{\alpha\in F}(x - \alpha).$$
    Hence $f(x)$ as a factor of $x^{p^n} - x$ in $\F_p[x]$, also splits completely in $F[x]$. We may then take any of its root to define the desired isomorphism. $\Box$

\v
We collect two important results, which were proved in the above.

\begin{cor}\label{cor:splits}
    Every irreducible polynomial in $\F_p$ of degree dividing $n$ splits completely in $\F_{p^n}$.
\end{cor}

\begin{cor}
    Let $F$ be a finite field and let $q = |F|$. Then $$x^{q} - x = \prod_{\alpha\in F}(x - \alpha).$$
\end{cor}

\vspace{5pt}
\noindent\textbf{Example}: The field $\F_8$ is given by $\F_2[x]/(x^3 + x + 1)$ and also by $\F_2[x]/(x^3 + x^2 + 1)$. Write $\alpha = x + (x^3 + x^2 + 1)$ in $F = \F_2[x]/(x^3 + x^2 + 1)$. Then $\alpha^3 + \alpha^2 + 1 = 0$. The irreducible polynomials $x^3 + x^2 + 1$ and $x^3 + x + 1$ should split completely in $F$. Let's find their roots.
  Note that
$$(\alpha+1)^3 + (\alpha+1) + 1 = \alpha^3 + \alpha^2 + \alpha + 1 + \alpha + 1 + 1 = \alpha^3 + \alpha^2 + 1 = 0.$$
Hence, $\alpha+1$ is a root of $x^3 + x + 1$. The other two roots of $x^3 + x^2 + 1$ in $F$ are $\alpha^2$ and $\alpha^4 = \alpha^2 + \alpha + 1$. One can check this via
$$(\alpha^2)^3 + (\alpha^2)^2 + 1 = \alpha^6 + \alpha^4 + 1 = (\alpha^3 + \alpha^2 + 1)^2 = 0.$$
The other two roots of $x^3 + x + 1$ are $(\alpha+1)^2 = \alpha^2 + 1$ and $(\alpha+1)^4 = \alpha^4 + 1 = \alpha^2 + \alpha$. In other words, we have the factorizations
\begin{eqnarray*}
    x^3 + x^2 + 1 &=& (x + \alpha)(x + \alpha^2)(x + \alpha^2 + \alpha + 1),\\
    x^3 + x + 1 &=& (x + \alpha + 1)(x + \alpha^2 + 1)(x + \alpha^2 + \alpha).
\end{eqnarray*}

We make a very important observation. From the binomial expansion, we have
$$(a + b)^{p^n} = \sum_{r = 0}^{p^n}\binom{p^n}{r}a^rb^{p^n - r}.$$
Moreover, we know that $$\nu_p\Big(\binom{p^n}{r}\Big) = n - \nu_p(r) > 0 \qquad\mbox{if}\qquad 0 < r < p^n$$ by Corollary \ref{cor:ndivp}. In other words, all the middle coefficients are divisible by $p$. Therefore, if we are in characteristic $p$, then
$$(a + b)^{p^n} = a^{p^n} + b^{p^n}.$$
In particular, if $f(x) = a_mx^m + \cdots + a_0 \in \F_{p^n}[x]$, then each $a_i^{p^n} = a_i$ and
$$f(x)^{p^n} = a_m^{p^n}x^{mp^n} + \cdots + a_0^{p^n} = a_m(x^{p^n})^m + \cdots + a_0 = f(x^{p^n}).$$

\begin{center}
    \add{Lecture 16 Wed 10/18}
\end{center}

\noindent\textbf{Proof of Theorem \ref{thm:fact}}: We recall a result proved in HW 1:
$$\gcd(p^k - 1, p^\ell - 1) = p^{\gcd(k,\ell)} - 1.$$
In particular, $$p^k - 1\mid p^\ell - 1\quad\Longleftrightarrow\quad k\mid\ell.$$

We first prove that if $f(x)\in\F_p[x]$ is a monic irreducible polynomial of degree $d\mid n$, then $x^{p^n} - x \in (f(x))$. If $d = 1$, then $f(x) = x - a$ for some $a\in\F_p$, in which case we know $x-a\mid x^{p^n}-x$ because $a^{p^n} = a$. Suppose now $d\geq 2$. Let $F = \F_p[x]/(f(x))$. Let $\alpha = x + (f(x))$. Then $\alpha\neq 0$ and so $\alpha^{p^d-1} = 1$. Since $d\mid n$, we know that $p^d - 1 \mid p^n - 1$. Hence $\alpha^{p^n - 1} = 1$. So $\alpha^{p^n} = \alpha$. This means that $x^{p^n} - x \in (f(x))$. 

Conversely, suppose $x^{p^n} - x\in(f(x))$ for some irreducible polynomial $f(x)\in\F_p[x]$ of degree $d$. We prove $d\mid n$. Again let $F = \F_p[x]/(f(x))$. Let $\alpha = a(x) + (f(x))$ be a primitive element so that $o(\alpha) = p^d - 1$. We would be done if we can prove that $\alpha^{p^n} = \alpha$, which implies that $\alpha^{p^n-1}=1$ and so $p^d - 1\mid p^n - 1$. We note from last time that if $a(x)=a_mx^m + \cdots + a_0\in \F_p[x]$, we have $$a(x)^{p^n} = a_mx^{mp^n} + a_{m-1}x^{(m-1)p^n} + \cdots + a_0.$$
Now each $$x^{jp^n} - x^j = ((x^{p^n} - x) + x)^j - x^j \in (x^{p^n} - x)$$ and so also in $(f(x))$. Hence we see that $$a(x)^{p^n} - a(x) = \sum_{j=0}^m a_j(x^{jp^n} - x^j) \in (f(x)).$$ In other words, $\alpha^{p^n} = \alpha$ in $F$.

Finally, we need to prove that $x^{p^n} - x$ has no repeated factors, so that every monic irreducible polynomial of degree dividing $n$ appears exactly once in the factorization of $x^{p^n} - x$. This follows easily from $$(x^{p^n} - x)' = p^nx^{p^n - 1} - x = -1$$
which shares no common divisor with $x^{p^n} - x$. $\Box$

\begin{comment}
    Let $f_1(x),\ldots,f_N(x)$ denote all the monic irreducible polynomials of degree dividing $n$. Then for $i\neq j$, we have $f_i(x)\notin(f_j(x))$. Then we have the factorization
$$x^{p^n} - x = f_1(x)f_2(x)\cdots f_N(x)h(x)$$ 
for some $h(x)\in \F_p[x].$ Suppose for a contradiction that $h(x)$ has degree at least $1$. Let $g(x)$ be an irreducible factor of $h(x)$. Then $x^{p^n} - x \in (g(x))$ and so $g = f_i$ for some $i=1,\ldots,N$. So $x^{p^n} - x = f_i(x)^2g_i(x)$ for some $g_i(x)\in\F_p[x]$. However, the derivative of $x^{p^n} - x$ is $p^nx^{p^n-1} - 1 = -1$ in $\F_p[x]$ but the derivative of $f_i(x)^2g_i(x)$ is $2f_i(x)f_i'(x)g(x) + f_i(x)^2g_i'(x)$, which is divisible by $f_i$. Contradiction. Therefore, $h(x)$ has degree $0$ and thus must be $1$ since $f_1,\ldots,f_N$ are all monic.
\end{comment}
    
\begin{proposition}
    The field $\F_{p^n}$ has a subring isomorphic to $\F_{p^d}$ if and only if $d\mid n$, in which case, the subring is unique and we say $\F_{p^d}$ is a subfield of $\F_{p^n}$.
\end{proposition}

\begin{proof}
    Consider the subset $$R = \{\alpha\in\F_{p^n}\colon \alpha^{p^d} = \alpha\}.$$ Then $R$ has size at most $p^d$ since it is the set of roots of a polynomial of degree $p^d$. Suppose a homomorphism $\varphi:\F_{p^d}\rightarrow\F_{p^n}$ (which is the same as an isomorphism from $\F_{p^d}$ to a subring of $\F_{p^n}$) exists. Then since every element $\beta$ in $\F_{p^d}$ satisfies $\beta^{p^d} = \beta$, we have $(\varphi(\beta))^{p^d} = \varphi(\beta)$ and so $\varphi(\beta)\in R$. Comparing sizes gives that the image of $\varphi$ is $R$. This proves uniqueness. Let $\beta$ be an element of $\F_{p^d}$ of order $p^d - 1$. Then $\varphi(\beta)$ also has order $p^d - 1$ in $\F_{p^n}$ since $\varphi$ is injective. Hence $p^d - 1\mid p^n - 1$, implying that $d\mid n$.
    
    Suppose conversely that $d\mid n.$ Then any monic irreducible polynomial of degree dividing $d$ also has degree dividing $n$. Hence $x^{p^d} - x$, which is a product of monic irreducible polynomials of degree dividing $d$, splits completely in $\F_{p^n}$ by Corollary \ref{cor:splits}. So the subset $$R = \{\alpha\in\F_{p^n}\colon \alpha^{p^d} = \alpha\}$$ has size $p^d$. Suppose $\alpha,\beta\in R$. Then
    \begin{eqnarray*}
        (\alpha+\beta)^{p^d} &=& \alpha^{p^d} + \beta^{p^d} = \alpha + \beta,\\
        (\alpha\beta)^{p^d} &=& \alpha^{p^d}\beta^{p^d} = \alpha\beta,\\
        (\alpha^{-1})^{p^d} &=& (\alpha^{p^d})^{-1} = \alpha^{-1}.
    \end{eqnarray*}
    This proves that $R$ is a subfield of $\F_{p^n}$. It has size $p^d$ and so is isomorphic to $\F_{p^d}$. 
\end{proof}

For $n = 1$, we have the factorization
$$x^p - x = x(x - 1)\cdots(x - (p-1)).$$
Canceling the $x$ gives $$x^{p-1} - 1 = (x - 1)(x - 2)\cdots(x - (p-1)),$$
which we already knew from Fermat's little theorem. Setting $x = 0$ gives $$-1 = (-1)^{p-1}(p-1)!\qquad\mbox{in }\F_p.$$
Translating it to integer congruences gives Wilson's Theorem
$$(p-1)!\equiv -1\pmod{p}.$$
There is of course a more direct proof by pairing $a$ and $b$ if $ab\equiv 1\pmod{p}$. Then only $1$ and $-1$ are left over.

\begin{comment}
    The case $n = 2$ is particularly interesting. There are $(p^2 - p)/2$ monic irreducible quadratic polynomials. We assume $p>2$. Then we may complete the square of any monic quadratic polynomial as
$$x^2 + ax + b = \Big(x + \frac{a}{2}\Big)^2 - \Big(\frac{a^2}{4} - b\Big).$$
Here the fractions can be viewed as multiplications by $2^{-1}$ and $4^{-1}$ in $\F_p$. Now a quadratic of the form $x^2 - c$ is irreducible if and only if $c$ is not a square in $\F_p$. We say a congruence class $c$ mod $p$ is a \textbf{quadratic residue} mod $p$ if $c$ is a square in $\F_p$; otherwise, we say it is a \textbf{quadratic non-residue}. We see that each quadratic non-residue $c$ gives rise to $p$ irreducible polynomials of the form $(x + a)^2 - c$. Hence, there are $\frac{p-1}{2}$ quadratic non-residues, and $\frac{p+1}{2}$ quadratic residues. If we remove $0$ mod $p$, then there is an equal number of them. Moreover, we know that every quadratic polynomial has a root in $\F_{p^2}$. 
\end{comment}

When $n = 2$, we note that every quadratic polynomial over $\F_p$ has a root in $\F_{p^2}$. 


\begin{theorem}
    Let $p$ be a prime divisor of $n^3 + n^2 - 2n - 1$ for some integer $n$. Then $p = 7$ or $p\equiv \pm1\pmod{7}$.
\end{theorem}

\begin{proof}
    We have some $n\in\F_p$ such that $n^3 + n^2 - 2n - 1 = 0$. Let $\alpha\in\F_{p^2}$ be a root of $x^2 - nx + 1.$ Then $\alpha\neq 0$ and $n = \alpha + \alpha^{-1}$. Now
    \begin{eqnarray*}
        0 &=& (\alpha + \alpha^{-1})^3 + (\alpha + \alpha^{-1})^2 - 2(\alpha + \alpha^{-1}) - 1\\
        &=& \alpha^3 + 3\alpha + 3\alpha^{-1} + \alpha^{-3} + \alpha^2 + 2 + \alpha^{-2} - 2(\alpha + \alpha^{-1}) - 1\\
        &=& \alpha^3 + \alpha^2 + \alpha + 1 + \alpha^{-1} + \alpha^{-2} + \alpha^{-3}.
    \end{eqnarray*}
    Multiplying by $\alpha^3(\alpha-1)$ gives $$\alpha^7 - 1 = 0.$$
    So the order $o(\alpha)$ of $\alpha$ in $\F_{p^2}$ divides $7$. If $o(\alpha) = 1$, then $\alpha = 1$, and we get $0 = 7$ and so $p = 7$. Suppose now $o(\alpha) > 1$. Then $o(\alpha) = 7$. Since $o(\alpha)\mid|\F_{p^2}^\times|$, we get $7\mid p^2 - 1.$ So $7\mid (p-1)(p+1)$ and hence $p\equiv \pm1\pmod{7}$. 
\end{proof}

The key to this cute result is that for the polynomial $f(x) = x^3 + x^2 - 2x - 1$, we have
$$f(x + x^{-1}) = x^{-3}\,\Phi_7(x).$$
It follows from the fact that $\Phi_m(x)$ is reciprocal that for any $m\geq 2$, there exists $f(x)\in\Z[x]$ such that
$$f(x + x^{-1}) = x^{-\phi(m)/2}\,\Phi_m(x).$$
With a little more work (to calculate $f(0)$ which involves calculating $\Phi_m(i)$), one can use this to give a Euclidean proof for the infinitude of primes of the form $qk - 1$ where $q$ is a prime. If $m$ is not a prime, we won't be able to conclude from $m\mid p^2 - 1$ that $p\equiv \pm1\pmod{m}$. In HW6, you will work this out for $m = 9$.

\subsection*{Exercise}
\begin{enumerate}[\thesection .1]
    \item Let $p$ be a prime and let $a\in\Z$ with $p\nmid a$ and $o_p(a) = m$. Prove that $p\mid \Phi_m(a)$.
    \solu{
    For contradiction, suppose that $p 
    \nmid \Phi_m (a)$. We have $p \mid x^m - 1$ and $p \mid \Phi_d(a)$ for some $d < m$ because $ \prod_{d \mid m}\Phi_d(x) = x^m - 1$. $p \mid \Phi_d(x)$ implies that $ p \mid x^d - 1$, contradicting minimality of the order. 
    }
    \item Let $F$ be a finite field and let $k\in\N$ such that $\gcd(k,|F| - 1) = 1$. Prove that every element in $F$ is the $k$-th power of some element in $F$.\label{exer:10.1}
    \solu{
    Given a generator $\alpha$, it suffices to show that the sets \[\{\alpha, \alpha^2, \cdots, \alpha^{|F|  -1 }\}, \{\alpha^k, \alpha^{2k}, \cdots, \alpha^{(|F| - 1)k}\}\] are the same. The sets $\{ 1,2,3, \cdots, |F| -1\}$ and $\{ k, 2k, 3k, \cdots, (|F| - 1)k\}$ are the same iff $\gcd(|F| -1,k) = 1$. We are done.  
    }
    \item Let $F$ be a finite field and let $k\in\N$. Let $S$ be the subset of $F$ consists of sums of $k$-th powers. (Note that an empty sum is $0$.) Prove that $S$ is a subfield of $F$.
    \solu{
    For $k=p-1$ where $p$ is the characteristic, then $S=\F_p$.\\
    Otherwise use $\sum_{x\in F}x^k=0$ to validate addition, $x^{|F|-1}=1$ to validate multiplication.
    }
    \item Prove that for any positive integer $n\neq 2$, every element in $\F_{2^n}$ is a sum of cubes. Note that the cubes in $\F_4$ are precisely $0$ and $1$ and so the subfield of sums of cubes in $\F_4$ is $\F_2$.
    \item Let $F$ be a finite field with $3\mid |F| - 1$. Suppose there exist $u,v\in F^\times$ such that $u^3 + v^3 = 1$. Let $w$ be an arbitrary element of $F$. Let
    $$A = \{a^3\colon a\in F\},\quad B = \{w + b^3\colon b\in F\},\quad C = \{u^3w + c^3\colon c\in F\}.$$
    \begin{enumerate}
        \item Prove that $A$, $B$, $C$ are not pairwise disjoint.
        \item Prove that $w$ is a sum of two cubes. In other words, every element of $F$ is a sum of two cubes.
    \end{enumerate}\label{exer:10.4}
    \item Let $F$ be a finite field with $3\mid |F| - 1$ and $|F| > 7$. Suppose there does not exist $u,v\in F^\times$ such that $u^3 + v^3 = 1$. Let $\alpha\in F^\times$ be a primitive element. Let
    $$A = \{\alpha^{3k}\colon k\in\Z\},\quad D = \{\alpha^{3k+1}\colon k\in\Z\},\quad E = \{\alpha^{3k+2}\colon k\in\Z\}.$$
    \begin{enumerate}
        \item Prove that at least one of $\alpha^3-1$, $\alpha^3 +1$, $\alpha^6-1$ belongs to $D$, and at least one of them belongs to $E$.
        \item Prove that every element of $F$ is a sum of two cubes.
    \end{enumerate}\label{exer:10.5}
    \item Exercises 10.\ref{exer:10.1}, 10.\ref{exer:10.4}, 10.\ref{exer:10.5} imply that for any finite field except $\F_4$ and $\F_7$, every element is a sum of two cubes. Prove that for $F =\F_7$, every element is a sum of three cubes, and not every element is a sum of two cubes.
    \solu{Exhaust calculation kills this problem.}
    \item Prove that for any $\alpha\in\F_7$, the polynomial $x^4 - \alpha\in\F_7[x]$ is reducible.
    \solu{Exhaust calculation kills this problem.}
    \item Let $q = p^n$ be a power of a prime. Let $\alpha\in\F_q$ be a primitive element. Suppose $q\equiv 1\pmod{d}$ for some positive integer $d$. Prove that $x^d - \alpha\in \F_q[x]$ is irreducible.
\end{enumerate}

\section{Quadratic reciprocity}

We say an integer $a$ is a \textbf{quadratic residue} mod $m$ (or in $\Z/m\Z$) if the equation $x^2 \equiv a\pmod{m}$ has an integer solution. Otherwise, we say it is a \textbf{quadratic non-residue}. We consider the case where $m = p$ is a prime first. When $p = 2$, every integer is a quadratic residue. So we assume $p$ is odd.

Stated in terms of the finite field $\F_p$, we are just studying the set $\{b^2\colon b\in\F_p\}$. For example in $\F_7$, the set of quadratic residues are $\{0,1,2,4\}$ and the set of quadratic non-residues are $\{3,5,6\}$. Let $\alpha$ be a primitive element in $\F_p^\times$ so that we may write 
$$\F_p = \{0, \alpha,\alpha^2,\ldots,\alpha^{p-1}\}.$$
Moreover, we know that $\alpha^k = \alpha^\ell$ if and only if $p-1\mid k - \ell$.

\begin{lemma}
    Let $p$ be an odd prime and let $\alpha$ be primitive in $\F_p^\times$. For $k = 1,\ldots,p-1$, the element $\alpha^k$ is a quadratic residue if and only if $k$ is even.
\end{lemma}

\begin{proof}
    If $k = 2\ell$ is even, then $\alpha^k = (\alpha^\ell)^2$. Conversely, if $\alpha^k = (\alpha^\ell)^2$ for some $\ell\in\Z$, then $p - 1 \mid k - 2\ell$ and so $k$ is even since $p$ is odd.
\end{proof}

\begin{cor}
    Let $p$ be an odd prime. Let $a\in\F_p$, then
    $$a^{(p-1)/2} = \begin{cases}
        1&\mbox{ if }a\mbox{ is a nonzero quadratic residue}\\
        -1&\mbox{ if }a\mbox{ is a quadratic non-residue}\\
        0&\mbox{ if }a = 0.
    \end{cases}$$
\end{cor}

\begin{proof}
    Let $\alpha$ be a primitive element. Then $(\alpha^{(p-1)/2})^2 = \alpha^{p-1} = 1$. Hence $\alpha^{(p-1)/2} = -1$ since it can't be $1$. Now write $a = \alpha^k$ for some $k = 0,\ldots,p-2$. If $k = 2\ell$ is even, then $a^{(p-1)/2} = \alpha^{(p-1)\ell} = 1$. If $k = 2\ell+1$ is odd, then $a^{(p-1)/2} = \alpha^{(p-1)\ell + (p-1)/2} = -1$.
\end{proof}

\begin{center}
    \add{Lecture 17 Fri 10/20}
\end{center}

We define the \textbf{Legendre symbol} $\displaystyle\lg{a}{p}$ to be the integer $1$, $-1$ or $0$ depending on if $a$ is a nonzero quadratic residue, quadratic non-residue, or $0$ in $\F_p$. In other words, $$\lg{a}{p} \equiv a^{(p-1)/2}\pmod{p},$$
from which we see that it is multiplicative:
$$\lg{ab}{p} = \lg{a}{p}\lg{b}{p}$$
so that the product of two quadratic non-residues is a quadratic residue.

\begin{cor}
    We have that $-1$ is a quadratic residue mod $p$ if and only if $p = 2$ or $p\equiv 1\pmod{4}$. In other words, for $p\neq 2,$ $$\lg{-1}{p} = (-1)^{(p-1)/2}.$$
\end{cor}

\begin{proposition}\label{prop:2p}
    We have that $2$ is a quadratic residue mod $p$ if and only if $p = 2$ or $p\equiv \pm1\pmod{8}$. In other words, for $p\neq 2,$ $$\lg{2}{p} = (-1)^{(p^2-1)/8}.$$
\end{proposition}

\begin{cor}
    We have that $-2$ is a quadratic residue mod $p$ if and only if $p = 2$ or $p\equiv 1$ or $3$ mod $8$.
\end{cor}

\begin{proof}
    Suppose $p\neq 2$. We know that $-2$ is a quadratic residue precisely when both $-1$ and $2$ are quadratic residues or when they are both non-residues. The first case corresponds to $p\equiv 1\pmod{8}$ and the second case corresponds to $p\equiv 3\pmod{8}$.
\end{proof}

To prove Proposition \ref{prop:2p}, we use the following lemma, which will also be used a few times later.

\begin{lemma}
    Let $p$ be a prime and let $m$ be a positive integer coprime to $p$. Then there exists $a\in\F_{p^{\phi(m)}}^\times$ such that $o(a) = m$. In fact, such an element exists in $\F_{p^{o_m(p)}}^\times.$ We call such an element a primitive $m$-th root of unity.
\end{lemma}

\begin{proof}
    Let $d = o_m(p)$. Then $m\mid p^d - 1$ and $d\mid \phi(m)$ so $\F_{p^d}\subseteq\F_{p^{\phi(m)}}.$ Let $\alpha$ be a primitive element of $\F_{p^d}^\times$. Then $o(\alpha) = p^{d} - 1$. Hence $a = \alpha^{(p^{d}-1)/m}$ has order $m$.
\end{proof}

\noindent\textbf{Proof of Proposition \ref{prop:2p}}: Suppose $p$ is an odd prime. Let $\alpha\in\F_{p^4}^\times$ be a primitive $8$-th root of unity. The key idea is to find some $\beta\in\F_{p^4}$ such that $\beta^2 = 2$. Then $2$ is a quadratic residue mod $p$ if and only if $\beta\in\F_p$ and we can check if $\beta\in\F_p$ by comparing $\beta^p$ with $\beta.$ Take $\beta = \alpha + \alpha^{-1}$. Then
$$\beta^2 = \alpha^2 + 2 + \alpha^{-2}.$$ Since $\alpha^8 = 1$ and $\alpha^4\neq 1$, we have $\alpha^4 = -1$, and so $\alpha^2 = -\alpha^{-2}$. Hence $\beta^2 = 2$.
%Hence the polynomial $x^2 - 2$ factors as $(x - \beta)(x + \beta)$ in $\F_{p^4}$. So $2$ is a quadratic residue in $\F_p$ if and only if $\beta\in\F_p$ if and only if $\beta^p = \beta$. 
Since we are in characteristic $p$, we have $\beta^p = \alpha^p + \alpha^{-p}$. Since $\alpha^8 = 1$, we see that $\beta^p$ depends only on what $p$ is mod $8$. It is now easy to check that if $p\equiv \pm1\pmod{8}$, then
$$\beta^p = \alpha^1 + \alpha^{-1} = \beta$$
and when $p\equiv \pm3\pmod{8}$, 
$$\beta^p = \alpha^3 + \alpha^{-3} = -\alpha^{-1} - \alpha = -\beta.$$
Therefore, $\beta\in\F_p$ if and only if $p\equiv \pm 1\pmod{8}$. \hspace{20pt} $\Box$



\begin{theorem}
    (Quadratic reciprocity) Suppose $p,q$ are two distinct odd primes. Then
    $$\lg{p}{q}\lg{q}{p} = (-1)^{\frac{p-1}{2}\frac{q-1}{2}}.$$
\end{theorem}
In particular
\begin{eqnarray*}
 \lg{p}{q} &=& -\lg{q}{p},\mbox{ if both }p,q\equiv3\pmod{4};\\
 \lg{p}{q} &=& \lg{q}{p},\,\,\,\,\,\mbox{ otherwise}.
\end{eqnarray*}
For example, suppose we want to compute $\displaystyle\lg{11}{29}$. Then we have
$$\lg{11}{29} = \lg{29}{11} = \lg{7}{11} = -\lg{11}{7} = -\lg{4}{7}=-1.$$
As another example, we can work out when $3$ is a quadratic residue mod $p$. If $p\equiv 1\pmod{4}$, then $\lg{3}{p} = \lg{p}{3} = 1 \Leftrightarrow p\equiv 1\pmod{3}.$ If $p\equiv 3\pmod{4}$, then $\lg{3}{p} = -\lg{p}{3} = 1 \Leftrightarrow p\equiv 2\pmod{3}.$ Hence $\lg{3}{p} = 1$ if and only if $p\equiv \pm1\pmod{12}$. The case for $5$ is easier because $5\equiv 1\pmod{4}$ and so $\lg{5}{p} = \lg{p}{5} = 1 \Leftrightarrow p\equiv \pm 1\pmod{5}$. The case for $7$ is similar: if $p\equiv 1\pmod{4}$, we need $\lg{p}{7}=1$ so $p\equiv 1,2,4\pmod{7}$; if $p\equiv 3\pmod{4}$, we need $\lg{p}{7}=-1$ so $p\equiv 3,5,6\pmod{7}$.

\begin{cor} We have
    \begin{enumerate}[(a)]
        \item $3$ is a quadratic residue mod $p$ if and only if $p = 3$ or $p\equiv \pm1\pmod{12}.$
        \item $5$ is a quadratic residue mod $p$ if and only if $p = 5$ or $p\equiv \pm1\pmod{5}.$
        \item $7$ is a quadratic residue mod $p$ if and only if $p = 7$ or $p\equiv \pm1, \pm9, \pm25\pmod{28}.$
    \end{enumerate} 
\end{cor}
Note that for a prime to be $\pm1$ mod $5$, it is equivalent to be $\pm1$ or  $\pm9$ mod $20$. It is then natural to expect the following result, which is actually equivalent to quadratic reciprocity.

\begin{proposition}\label{prop:qr2}
    Suppose $p,q$ are distinct odd primes. Then $q$ is a quadratic residue mod $p$ if and only if $p\equiv \pm a^2\pmod{4q}$ for some odd integer $a$.
\end{proposition}

\noindent\textbf{Proof of equivalence}: Let $$p^* = (-1)^{(p-1)/2}p = \lg{-1}{p}p.$$ It is an easy exercise to prove that $p^*$ is a quadratic residue mod $q$ if and only if $p\equiv \pm a^2\pmod{4q}$ for some odd integer $a$. 

If $p\equiv 1\pmod{4}$, then $p^* = p$. If $p$ is a square mod $q$, then $p\equiv b^2\pmod{q}$ for some integer $b$. By the Chinese remainder theorem, there exists an integer $a$ that is 1 mod 4 and $b$ mod $q$. So $p\equiv a^2\pmod{4q}$. Since $p$ is odd and $4q$ is even, we have $a$ is odd. Conversely, if $p\equiv \pm a^2\pmod{4q}$ for some odd integer $a$. If $p\equiv -a^2\pmod{4q}$, then $p\equiv -a^2\pmod{4}$ but $a^2\equiv p \equiv 1\pmod{4}$, which is impossible. So $p\equiv a^2\pmod{4q}$ and thus $p\equiv a^2\pmod{q}$. The case for $p\equiv 3\pmod{4}$ is similar. 

By multiplicativity, we have
$$\lg{p^*}{q} = \lg{(-1)^{(p-1)/2}}{q}\lg{p}{q} = (-1)^{\frac{p-1}{2}\frac{q-1}{2}}\lg{p}{q}.$$
Hence quadratic reciprocity is equivalent to $$\lg{q}{p} = \lg{p^*}{q}.$$

\begin{comment}
    In number theory, it is sometimes more natural to take $$q^* = (-1)^{(q-1)/2}q = \lg{-1}{q}q.$$
Then $$\lg{q^*}{p} = \lg{(-1)^{(q-1)/2}}{p}\lg{q}{p} = (-1)^{\frac{p-1}{2}\frac{q-1}{2}}\lg{q}{p}.$$
When expressed in this notation, quadratic reciprocity may be restated as 
\end{comment}


\begin{center}
    \add{Lecture 18 Mon 10/23}
\end{center}

\subsection*{Proof of Quadratic Reciprocity}
Similar to the proof of Proposition \ref{prop:2p}, we let $\alpha\in\F_{p^{q-1}}$ be a primitive $q$-th root of unity and try to write down a square root of $q^*$. Then we check whether it is in $\F_p$ by raising it to the power $p$. We will see in about a month why it is more natural to find $\sqrt{q^*}$ in $\F_{p^{q-1}}$ than $\sqrt{q}$, even though they both are contained in $\F_{p^{q-1}}$ (in fact in $\F_{p^2}$). 

We first note that since $\alpha^q = 1$, it makes sense to write $\alpha^m$ for any $m\in\F_q$. In other words, the value $\alpha^k$ is independent of the choice of the integer $k$ in the congruence class of $m$ mod $q$. We define
$$\beta = \sum_{m\in\F_q} \lg{m}{q}\alpha^m.$$
As a running example, we take $p = 5$ and $q = 3$. Then $\alpha\in\F_{25}$ is a primitive cube root of unity. In fact, we may take $\alpha = x + (x^2 + x + 1)$ in $\F_5[x]/(x^2 + x + 1).$ Then
$$\beta = \lg{0}{3}\alpha^0 + \lg{1}{3}\alpha^1 + \lg{2}{3}\alpha^2 = \alpha - \alpha^2 = \alpha - (-\alpha - 1) = 2\alpha + 1.$$
We can now compute $$\beta^2 = 4\alpha^2 + 4\alpha + 1 = 4(-\alpha-1) + 4\alpha + 1 = -3 = 3^*.$$
Note also that
$$\beta^5 = \alpha^5 - \alpha^{10} = \alpha^2 - \alpha = -\beta = \lg{3}{5}\beta.$$
If we were to try this with $p = 7$ and $q = 3$, then in fact we may take $\alpha = 2 \in\F_7.$ Then $\beta = \alpha - \alpha^2 = -2$ and $\beta^2 = 4 = -3$ in $\F_7$.

Back to the general case, we square $\beta$ to get
$$\beta^2 = \sum_{m\in\F_q}\sum_{n\in\F_q}\leg{m}{q}\lg{n}{q}\alpha^{m+n} = \sum_{m\in\F_q}\sum_{n\in\F_q}\leg{mn}{q}\alpha^{m+n}.$$
Now we collect terms with the same power of $\alpha$. Note that $t=m+n$ takes arbitrary values in $\F_q$:
$$\beta^2 = \sum_{t\in\F_q} \left(\sum_{m\in\F_q} \lg{m(t-m)}{q}\right)\alpha^t = \sum_{t\in\F_q} \left(\sum_{m\in\F_q^\times} \lg{m(t-m)}{q}\right)\alpha^t$$ where we removed the $m = 0$ term because the legendre symbol $\leg{m(t-m)}{q}$ is $0$. Let's see what the inner sum is equal to in our example:
\begin{eqnarray*}
    t=0&\colon& \lg{1(-1)}{3} + \lg{2(-2)}{3} = \lg{-1}{3}\cdot 2\\
    t=1&\colon& \lg{1(0)}{3} + \lg{2(-1)}{3} = \lg{-1}{3}\cdot (-1)\\
    t=2&\colon& \lg{1(1)}{3} + \lg{2(0)}{3} = \lg{-1}{3}\cdot (-1)
\end{eqnarray*}
If we then factor out the $\lg{-1}{3}$, we get
$$2 - \alpha - \alpha^2 = 3 - (1 + \alpha + \alpha^2) = 3.$$
In general, as a primitive $q$-th root of unity, $\alpha$ satisfies $$1 + \alpha + \cdots + \alpha^{q-1} = 0.$$
This suggests that we should prove
\begin{eqnarray*}
    t=0&\colon& \sum_{m\in\F_q^\times} \lg{m(t-m)}{q} = \lg{-1}{q}\cdot (q-1),\\
    t\neq 0&\colon& \sum_{m\in\F_q^\times} \lg{m(t-m)}{q} = \lg{-1}{q}\cdot (-1),
\end{eqnarray*}
which would imply that
$$\beta^2 = \lg{-1}{q}\left((q-1) - \alpha - \alpha^2 - \cdots - \alpha^{q-1}\right) = \lg{-1}{q}q = q^*.$$

Since $m\neq0$, we have
$$\leg{m(t-m)}{q} = \leg{-m^2(1-tm^{-1})}{q} = \leg{-m^2}{q}\leg{1-tm^{-1}}{q} = \leg{-1}{q}\leg{1-tm^{-1}}{q}.$$ 
If $t = 0$, then we get $\lg{-1}{q}$ for each $m\in\F_q^\times$. There are $q-1$ of them, so we get the desired formula for $t = 0$. When $t\neq 0$, $tm^{-1}$ runs through every element in $\F_q^\times$ and so $1 - tm^{-1}$ runs through every element in $\F_q$ that is not $1$. Hence
$$\sum_{m\in\F_q^\times}\leg{1-tm^{-1}}{q} = \sum_{s\in\F_q}\leg{s}{q} - \leg{1}{q} = \sum_{s\in\F_q^\times}\leg{s}{q} + \leg{0}{q} - \leg{1}{q} = -1.$$
Here the first sum is $0$ because half the elements of $\F_q^\times$ are quadratic residues and the other halfs are quadratic nonresidues. We have therefore proved that 
$$\beta^2 = q^*.$$


We next compare $\beta^p$ with $\beta$ to see if $\beta$ lies in $\F_p$. Since we are in characteristic $p$ and since $\lg{m}{q}$ only takes value in $0,1,-1$, all of which are fixed by raising to the power $p$, we have
$$\beta^p = \sum_{m\in\F_q}\leg{m}{q}^p\alpha^{mp} = \sum_{m\in\F_q}\leg{m}{q}\alpha^{mp}.$$
Since $p\neq q$, as $m$ varies in $\F_q$, $mp$ runs through all values of $\F_q$. Setting $t = mp$, we get
$$\beta^p = \sum_{t\in\F_q} \lg{tp^{-1}}{q}\alpha^t = \lg{p^{-1}}{q}\sum_{t\in\F_q} \lg{t}{q}\alpha^t = \lg{p}{q}\beta.$$
Therefore, we conclude that $q^*$ is a quadratic residue in $\F_p$ if and only if $\lg{p}{q} = 1$. In other words,
$$\lg{q^*}{p} = \lg{p}{q}.$$

\begin{comment}
    \noindent\textbf{Proof of Proposition \ref{prop:qr2}}: In light of quadratic reciprocity, it remains to prove that $p^* = (-1)^{(p-1)/2}p$ is a square mod $q$ if and only if $p\equiv \pm a^2\pmod{4q}$ for some odd integer $a$. This is basically just the definition.

If $p\equiv 1\pmod{4}$, then $p^* = p$. If $p$ is a square mod $q$, then $p\equiv b^2\pmod{q}$ for some integer $b$. By Chinese remainder theorem, there exists an integer $a$ that is 1 mod 4 and $b$ mod $q$. So $p\equiv a^2\pmod{4q}$. Since $p$ is odd and $4q$ is even, we have $a$ is odd. Conversely, if $p\equiv \pm a^2\pmod{4q}$ for some odd integer $a$. If $p\equiv -a^2\pmod{4q}$, then $p\equiv -a^2\pmod{4}$ but $a^2\equiv p \equiv 1\pmod{4}$, which is impossible. So $p\equiv a^2\pmod{4q}$ and thus $p\equiv a^2\pmod{q}$.

The case for $p\equiv 3\pmod{4}$ is similar. \hspace{20pt}$\Box$
\end{comment}

We now consider $x^2 \equiv a\pmod{m}$ in general. By the Chinese Remainder Theorem, it suffices to consider the case when $m = p^k$ is the power of a prime $p$. It is an easy exercise to reduce to the case $p\nmid a$.

\begin{lemma}
    Suppose $p\mid a$. Then $x^2 \equiv a\pmod{p^k}$ has a solution if and only if $\nu_p(a)\geq k$ or if $\nu_p(a)$ is even and $$x^2\equiv a/p^{\nu_p(a)}\pmod{p^{k-\nu_p(a)}}$$ has a solution.
\end{lemma}

\begin{proof}
    Suppose $\nu_p(a) < k$ and $k\geq 2$. Suppose $c\in\Z$ such that $c^2\equiv a\pmod{p^k}$. Then $p\mid c^2 - a$ and so $p\mid c^2$. Since $p$ is a prime, we have $p\mid c$ and then from $p^2\mid c^2 - a$, we have $p^2\mid a$. So $\nu_p((c/p)^2 - a/p^2) \geq k - 2.$ In other words, $x^2\equiv a\pmod{p^k}$ has a solution if and only if $x^2\equiv a/p^2\pmod{p^{k-2}}$ has a solution. The desired result now follows by induction on $\nu_p(a)$.
\end{proof}

We now assume that $p\nmid a$. The punchline is that the question can be reduced to $m = p$ for $p$ odd, or to $m = 8$ when $p = 2$.

\begin{center}
    \add{Lecture 19 Wed 10/25}
\end{center}
\begin{theorem}\label{thm:hensel}
    (Hensel's lemma) Suppose $f(x)\in\Z[x]$. Let $p$ be a prime and let $\alpha\in \Z$. Suppose $$\nu_p(f(\alpha)) > 2\nu_p(f'(\alpha)).$$ Then for any $n\in\N$, there exists  $\alpha_n\in\Z$ such that
    \begin{enumerate}[(a)]
        \item $\nu_p(f(\alpha_n)) \geq \nu_p(f(\alpha)) + n-1$,
        \item $\nu_p(\alpha_n-\alpha) = \nu_p(f(\alpha))-\nu_p(f'(\alpha))$,
        \item $\nu_p(f'(\alpha_n)) = \nu_p(f'(\alpha))$.
    \end{enumerate} 
\end{theorem}

\begin{cor}
    Suppose $f(x)\in\Z[x]$. Let $p$ be a prime and let $\alpha\in \Z$. Suppose $f(\alpha)\equiv 0\pmod{p}$ and $p\nmid f'(\alpha)$. Then for any $n\in\N$, there exists $\alpha_n\in\Z$ such that $\alpha_n\equiv \alpha\pmod{p}$ and $f(\alpha_n)\equiv 0\pmod{p^n}.$
\end{cor}

\begin{cor}\label{cor:p2n}
    Let $p$ be an odd prime and let $a\in\Z$ such that $p\nmid a$. Suppose $x^2\equiv a\pmod{p}$ has a solution. Then $x^2\equiv a\pmod{p^n}$ has a solution for any $n\in\N$.
\end{cor}

\begin{proof}
    Consider $f(x) = x^2 - a \in\Z[x]$. Let $\alpha\in\Z$ be a solution to $x^2 \equiv a\pmod{p}$. Then we have $f(\alpha) = 0\pmod{p}$. Now $f'(\alpha) = 2\alpha$. Since $p\nmid a$, we have $p\nmid \alpha$. Since $p$ is odd, we have $p\nmid 2$. So $p\nmid f'(\alpha)$. Hence for any $n\in\N$, there exists $\alpha_n\in\Z$ such that $f(\alpha_n)\equiv 0\pmod{p^n}$, which is the same as $\alpha_n^2 \equiv a\pmod{p^n}.$
\end{proof}

\begin{cor}
    Let $a$ be an odd integer. Suppose $x^2\equiv a\pmod{8}$ has a solution. Then $x^2\equiv a\pmod{2^n}$ has a solution for any integer $n\geq 3$.
\end{cor}

\begin{proof}
    Consider $f(x) = x^2 - a \in\Z[x]$. Let $\alpha\in\Z$ be a solution to $x^2 \equiv a\pmod{8}$. Then we have $\nu_2(f(\alpha))\geq 3$. Now $f'(\alpha) = 2\alpha$. Since $a$ is odd, we have $\alpha$ is odd. So $\nu_2(f'(\alpha)) = 1$ which satisfies $\nu_2(f(\alpha)) > 2\nu_2(f'(\alpha))$.  Hence by Theorem \ref{thm:hensel}, for any integer $n\geq 3$, we have $n-2\geq 1$ and there exists $\alpha_{n-2}\in\Z$ such that $$\nu_2(f(\alpha_{n-2})) = \nu_2(f(\alpha)) + (n-2)-1 \geq n.$$
    In other words, $\alpha_{n-2}^2\equiv a\pmod{2^n}.$
\end{proof}

It is easy to check that the only odd quadratic residue mod $4$ is $1$, and the only odd quadratic residue mod $8$ is also $1$. Note that $x^2 \equiv 5\pmod{8}$ has no solution but $x^2 \equiv 5\pmod{4}$ does.

\vspace{5pt}
\noindent\textbf{Proof of Theorem \ref{thm:hensel}}: The important observation is that for any integers $a,m$, we have
$$f(a + m) \equiv f(a) + f'(a)m\pmod{m^2}.$$
Since both sides are linear in $f(x)$, it is enough to check it for $f(x) = x^n$, in which case $$f(a) + f'(a)m = a^n + na^{n-1}m\equiv (a+m)^n = f(a+m)\pmod{m^2}$$ follows from the binomial expansion for $(a+m)^n$.

We construct $\alpha_n$ by induction on $n$. When $n = 1$, we take $\alpha_1 = \alpha$. For $n\geq 2$, we define $$\alpha_n = \alpha_{n-1} - \left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p.$$
Here, for two integers $a,b$ with $\nu_p(a)\geq\nu_p(b)$, we use $[\frac{a}{b}]_p$ to denote any integer $c$ such that $\nu_p(a - bc) > \nu_p(a).$ (This is not standard notation!) To see such an integer always exist, we write $a = p^su$ and $b = p^tv$ where $p\nmid uv$ and $s\geq t$. Let $w$ be an integer such that $u\equiv vw\pmod{p}$. Then $p\mid u - vw.$ We then take $[\frac{a}{b}]_p = p^{s-t}w$.  Note that $\nu_p([\frac{a}{b}]_p) = \nu_p(a) - \nu_p(b)$. We now prove inductively that
\begin{itemize}
    \item $\nu_p(f(\alpha_n)) > \nu_p(f(\alpha_{n-1}))$
    \item $\nu_p(f'(\alpha_n)) = \nu_p(f'(\alpha))$
    \item $\nu_p(f(\alpha_n))>2\nu_p(f'(\alpha_n))$.
\end{itemize}
Indeed, we have
$$f(\alpha_n) \equiv f(\alpha_{n-1}) - f'(\alpha_{n-1})\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p\pmod{\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p^2}$$
where
$$\nu_p\left(f(\alpha_{n-1}) - f'(\alpha_{n-1})\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p\right) > \nu_p(f(\alpha_{n-1}))$$
and
$$\nu_p\left(\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p^2\right) = 2\nu_p(f(\alpha_{n-1})) - 2\nu_p(f'(\alpha_{n-1})) > \nu_p(f(\alpha_{n-1}))$$
by induction. This proves $\nu_p(f(\alpha_n)) > \nu_p(f(\alpha_{n-1})).$ For the derivative, we have
$$f'(\alpha_n) \equiv f'(\alpha_{n-1}) - f''(\alpha_{n-1})\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p\pmod{\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p^2}$$
where $$\nu_p\left(\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p\right) = \nu_p(f(\alpha_{n-1})) - \nu_p(f'(\alpha_{n-1})) > \nu_p(f'(\alpha_{n-1})).$$
This proves $\nu_p(f'(\alpha_n)) = \nu_p(f'(\alpha_{n-1})) = \nu_p(f'(\alpha))$ and
$$\nu_p(f(\alpha_n)) > \nu_p(f(\alpha_{n-1})) > 2\nu_p(f'(\alpha_{n-1})) = 2\nu_p(f'(\alpha_n)).$$
It now follows (by another easy induction) from $\nu_p(f(\alpha_n))\geq\nu_p(f(\alpha_{n-1}))+1$ that $$\nu_p(f(\alpha_n))\geq\nu_p(f(\alpha)) + n-1$$
and
$$\alpha_n - \alpha = -\left[\frac{f(\alpha_1)}{f'(\alpha_1)}\right]_p-\left[\frac{f(\alpha_{2})}{f'(\alpha_{2})}\right]_p-\cdots-\left[\frac{f(\alpha_{n-1})}{f'(\alpha_{n-1})}\right]_p$$
has the same valuation as the first term.  $\Box$

If we go through the above proof, it is not hard to see that our construction was pretty much forced. In particular, we have the following uniqueness result.

\begin{proposition}
    (Uniqueness of Hensel's lemma) Suppose $f(x)\in\Z[x]$. Let $p$ be a prime and let $\alpha\in \Z$. Suppose $\nu_p(f(\alpha)) > 2\nu_p(f'(\alpha)).$ For any $n\in\N$, let $\alpha_n$ be constructed as above. Then if $\beta\in\Z$ such that
    \begin{enumerate}[(a)]
        \item $\nu_p(f(\beta)) \geq \nu_p(f(\alpha)) + n-1$,
        \item $\nu_p(\beta-\alpha) \geq \nu_p(f(\alpha))-\nu_p(f'(\alpha))$.
    \end{enumerate} 
    Then $$\nu_p(\beta-\alpha_n)\geq \nu_p(f(\alpha)) - \nu_p(f'(\alpha)) + n - 1.$$
\end{proposition}

\begin{proof}
    Write $\beta = \alpha_n + m$. Then by condition (b) for $\beta$ (and for $\alpha_n)$, we have
    $$\nu_p(m)  = \nu_p((\beta-\alpha)-(\alpha_n-\alpha))\geq \nu_p(f(\alpha)) - \nu_p(f'(\alpha)) > \nu_p(f'(\alpha)).$$ %Then
%$$f(\beta) \equiv f(\alpha_n) + f'(\alpha_n)m \pmod{m^2}.$$
Let $a = f(\beta) - f(\alpha_n)$, which we know has valuation at least $\nu_p(f(\alpha)) + n-1$. Let $u = f'(\alpha_n)$ which we know has the same valuation as $f'(\alpha)$. Then from $f(\beta) \equiv f(\alpha_n) + f'(\alpha_n)m \pmod{m^2}$, we have $$m^2\mid a - um.$$
Hence $$\nu_p(a - um) \geq 2\nu_p(m) > \nu_p(f'(\alpha)) + \nu_p(m) = \mu_p(um).$$ So
$$\nu_p(a) = \nu_p(a - um + um) = \nu_p(um) = \nu_p(f'(\alpha)) + \nu_p(m).$$
Hence
$$\nu_p(m) = \nu_p(a) - \nu_p(f'(\alpha)) \geq \nu_p(f(\alpha)) - \nu_p(f'(\alpha)) + n - 1,$$
as desired.
\end{proof}

\begin{cor}
    Suppose $f(x)\in\Z[x]$. Let $p$ be a prime and let $\alpha\in \Z$. Suppose $f(\alpha)\equiv 0\pmod{p}$ and $p\nmid f'(\alpha)$. Then for any $n\in\N$, there exists $\alpha_n\in\Z$, unique mod $p^n$, such that $\alpha_n\equiv \alpha\pmod{p}$ and $f(\alpha_n)\equiv 0\pmod{p^n}.$
\end{cor}

\vspace{5pt}
\noindent\textbf{Example}: Consider $f(x) = (x^2 - 2)(x^2 - 17)(x^2 - 34)\in\Z[x]$. Then $f(x) = 0$ has no solution in $\Z$. We claim that it has a solution in $\Z/m\Z$ for any $m\in\N$. By the Chinese Remainder Theorem, it suffices to consider when $m = p^k$ is a power of $p$. If $p\neq 2,17$, then at least one of $2, 17, 34$ is a quadratic residue mod $p$ as
$$\lg{34}{p}\lg{2}{p}\lg{17}{p} = \lg{2}{p}^2\lg{17}{p}^2 = 1$$
and by Corollary \ref{cor:p2n} is a quadratic residue mod $p^k$. If $p = 17$, then $2 = 6^2$ is a quadratic residue mod $17$ and also mod $17^k$. Finally, since $17\equiv 1\pmod{8}$, it is a quadratic residue mod $8$ and so is also mod $2^k$.

\v
\noindent\textbf{Remark}: It is a fairly nontrivial fact that if $f(x)\in\Z[x]$ is irreducible (in $\Q[x]$), then there are infinitely many primes $p$ for which $f(x)$ has no roots mod $p$. Theorem \ref{thm:deg2} gives a proof of this in the degree $2$ case. Then along with Exercise 11.\ref{ex:11.7}, we see that there doesn't exist any monic polynomial $f(x)\in\Z[x]$ of degree at most $4$ that has roots mod $m$ for every integer $m$ but no roots in $\Z$. In HW 7 P1, you prove that the degree $5$ polynomial $(x^3 + x + 1)(x^2 + 31)$ satisfies this condition. An irreducible polynomial in $\Z[x]$ can be reducible mod $p$ for all primes $p$. As we will learn soon, most cyclotomic polynomials are reducible mod every prime but are irreducible in $\Z[x]$.

\begin{center}
    \add{Lecture 20 Fri 10/27}
\end{center}

\begin{theorem}\label{thm:deg2}
    Let $a\in\N$. If $x^2 \equiv a\pmod{q}$ has a solution for every prime $q$, then $a$ is a perfect square.
\end{theorem}

\begin{proof}
    Suppose for a contradiction that $a$ is not a perfect square. We find (infinitely many) prime $q$ such that $\lg{a}{q} = -1$. Suppose $a=2^{a_0}p_1^{a_1}\cdots p_r^{a_r}$ where each $a_i\geq1$ and $p_1,\ldots,p_r$ are distinct odd primes with $r\geq 1$. We know not all of the $a_i$'s are even. If $a_0$ is odd and $a_1,\ldots,a_r$ are all even, then by Dirichlet's theorem on primes in arithmetic progressions, there exist (infinitely many) primes $q$ that is $3$ mod $8$ and larger than $p_1,\ldots,p_r$. Then $$\lg{a}{q} = \lg{2}{q} = -1.$$
    Suppose now $a_1,\ldots,a_r$ are not all even. By renaming, suppose $a_r$ is odd. Let $s$ be a quadratic non-residue mod $p_r$. By the Chinese Remainder Theorem, there exists $b\in\N$ such that
    \begin{eqnarray*}
        b&\equiv&1\pmod{8}\\
        b&\equiv&1\pmod{p_1\cdots p_{r-1}}\\
        b&\equiv&s\pmod{p_r}
    \end{eqnarray*}
    By Dirichlet's theorem on primes in arithmetic progressions, there exist (infinitely many) primes $q\equiv b\pmod{8p_1\cdots p_r}$. Then $q$ also satisfies the above congruences. So
    $$\lg{2}{q} = 1,\qquad\lg{p_i}{q} = \lg{q}{p_i} = \begin{cases}
        1&\mbox{if }i=1,\ldots,r-1\\
        -1&\mbox{if }i = r.
    \end{cases}\qquad\Rightarrow\qquad \lg{a}{q} = -1.$$
    Hence $x^2\equiv a\pmod{q}$ has no solution.
\end{proof}

If we don't use Dirichlet's theorem, we could factor $b$ as $q_1\cdots q_t$ into a product of possibly equal odd primes. Then we can generalize the Legendre symbol into the Jacobi symbol
$$\lg{a}{b}:= \prod_{j=1}^t\lg{a}{q_j}.$$
In HW7, you will prove the same quadratic reciprocity laws for the Jacobi symbol and so the same calculation above shows $$\lg{a}{b} = -1,$$
which implies that $a$ is not a quadratic residue mod $b$.

\v
\noindent\textbf{Remark}: Using the quadratic reciprocity law
$$\lg{a}{b}\lg{b}{a} = (-1)^{\frac{a-1}{2}\frac{b-1}{2}},$$
one can give a very beautiful proof of the following problem (IMO 2022 shortlist N8): 
\begin{itemize}
    \item For any positive integer $n$, prove that $2^n + 65\nmid 5^n - 3^n$.
\end{itemize}
Suppose for a contradiction that $2^n + 65\mid 5^n - 3^n$. Since $3\nmid 5^n - 3^n$ and $2^n + 65 \equiv (-1)^n + 2\pmod{3}$, we see that $n$ is odd and so $2^n + 65 \equiv 1\pmod{3}$. Then since $5^n\equiv3^n\pmod{2^n + 65}$, we have
$$\lg{5}{2^n + 65} = \lg{5^n}{2^n + 65} = \lg{3^n}{2^n + 65} = \lg{3}{2^n + 65}.$$
Since $n$ is odd and the statement is immediate when $n = 1$, we may assume $n\geq 3$ and so $2^n + 65\equiv 1\pmod{4}$. Then, we have
$$\lg{5}{2^n + 65} = \lg{2^n + 65}{5} = \lg{2^n}{5} = \lg{2}{5} = -1$$
but
$$\lg{3}{2^n + 65} = \lg{2^n + 65}{3} = \lg{1}{3} = 1.$$
Contradiction. $\Box$

\v
\noindent\textbf{Remark}: There is another related IMO shortlist problem (2007 N2) which follows from:
\begin{itemize}
    \item Let $a,n\in\N$. If $x^n\equiv a\pmod{a^2}$ has a solution, then $a$ is a perfect $n$-th power.
\end{itemize}
Let $c\in\Z$ such that $a^2\mid c^n - a$. Let $p$ be any prime divisor of $a$. Then we have
$$\nu_p(c^n - a) \geq 2\nu_p(a) > \nu_p(a).$$
Hence $$\nu_p(a) = \nu_p(c^n) = n\nu_p(c).$$
This implies that $a$ is an $n$-th power. $\Box$

\vspace{5pt}
In our proof of the quadratic reciprocity, the value of the sum
$$\sum_{m\in\F_q}\lg{m(t-m)}{q}$$
was very important. What about sums of the form
$$\sum_{m\in\F_q}\lg{am^2 + bm + c}{q}$$
in general, where $a,b,c\in\Z$?

\begin{theorem}
    Let $q$ be an odd prime. Let $a,b,c\in\Z$. Then
    $$\sum_{x\in\F_q}\lg{ax^2 + bx + c}{q} = \begin{cases}
        -\displaystyle\lg{a}{q}&\mbox{ if }q\nmid b^2 - 4ac\\
        \displaystyle(q-1)\lg{a}{q}&\mbox{ if }q\mid b^2 - 4ac,q\nmid a.\\
        \displaystyle q\lg{c}{q}&\mbox{ if }q\mid b^2 - 4ac,q\mid a.
    \end{cases}$$
    As a consequence, if $q\nmid b^2 - 4ac$, then $ax^2 + bx + c$ can be a quadratic residue in $\F_q$ for at most $(q+3)/2$ values of $x$, which happens when $ax^2 + bx + c$ is reducible.
\end{theorem}

\begin{proof}
    If $q\nmid a$, then we can complete the square to get
    $$ax^2 + bx + c = a\Big(x + \frac{b}{2a}\Big)^2 - \frac{b^2 - 4ac}{4a^2}.$$
    If further $q\mid b^2 - 4ac$, then $\displaystyle\lg{ax^2 + bx + c}{q} = \lg{a}{q}$ when $x\neq -b/2a$ and is $0$ when $x = -b/2a$.

    If $q\mid a$, then we note that $bx + c$ takes all values in $\F_q$ if $b \neq 0$ and is constant equaling $c$ if $b = 0$. In the first case, the sum is $0$ and in the second case, the sum is $q\lg{c}{q}$.

    The only interesting case is when $q\nmid a$ and $q\nmid b^2 - 4ac$. We have the following equality in $\F_q$:
    $$\sum_{x\in\F_q}\lg{ax^2 + bx + c}{q} = \sum_{x\in\F_q}(ax^2 + bx + c)^{(q-1)/2}.$$
    In HW 6, you proved that $$\sum_{x\in\F_q}x^k = \begin{cases}
        0&\mbox{ if }k=1,\ldots,q-2\\
        -1&\mbox{ if }k = q-1.
    \end{cases}$$
    It is also clear that $\sum_{x\in\F_q}1 = q = 0$. Hence when we expand $(ax^2 + bx + c)^{(q-1)/2}$ and sum over $x$, only the sum of $a^{(q-1)/2}x^{q-1}$ survives to give $-a^{(q-1)/2}.$ Hence in $\F_q$, we have
    $$\sum_{x\in\F_q}\lg{ax^2 + bx + c}{q} = -a^{(q-1)/2} = -\lg{a}{q}.$$
    In other words, as integers, they are congruent mod $q$. Note that the left hand side is a sum of $q$ numbers of the form $0,-1,1$ and the right hand side is $\pm 1$. So the only way for them to be not equal is for the left hand side to be $q-1$ or $-(q-1)$. This can only happen when $ax^2 + bx + c=0$ for exactly one $x\in\F_q$, and is a quadratic residue/non-residue for all other $x\in\F_q$. This is impossible because a quadratic has exactly one root if and only if its discriminant $b^2 - 4ac = 0$, contradicting the assumption that $q\nmid b^2 - 4ac.$
\end{proof}

\begin{cor}
    Let $q\geq5$ be a prime. Let $a,b,c\in\Z$ such that $q\nmid b^2 - 4ac$. Then $ax^2 + bx + c$ cannot be square for $(q+5)/2$ consecutive integers $x$.
\end{cor}

The weaker result where $(q+5)/2$ is replaced by $2q - 1$ is on the 1991 IMO shortlist. The IMO problem is also true for $q = 3$, while the polynomial $2(x-1)(x-2)$ takes square value for $(q+5)/2=4$ consecutive integers $x = 0,1,2,3$. It is not hard to give a proof in the $q = 3$ case directly. Let $f(x) = ax^2 + bx + c$ with $3\nmid b^2 - 4ac$. Suppose $f(x)$ takes five consecutive square values. Then we can find $r,s\in\Z$ that are not congruent mod $3$ and a quadratic non-residue $\alpha$ such that $$f(x) = \alpha(x - r)(x - s) + 3g(x)$$
and $f(r)$ and $f(r+3)$ are squares, for some $g(x)\in\Z[x]$. Then $3g(r)$ is a square implying that $3\mid g(r)$ and so $3\mid g(r+3)$. Then $$\nu_3(f(r+3)) = \nu_3(3\alpha(r+3-s) + 3g(r+3)) = 1.$$
Hence $f(r+3)$ is not a square.

\vspace{5pt}
One may ask what happens in the case of a cubic sum. It is a theorem in algebraic geometry that
$$\left|\sum_{x\in\F_q} \lg{ax^3 + bx^2 + cx + d}{q}\right| \leq 2\sqrt{q},$$
when $ax^3 + bx^2 + cx + d$ has no repeated roots in $\F_q$. The connection to algebraic geometry is in the relation of this sum to the number of $\F_q$-solutions to $$y^2 = ax^3 + bx^2 + cx + d$$
which you might recognize as an elliptic curve!

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Use Exercise 9.\ref{exer:9.8} to prove that for a prime $p>3$, we have $-3$ is a quadratic residue mod $p$ if and only if $p\equiv 1\pmod{3}$.
    \item Let $p\geq 3$ be a prime and let $a,b$ be two primitive elements mod $p$. Prove that $ab$ is not primitive.
    \solu{Represent $b$ with a power of $a$, then show that $ab$ is a square.}
    \item Is $91$ a quadratic residue mod $253$?\solu{No.}
    \item Prove that the polynomial $x^8 - 16$ has a root mod $p$ for all primes $p$.
    
    %\item Prove the following more explicit version of Hensel's lemma. Suppose $f(x)\in\Z[x]$ and $p$ is a prime. Suppose $a_1\in\Z$ such that $f(a_1)\equiv 0\pmod{p}$ and $p\nmid f'(a_1)$. Then the sequence defined by $$a_{k+1} \equiv a_k - f(a_k)/f'(a_k)\pmod{p^{k+1}},\qquad\mbox{for }k\geq1$$
    %satisfies $f(a_k)\equiv 0\pmod{p^k}$ for all $k\geq 1$.
    \item Find all solutions to $x^4 + x^3 + 2x^2 + x\equiv 13\pmod{343}$.\solu{$x=4,205$}
    \item Find all solutions to $x^3 - 2x - 1\equiv 0\pmod{125}.$\solu{$x=-1$}
    \item Suppose $a,b\in\N$ are positive integers, neither of which is a perfect square. Prove that there exists a prime $q$ such that $a$ and $b$ are both quadratic non-residues mod $q$. Conclude that there does not exist a degree $4$ reducible polynomial in $\Z[x]$ that has roots mod $m$ for every positive integer $m$ but has no roots in $\Z$. \label{ex:11.7}
    \item Find an integer $n$ such that $n^5\equiv 2\pmod{3^{10}}.$\solu{$x=23$}
    \item Let $q$ be an odd prime and let $a,b,c\in\Z$ with $q\nmid b^2 - 4ac$. Compute $$\sum_{x\in\F_q}\sum_{y\in\F_q}\lg{ax^2 + bxy + cy^2}{q}.$$
\end{enumerate}

\begin{center}
    \add{Lecture 21 Mon 10/30}
\end{center}
\section{Schur's Theorem on $mk + a$}

We saw in HW 3 Problem 2 that for any non-constant polynomial $f(x)\in\Z[x]$, there are infinitely many primes that divide $f(n)$ for some $n\in\Z$. That was a theorem of Schur, who also proved in the same work:

\begin{theorem}
    Suppose $a,m\in\N$ such that $a^2\equiv 1\pmod{m}$. Then there exists $f(x)\in\Z[x]$ such that there infinitely many primes congruent to $a$ mod $m$ that divide $f(n)$ for some $n\in\Z$.
\end{theorem}

More precisely:

\begin{theorem}\label{thm:a1}
    Suppose $a,m\in\N$ such that $a^2\equiv 1\pmod{m}$. Then there exists $f(x)\in\Z[x]$ with positive leading coefficient and a nonzero integer $N$ such that
    \begin{enumerate}[(a)]
        \item If $p$ is a prime divisor of $f(n)$ for some integer $n$, then $p\mid N$ or $p\equiv 1$ or $a$ mod $m$.
        \item If $p$ is a prime congruent to $a$ mod $m$ and coprime to $N$, then there exists $b\in\Z$ such that $\nu_p(f(b)) = 1$.
        \item All prime divisors of $f(0)$ are congruent to $1$ mod $m$, and $f(0) > 0$.
    \end{enumerate}
\end{theorem}

In other words, Schur proved that there is a Euclidean polynomial for $a$ mod $m$ if $a^2\equiv 1\pmod{m}$. From such a polynomial, we can prove the infinitude of primes congruent to $a$ mod $m$, assuming that there is at least one coprime to $N$.
\begin{theorem}\label{thm:fa1}
    Suppose $a^2\equiv 1\pmod{m}$ and $a\not\equiv 1\pmod{m}$. Suppose there exists a prime $q$ congruent to $a$ mod $m$ that is coprime to the integer $N$ in Theorem \ref{thm:a1}. Then there are infinitely many such primes.
\end{theorem}

It is worth noting that Schur's result does not prove the infinitude of primes of the form $mk + a$. We first give a proof of Theorem \ref{thm:fa1} from Theorem \ref{thm:a1}. We recall the following nice property about polynomials with integer coefficients.

\begin{lemma}
    Suppose $f(x)\in\Z[x]$ and $c_1,c_2,k\in\Z$. If $c_1\equiv c_2\pmod{k}$, then $f(c_1)\equiv f(c_2)\pmod{k}$
\end{lemma}

\begin{proof}
    This is simply the statement $f(c + k\Z) = f(c) + k\Z$ in $\Z/k\Z$ for any $c\in\Z$.
\end{proof}

\vspace{5pt}
\noindent\textbf{Proof of Theorem \ref{thm:fa1} from Theorem \ref{thm:a1}}: We construct our infinite sequence of pairwise coprime integers each having a prime divisor of the form $a$ mod $m$. Let $k$ be large even integer such that $f(n) > q$ for all $n \geq mN^k$. This is possible because $f(x)$ has positive leading coefficient. Let $b\in\Z$ with $\nu_q(f(b)) = 1$.

Let $a_1 = 1$. Since $q$ is coprime with $a_1$, $m$ and $N$, we see that $q$ is coprime to $mN^ka_1$ and so $q^2$ is also coprime to $mN^ka_1$. Let $c_1$ be a positive integer such that $c_1mN^ka_1\equiv b\pmod{q^2}$. Then $$f(c_1mN^ka_1)\equiv f(b)\pmod{q^2}.$$ Since $\nu_q(f(b)) = 1$, we also have $\nu_q(f(c_1mN^ka_1)) = 1$. We let $a_2 = f(c_1mN^ka_1)/q$ so that $a_2$ is coprime with $q$. We now repeat this process. More generally for any $n\geq 1$, suppose we have already defined $a_1,\ldots,a_n$ inductively to all be coprime with $q$, then $q^2$ is coprime with $mN^ka_1\cdots a_n$. Let $c_n$ be a positive integer such that $$c_nmN^ka_1\cdots a_n\equiv b\pmod{q^2}$$ and we define $$a_{n+1} = \frac{f(c_nmN^ka_1\cdots a_n)}{q}.$$
Note that $f(c_nmN^ka_1\cdots a_n)\equiv f(0)\equiv 1\pmod{m}$ and so $a_{n+1}\equiv q^{-1} \equiv a\pmod{m}$. Suppose now $p$ is a prime divisor of $a_{n+1}$. Then $p\mid f(c_nmN^ka_1\cdots a_n)$. If $p\mid N$, then from $f(c_nmN^ka_1\cdots a_n)\equiv f(0)\pmod{N}$, we get $p\mid f(0)$ and so $p$ is congruent to $1$ or $a$ mod $m$. If $p\nmid N$, then we know automatically that $p$ is congruent to $1$ or $a$ mod $m$. Hence all the primes divisors of $a_{n+1}$ are congruent to $1$ or $a$ mod $m$. Since $a_{n+1}\not\equiv 1\pmod{m}$, we see that not all of the prime divisors of $a_{n+1}$ are $1$ mod $m$. Hence $a_{n+1}$ has a prime divisor of the form $a$ mod $m$. (Note that $a_{n+1}$ has a prime divisor because $a_{n+1}\geq 2$. This is the purpose of the integer $k$.)

Finally for $i < j$, we have $a_i\mid c_{j-1}ma_1\cdots a_{j-1}$ and since $\gcd(a_i,q) = 1$, we have 
$$\gcd(a_i,a_j) = \gcd(a_i,qa_j) = \gcd(a_i,f(c_{j-1}ma_1\cdots a_{j-1})) = \gcd(a_i,f(0)).$$
Since all the prime divisors of $f(0)$ are congruent to $1$ mod $m$, we see that $a_i$ and $a_j$ do not share a prime divisor that is congruent to $a$ mod $m$.
$\Box$

\vspace{5pt}
\begin{comment}
    The condition $\nu_p(f(b))$ is something we haven't seen before. Suppose we have $p^2\mid f(b)$ instead. It is easy to check that
$$f(b + p) \equiv f(b) + pf'(b) \equiv pf'(b)\pmod{p^2}$$
since both sides are linear and it suffices to check it when $f(x) = x^n$. So if we have $p\nmid f'(b)$, then $\nu_p(f(b+p)) = 1$. We can make this happen by requiring that $f(x)$ and $f'(x)$ have no common roots in $\F_p$. We will learn about the \textbf{discriminant} $\Delta$ of $f(x)$ or more generally the \textbf{resultant} of two polynomials $f(x), g(x)$. The discriminant of a polynomial $f(x)$ is $0$ if and only if $f(x)$ and $f'(x)$ share a common factor. Hence if we make sure that $f(x)$ has no repeated roots in $\C$, then its discriminant is nonzero, and so for primes $p$ large enough, 
\end{comment}

We give the construction of $f(x)$ first. Recall that when we considered the polynomial $f(x) = x^3 + x^2 - 2x - 1$ and proved that if $p$ is a prime divisor of $f(n)$, then $p=7$ or $p\equiv\pm1\pmod{7}$, we are essentially taking the polynomial in $\Q[x]$ of the smallest degree that has $\zeta_7 + \zeta_7^{-1}$ as a root. In fact, we have the factorization
$$f(x) = (x - (\zeta_7 + \zeta_7^{-1}))(x - (\zeta_7^2 + \zeta_7^{-2}))(x - (\zeta_7^4 + \zeta_7^{-4})).$$
Note that we don't ``need'' $\zeta_7^j + \zeta_7^{-j}$ for $j = 3, 5, 6$ because they are the same as when $j = 4, 2, 1$ respectively.
To say $p\mid f(n)$ is similarly to say that one of $\zeta_7^j + \zeta_7^{-j}$, which a priori lies in $\F_{p^6}$ if $p\neq 7$, actually lies in $\F_p$ for some $j = 1,2,4.$ We can check whether it lies in $\F_p$ by comparing
$$(\zeta_7^j + \zeta_7^{-j})^p = \zeta_7^{pj} + \zeta_7^{-pj}\qquad\mbox{with}\qquad\zeta_7^j + \zeta_7^{-j}.$$
As complex numbers, it is easy to see that they are equal if and only if $p\equiv \pm1\pmod{7}$. One then expects the same is true in $\F_p$, at least for all but finitely many primes $p$. In the general case of $a$ mod $m$, it is then natural to take the polynomial in $\Q[x]$ of the smallest degree that has $\zeta_m + \zeta_m^a$ as a root, by taking a product of $(x - (\zeta_m^j + \zeta_m^{ja}))$ for half of the $j\in(\Z/m\Z)^\times$, since the other half will just produce the same numbers.

\begin{lemma}\label{lem:mquot}
    There exists a subset $S\subseteq(\Z/m\Z)^\times$ such that $(\Z/m\Z)^\times$ is the disjoint union of $S$ with $Sa = \{ja\colon j\in S\}.$
\end{lemma}

\begin{proof}
    (Exercise) Define a relation on elements of $(\Z/m\Z)^\times$ by $j\sim k$ if $j = k$ or $j = ak$. Check this is an equivalence relation so that $(\Z/m\Z)^\times$ is a disjoint union of equivalence classes of the form $[j] = \{j, ja\}$. Pick one element from each equivalence class and form $S$. We will give a more intrinsic meaning to $S$ using the notion of \textbf{quotient groups} next time. 
\end{proof}

Unlike the case of $-1$, it is hard to check when $\zeta_m^j + \zeta_m^{ja} = \zeta_m^k + \zeta_m^{ka}$ even in $\C$, but it is easy to check when 
$$\zeta_m^j + \zeta_m^{ja} = \zeta_m^k + \zeta_m^{ka}\qquad\mbox{and}\qquad\zeta_m^k\zeta_m^{ka} = \zeta_m^j\zeta_m^{ja}$$
since this implies that 
$$(x - \zeta_m^k)(x - \zeta_m^{ka}) = (x - \zeta_m^j)(x - \zeta_m^{ja}) \in \C[x].$$
Setting $x = \zeta_m^k$ then gives $k = j$ or $k = ja$.

\begin{lemma}
    There exists an integer $u$ such that the numbers $$\eta_j = (mu - \zeta_m^j)(mu - \zeta_m^{ja}) \in \C$$
    for $j\in S$, are all distinct.
\end{lemma}

\begin{proof}
    In order for $\eta_j = \eta_k$ when $j\neq k$, we have $$mu(\zeta_m^j + \zeta_m^{ja} - \zeta_m^k - \zeta_m^{ka}) = \zeta_m^k\zeta_m^{ka} - \zeta_m^j\zeta_m^{ja}.$$
    When viewed as an equation in $u$, this has at most $1$ solution unless
    $$\zeta_m^j + \zeta_m^{ja} = \zeta_m^k + \zeta_m^{ka}\qquad\mbox{and}\qquad\zeta_m^k\zeta_m^{ka} = \zeta_m^j\zeta_m^{ja},$$
    in which case we have either $k = j$ or $k = ja$. Since $j,k\in S$, we have $k = j$. Contradiction. Hence, we have the desired $u$ by removing finitely many solutions from infinitely many integers.
\end{proof}

We define $$f(x) = \prod_{j\in S}(x - \eta_j) = \prod_{j\in S}\Big(x - (mu - \zeta_m^j)(mu - \zeta_m^{ja})\Big).$$
Note that
$$f(0) = (-1)^{|S|}\prod_{j\in S}(mu - \zeta_m^j)(mu - \zeta_m^{ja}) = (-1)^{|S|}\prod_{j\in (\Z/m\Z)^\times}(mu - \zeta_m^j) = (-1)^{|S|}\Phi_m(mu),$$
all of whose prime divisors are $1$ mod $m$. 

We note that for $m\geq 3$, the cyclotomic polynomial $\Phi_m(x)$ has no real roots and thus is always positive since its leading coefficient is positive. So $\Phi_m(mu) >0$. If $|S|$ is even, we have $f(0)>0$. If $|S|$ is odd, since $f(x)$ has degree $|S|$, we may take $-f(-x)$.

To prove that $f(x)\in\Z[x]$ and the divisibility properties, we need to learn more about groups and fields.

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Let $m$ be a positive integer. Give a formula for the number of solutions (mod $m$) to $x^2\equiv 1\pmod{m}$.
    \solu{$2^{k+\min(a-1,2)}$ where $k$ is the number of distinct odd prime factors of $m$, and $a$ is the number of factor 2.}
    \item Factor $x^3 - 3x - 1$ in $\C[x]$. (Recall that this polynomial is used to prove the infinitude of primes congruent to $8$ mod $9$.)
    \solu{$(x-(\zeta_{18}^1+\zeta_{18}^{-1}))(x-(\zeta_{18}^5+\zeta_{18}^{-5}))(x-(\zeta_{18}^7+\zeta_{18}^{-7}))$}
    \item How many ways are there to pick the set $S$ in Lemma \ref{lem:mquot}?
    \solu{$2^{\frac{\phi(m)}{2}}$}
\end{enumerate}

\begin{center}
    \add{Lecture 22 Wed 11/01}
\end{center}

\section{Group Theory}

A \textbf{group} is a set $G$ equipped with one binary operation, one unary operation and one nullary operation:
$$(a,b)\mapsto ab:G\times G\rightarrow G\qquad a\mapsto a^{-1}:G\rightarrow G, \qquad e\in G$$
such that for any $a,b,c\in G$,
\begin{enumerate}[(a)]
    \item (Associative) $a(bc) = (ab)c$;
    \item (Multiplicative identity) $a\cdot e = a$ and $a\cdot a^{-1} = e$.
\end{enumerate}
With a little bit of work, one can prove that $e\cdot a = a$ and $a^{-1}\cdot a = e$. If $ab = ba$ for all $a,b\in G$, we say $G$ is an \textbf{abelian} group. All the groups that we will encounter in this class are abelian groups.

\vspace{5pt}
\noindent\textbf{Examples}:
\begin{enumerate}
    \item The group of units $R^\times$ of a commutative ring $R$ is an abelian group with the multiplication, inversion and $1$ from the ring $R$.
    \item The additive group of a ring $R$, where we forget about multiplication and use addition as the binary operation, negation as inversion, and $0$ as $e$, is an abelian group.
    \item The additive group of the ring $\Z/m\Z$ for $m\in\N$, is called the \textbf{cyclic} group of order $m$, sometimes denoted $C_m$.

    The \textbf{order} of the group $G$ is the size of $G$. The order $o(g)$ of an element $g\in G$ is the smallest positive integer $d$ such that $g^d = e$. The cyclic group of order $m$ is the group with an element $g$ of order $m$, so that $G = \{e, g, g^2,\ldots, g^{m-1}\}$. The group of units $\F_{p^n}^\times$ of a finite field is cyclic of order $p^n - 1$.

    The same argument used to prove that $a^{|R^\times|} = 1$ and $o(a)\mid|R^\times|$ can be used to prove the following result in the case of abelian groups.

    \begin{proposition}
        Let $G$ be a finite group of order $m$. Then for any $g\in G$, $g^{|G|} = e$ and so $o(g)\mid |G|.$ As a consequence, every finite group of prime order is cyclic.
    \end{proposition}

    To prove this for non-abelian groups, we introduce the notion of a \textbf{subgroup} of $G$, which is a subset $H$ of $G$ closed under the operations of $G$. That is, it is closed under multiplication, inversion, and contains the identity element. The subgroup generated by an element $g$ is $\langle g\rangle = \{g^n\colon n\in\Z\}$. If $g$ has order $d$, then this is just $\{e,g,\ldots,g^{d-1}\}.$

    In the example of $(\Z/m\Z)^\times$, the coset $a+m\Z$ where $a^2\equiv 1\pmod{m}$ and $a\not\equiv 1\pmod{m}$ is an element of order $2$. It then generates a subgroup, $\langle a\rangle$, of order $2$. In HW 9, you will discover when $(\Z/m\Z)^\times$ is cyclic. In this class, we will only focus on $C_m$ and $(\Z/m\Z)^\times$. 

    Given any subgroup $H$ of $G$ and an element $g\in G$, we can define the left coset of $H$ containing $g$ as $gH = \{gh\colon h\in H\}$. Two left cosets $g_1H = g_2H$ if and only if $g_1\in g_2H$ if and only if $g_2^{-1}g_1\in H$. It is easy to check that this defines an equivalence relation. Hence $G$ is a disjoint union of left cosets of $H$. If $G$ (and $H$) is finite, then all the left cosets of $H$ have the same size and we have proved that $|H|$ divides $|G|$. Taking $H = \langle g\rangle$ proves that $o(g)\mid |G|$. 

    We can define the quotient $G/H$ as the set of left cosets of $H$. To define a group structure on $G/H$ by $g_1H\cdot g_2H = (g_1g_2)H$, we need $H$ to be a \textbf{normal} subgroup: for any $g\in G$ and any $h\in H$, we have $ghg^{-1}\in H$. When $G$ is abelian, $ghg^{-1} = h$ and so every subgroup is normal. The set $S$ we saw in Lemma \ref{lem:mquot} is basically $(\Z/m\Z)^\times/\langle a\rangle.$

    Group homomorphisms are defined just like ring homomorphisms. Kernels of group homomorphisms are normal subgroups and we have the first isomorphism theorem for groups as well.

    \item Traditionally, groups arise as the group of symmetries of certain objects. For example, the symmetric group $S_n$ is the set of bijections from $\{1,2,\ldots,n\}$ to itself, with composition as the binary operation, inverse as inversion, and the identity map as $e$. This is an non-abelian group when $n\geq 3$.

    We are more interested in the group $\Aut(E)$ of ring isomorphisms from a field $E$ to itself. These kinds of isomorphisms are called \textbf{automorphisms}. If $E$ is a field of containing another field $F$, we write $\Aut_F(E)$ for the subgroup of $\Aut(E)$ consisting of automorphisms that act as identity on $F$.

    For example, what is $\Aut_\R(\C)$? We know that every complex number is of the form $a + bi$ for some $a,b\in\R$. If $\sigma\in\Aut_\R(\C)$, then $$\sigma(a + bi) = \sigma(a) + \sigma(b)\sigma(i) = a + b\sigma(i).$$
    Now since $i^2 + 1 = 0$, we can apply $\sigma$ to both sides to get $$\sigma(i)^2 + 1 = 0.$$
    Hence $\sigma(i) = i$ or $\sigma(i) = -i$. In other words, $\Aut_\R(\C)$ consists of at most two elements, the identity map and complex conjugation. It is easy to check that complex conjugation is in fact an automorphism of $\C$ fixing $\R$. Composing complex conjugation with itself gives the identity map. Therefore, $$\Aut_\R\C\cong C_2.$$
\end{enumerate}
    

    \begin{theorem}
        Let $p$ be a prime and $n\in\N$. Then $$\Aut(\F_{p^n}) = \Aut_{\F_p}(\F_{p^n})\cong C_n$$
        generated by the Frobenius map $\tau(x) = x^p.$
    \end{theorem}

    \begin{proof}
        Any automorphism of $\F_{p^n}$ sends $1$ to $1$ and so acts as identity on $\F_p$. So $\Aut(\F_{p^n}) = \Aut_{\F_p}(\F_{p^n}).$ From $(a+b)^p = a^p + b^p$ and $(ab)^p = a^pb^p$, we know that the Frobenius map $\tau$ defines a ring homomorphism $\F_{p^n}\rightarrow\F_{p^n}$. It is automatically injectively and it is then surjective because an injective map between two finite sets of the same size is surjective. More explicitly, we have for any $a\in \F_{p^n}$, $$a = a^{p^n} = (a^{p^{n-1}})^p = \tau(a^{p^{n-1}}).$$ Any positive power $\tau^m:x\mapsto x^{p^m}$ of $\tau$ is also in $\Aut(\F_{p^n}).$ Since every element in $\F_{p^n}$ satisfies $a^{p^n} = a$, we see that $\tau^n$ is the identity map. Since there is an element in $\F_{p^n}^\times$ of order $p^n - 1$, we see that no smaller power of $\tau$ is the identity map. Hence $\langle \tau\rangle \cong C_n$. It remains to prove that any $\sigma\in\Aut(\F_{p^n})$ is a power of $\tau$.

\begin{center}
    \add{Lecture 23 Fri 11/03}
\end{center}
        
        Let $f(x)\in\F_p[x]$ be an irreducible polynomial of degree $n$. Then we may identify $\F_{p^n}$ with $\F_p[x]/(f(x))$. Let $\alpha = x + (f(x))$. Then any $\sigma\in\Aut_{\F_p}(\F_p[x]/(f(x)))$ is determined by $\sigma(\alpha)$, which also must be a root of $f(x)$ by Lemma \ref{lem:mapf}. Indeed, since $\sigma$ fixes the coefficients of $f(x)$, we have
        $$\sigma(f(\alpha)) = f(\sigma(\alpha)).$$ By HW 6 Problem 1, we know that the roots of $f(x)$ in $F$ are exactly $\alpha, \alpha^p,\ldots,\alpha^{p^{n-1}}.$ Hence there is some $m = 0,\ldots,n-1$ such that $\sigma(\alpha) = \alpha^{p^m} = \tau^m(\alpha),$ which implies that $\sigma = \tau^m.$ 
    \end{proof}



What are the subgroups of $C_n$? Let $g$ be a generator of $C_n$ so that $$C_n = \langle g\rangle = \{e,g,\ldots,g^{n-1}\}.$$
Let $H$ be a subgroup of $C_n$. Let $d$ be the smallest positive integer such that $g^d\in H$. Then the usual division algorithm argument implies that if $g^k\in H$, then $d\mid k$. Hence $H = \langle g^d \rangle$. Since $g^n = e\in H$, we have $d\mid n$ and $$|H| = o(g^d) = \frac{o(g)}{\gcd(d, o(g))} = \frac{n}{d}.$$
In other words, all the subgroups of $C_n$ are cyclic, and there is a unique subgroup of order $d$ for any positive divisor $d$ of $n$.

What are the subfields of $\F_{p^n}$? We saw before that $\F_{p^n}$ has a (unique) subfield isomorphic to $\F_{p^d}$ if and only if $d\mid n$, in which case this subfield is given by $$\{a\in\F_{p^n}\colon a^{p^d} = a\} = \{a\in\F_{p^n}\colon \tau^d(a) = a\} = \{a\in\F_{p^n}\colon \sigma(a) = a,\forall \sigma\in\langle\tau^d\rangle\}.$$
On the other hand, by taking a primitive element of $\F_{p^d}$, we know that no smaller positive power of $\tau$ fixes $\F_{p^d}$. So we have $$\Aut_{\F_{p^d}}(\F_{p^n}) = \langle \tau^d\rangle.$$
In other words, there is a natural bijection between subgroups of $\Aut_{\F_p}(\F_{p^n})$ and subfields of $\F_{p^n}$ (containing $\F_p$). That is, the following two maps are inverses of each other.
\begin{eqnarray*}
    H&\mapsto& \F_{p^n}^H := \{a\in\F_{p^n}\colon h(a) = a,\forall h\in H\}\\
    \Aut_F(\F_{p^n})&\mapsfrom& F.
\end{eqnarray*}
The correspondence between subgroups of the automorphism group $\Aut_F(E)$ and subfields of $E$ containing $F$ is the heart of Galois theory. We will not develop Galois theory but will note an important consequence:
$$E^{\Aut_F(E)} = F.$$
In other words, assuming certain conditions on the field extension $E/F$, elements of $E$ that are fixed by every automorphism of $E$ fixing $F$, actually lie in $F$. We will not use this fact but will point out where this property is reflected. In HW 8, you will consider the notion of normal extensions and separable extensions, which are assumptions the field extension $E$ over $F$ needs to satisfy for Galois theory to work.

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Let $G$ be a group and let $g\in G$ with $o(g)$ finite. Prove that for any positive integer $k$, we have $$o(g^k) = \frac{o(g)}{\gcd(o(g),k)}.$$
    \solu{
    $o(g^k)$ is the smallest integer $n$ such that $g^{nk} = 1$. Done. 
    }
    \item Let $F$ be any field and let $f(x)\in F[x]$ be a degree 2 irreducible polynomial. Let $E = F[x]/(f(x))$. Prove that 
    $\Aut_F(E)\cong C_2$.
    \solu{
    Let $\sigma$ be the automorphism. Every automorphism of $E$ fixes $F$ so the automorphism is uniquely defined by $\sigma(x)$. Let $\sigma(x) = \alpha$. Then $0 = f(\sigma(x))= \sigma(f(x)) = f(\alpha)$. So $\alpha$ is a root. $\alpha^p$ is also a root. Let $\tau(\alpha) =  \alpha^p$. So our group is $\{e, \tau\} = C_2$
    }
    \item Prove that $\Aut_\Q(\R) = \{1\}$.
    \solu{
    Let $f$ be such an automorphism. Apply induction on $f$ additive gives $f(q) = q$. Note that $f(x)^2 = f(x^2)$ so $f(m)$ is bounded below when $m$ is nonnegative. Apply Cauchy's Functional Equations to get $f(x) = kx$. Plug back into original equation to get $f(x) = x$
    }

    The following result is beyond our scope: the automorphism group $\Aut_\Q(\C)$ has cardinality $2^{2^{\aleph_0}}.$
    \item Let $E = \Q[x]/(x^3 - 2)$. Prove that $E$ is a field and $\Aut_\Q(E) = \{1\}$.
    \solu{
    $E$ is a field since $x^3 - 2$ is irreducible over $\Q$. Note that $\Q(\sqrt[3]{2}) \cong \Q[x]/(x^3 - 2)$. and every automorphism sends $\sqrt[3]{2}$ to itself.
    }
    \item Let $E = \Q[x]/(x^4 + 1)$. Prove that $E$ is a field and $\Aut_\Q(E) \cong C_2\times C_2.$
    \solu{
    Let $\zeta_8=x+(x^4+1)$, then the 4 roots are $\zeta_8,\zeta_8^3,\zeta_8^5,\zeta_8^7$.\\
    Permute these roots gives $C_2\times C_2$.
}
\end{enumerate}

\section{Field extensions}

We now expand on some very important ideas illustrated by the examples in the previous section. We say $E$ is a \textbf{field extension} of $F$ if $F$ is a subfield of $E$. We usually write $E/F$ for the field extension. (Not to be confused with ring quotients. After all, fields don't have interesting quotients.) 

In both the examples of $\C/\R$ and $\F_{p^n}/\F_p$, there is an isomorphism $E\cong F[x]/(f(x))$ for some irreducible polynomial $f(x)$. Let $\alpha\in E$ corresponds to $x + (f(x))$. Then every element of $E$ is of the form $j(\alpha)$ for some polynomial $j(x)\in F[x]$.

In general, given a field extension $E/F$ and an element $\alpha\in E$, we write $F[\alpha]$ for the smallest subring of $E$ containing $F$ and $\alpha$. In other words,
$$F[\alpha] = \{j(\alpha)\colon j(x)\in F[x]\}.$$
We write $F(\alpha)$ for the smallest subfield of $E$ containing $F$ and $\alpha$. In other words,
$$F(\alpha) = \Big\{\frac{j(\alpha)}{k(\alpha)}\colon j(x),k(x)\in F[x],k(\alpha)\neq 0\Big\}.$$
The evaluation map $$\text{ev}_\alpha:F[x]\rightarrow F[\alpha]$$ is a surjective homomorphism. Its kernel is an ideal $I$ of $F[x]$, which is necessarily of the form $(f(x))$. If $f(x) = 0$, then we say $\alpha$ is \textbf{transcendental} over $F$, in which case $$F[\alpha]\cong F[x]\qquad\mbox{and}\qquad F(\alpha)\cong F(x),$$ the field of rational functions in $x$. 

If $f(x)$ is nonzero, then we may assume it is monic and $F[x]/(f(x))\cong F[\alpha]$ is an integral domain since it is a subring of a field. Therefore, $f(x)$ is irreducible and $F[x]/(f(x))$ is a field, which also implies that $$F(\alpha) \cong F[\alpha] \cong F[x]/(f(x)).$$ In this case, we say $\alpha$ is \textbf{algebraic} and we call the monic generator of the kernel of $\text{ev}_\alpha$ the \textbf{minimal polynomial} of $\alpha$ over $F$. Equivalently, it is easy to see that the the minimal polynomial of $\alpha$ is the monic irreducible polynomial in $F[x]$ that has $\alpha$ as a root. Moreover, using our usual division algorithm argument, we see that the minimal polynomial $f(x)$ of $\alpha$ is the monic polynomial in $\F[x]$ of the smallest degree that has $\alpha$ has a root; and so if $h(x)\in F[x]$ has $\alpha$ as a root, then $f(x)\mid h(x)$ in $F[x]$. 

\begin{comment}
    \begin{lemma}
    If $f(x)\in F[x]$ is a monic irreducible polynomial and $\alpha$ is a root of $f(x)$, then $f(x)$ is the minimal polynomial of $\alpha$.
\end{lemma}

\begin{proof}
    The minimal polynomial $g(x)$ of $\alpha$ is a monic irreducible polynomial dividing $f(x)$. Since they are both irreducible, we have $g(x) = f(x)u$ for some $u\in F^\times$. Since they are both monic, we have $u = 1$.
\end{proof}
\end{comment}



\begin{proposition}
    \label{prop:ab}
    Suppose $\alpha$ is algebraic over $F$ with minimal polynomial $f(x)$. Then there is a bijection between $\Aut_F(F(\alpha))$ and the set of distinct roots of $f(x)$ in $F(\alpha)$.
\end{proposition}

\begin{proof}
    Any automorphism $\sigma$ of $F(\alpha)$ fixing $F$ is determined by $\sigma(\alpha)$, which must also be a root of $f(x)$. Conversely, suppose $\beta\in F(\alpha)$ is a root of $f(x)$. Then there is a homomorphism $F[x]/(f(x))\rightarrow F(\alpha)$ sending $j(x)+(f(x))$ to $j(\beta)$. Composing it with the inverse of the natural isomorphism $F[x]/(f(x))\rightarrow F(\alpha)$ sending $x + (f(x))$ to $\alpha$, we get a homomorphism $F(\alpha)\rightarrow F(\alpha)$ sending $\alpha$ to $\beta$. Such a homomorphism is necessarily injective since the domain is a field. To prove that it is surjective, we need to talk about vector spaces.
\end{proof}

It is then fairly natural to imagine that in the framework of Galois theory, we assume that $F(\alpha)$ contains all the roots of $f(x)$ (normal extension), and that $f(x)$ has no repeated roots (separable extension). You will explore these in HW 8.

\begin{center}
    \add{Lecture 24 Mon 11/06}
\end{center}
Given $\alpha_1,\ldots,\alpha_n$ in $E$, we write
$$\tSpan_F\{\alpha_1,\ldots,\alpha_n\} = \{c_1\alpha_1 + \cdots + c_n\alpha_n\colon c_1,\ldots,c_n\in F\}$$
for the $F$-span of $\alpha_1,\ldots,\alpha_n$. It is an $F$-vector space: closed under addition and closed under multiplication by $F$. If $\tSpan_F\{\alpha_1,\ldots,\alpha_n\} = E$, then we call $\{\alpha_1,\ldots,\alpha_n\}$ a \textbf{spanning set} and we say $E$ is a \textbf{finite} extension of $F$. 

\vspace{5pt}
\noindent\textbf{Example}: Suppose $$E = F(\alpha) = F[\alpha] \cong F[x]/(f(x))$$ and $f(x)$ has degree $d$. Then every element of $E$ is of the form $g(\alpha)$ for some polynomial $g(x)\in F[x]$ of degree less than $d$. In other words, every element of $E$ is of the form $$c_0 + c_1\alpha + \cdots + c_{d-1}\alpha^{d-1}.$$
So the set $\{1,\alpha,\ldots,\alpha^{d-1}\}$ is a spanning set of $E$. Note also that if such an expression is $0$, then $\alpha$ is a root of $c_0 + c_1x + \cdots + c_{d-1}x^{d-1}$, which must then be divisible by the degree $d$ polynomial $f(x)$; hence we have $c_0 = \cdots = c_{d-1} = 0$. 

A set $\{\alpha_1,\ldots,\alpha_n\}\subseteq E$ is said to be \textbf{linearly independent} over $F$ if whenever $c_1\alpha_1 + \cdots + c_n\alpha_n = 0$ for some $c_1,\ldots,c_n\in F$, we have $c_1 = \cdots = c_n = 0.$ A linearly independent spanning set is called a \textbf{basis}.

\begin{lemma}\label{lem:span}
    If $E$ has a spanning set $\{\alpha_1,\ldots,\alpha_n\}$ of size $n$, then $E$ has no linearly independent set of size more than $n$.
\end{lemma}

\begin{proof}
    Suppose for a contradiction that $\{\beta_1,\ldots,\beta_{n+1}\}$ is a linearly independent set of size $n+1$. For each $i = 1,\ldots,n+1$, there exist $c_{i1},\ldots,c_{in}\in F$ such that $$\beta_i = c_{i1}\alpha_1 + \cdots + c_{in}\alpha_n.$$
    We look for $x_1,\ldots,x_{n+1}\in F$ that are not all $0$ such that $$x_1\beta_1 + \cdots + x_{n+1}\beta_{n+1} = 0.$$
    In terms of the coefficients in $\alpha_1,\ldots,\alpha_n$, we see that it suffices to prove that 
    \begin{eqnarray*}
        x_1c_{11} + \cdots + x_{n+1}c_{n+1\,1}&=&0\\
        &\vdots&\\
        x_1c_{1\,n} + \cdots + x_{n+1}c_{n+1\,n}&=&0
    \end{eqnarray*}
    has a nonzero solution. Note we have $n$ linear equations and $n+1$ unknowns. So we may use standard elimination method for solving systems of linear equations. More precisely, at least one of the $c_{ij}$ is nonzero, for if otherwise all the $\beta_i$ are $0$ and so can't be linearly independent. By renaming, suppose $c_{11}\neq 0$. Then we use the first equation to express $$x_1 = -c_{11}^{-1}c_{21}x_2 - \cdots -c_{11}^{-1}c_{n+1\,1}x_{n+1}$$ and plug it into the other equations. Now we have $n-1$ linear equations and $n$ unknowns, which must have a nonzero solution in $(x_2,\ldots,x_n)$ by induction. We then use the above formula to find $x_1$. The base case of $1$ equation and $2$ unknowns is obvious.
\end{proof}

We list some immediate consequences of Lemma \ref{lem:span}.
\begin{cor}
    If $E$ has a spanning set of size $n$, then any linearly independent set of size $n$ is a basis.
\end{cor}

\begin{proof}
    Suppose $\{\beta_1,\ldots,\beta_n\}$ is linearly independent over $F$. If it doesn't span $E$, then there exists some $\gamma\in E\backslash\text{Span}_F\{\beta_1,\ldots,\beta_n\}.$ Then it is easy to see that $\{\beta_1,\ldots,\beta_n,\gamma\}$ is linearly independent over $F$ of size $n+1$. Contradiction.
\end{proof}

\begin{cor}
    Suppose $E/F$ is finite. Then:
    \begin{enumerate}[(a)]
        \item Any linearly independent set over $F$ can be enlarged into a basis over $F$.
        \item Any spanning set contains a basis over $F$.
        \item Any homomorphism $\sigma:E\rightarrow E$ fixing $F$ is an isomorphism.
    \end{enumerate}
\end{cor}

\begin{proof}
    Let $d$ denote the size of a smallest spanning set of $E$.
    A linearly independent set that is not a spanning set can be enlarged by the same procedure as in the proof of the previous corollary. This process terminates when we reach a linearly independent set of size $d$, which is then a basis.

    Suppose $\{\alpha_1,\ldots,\alpha_n\}$ is a spanning set of $E$ that is not linearly independent over $F$. Then there exists $c_1,\ldots,c_n$ not all $0$ such that $c_1\alpha_1 + \cdots + c_n\alpha_n = 0$. By renaming, we may assume $c_1\neq 0$. Then $$\alpha_1 = -c_1^{-1}c_2\alpha_2 - \cdots - c_1^{-1}c_n\alpha_n.$$
    Hence $\{\alpha_2,\ldots,\alpha_n\}$ is a spanning set of $E$. This process terminates when we reach a linearly independent set that is also a spanning set.

    Finally, any field homomorphism is injective. Let $\{\alpha_1,\ldots,\alpha_d\}$ be a basis of $E$ over $F$. We claim that $\{\sigma(\alpha_1),\ldots,\sigma(\alpha_d)\}$ is linearly independent over $F$, which then implies that it is a basis and so the image of $\sigma$ is all of $E$. Suppose $c_1,\ldots,c_d\in F$ such that $$c_1\sigma(\alpha_1) + \cdots + c_d\sigma(\alpha_d) = 0.$$
    Since $\sigma$ fixes $F$, we have
    $$\sigma(c_1\alpha_1 + \cdots + c_d\alpha_d) = c_1\sigma(\alpha_1) + \cdots + c_d\sigma(\alpha_d) = 0.$$
    Since $\sigma$ is injective, we see that $c_1\alpha_1 + \cdots + c_d\alpha_d = 0$ and so $c_1 = \cdots = c_d = 0$ by the linear independence of $\{\alpha_1,\ldots,\alpha_d\}$.
\end{proof}



From Lemma \ref{lem:span}, we see that any two bases of $E$ have the same size: If one has size $n$ and the other has size $m$, then using the size $n$ spanning set and size $m$ linearly independent set, we get $m\leq n$ and similarly we have $n\leq m$. This common size is the \textbf{degree} of the extension, denoted $[E:F]$, or the \textbf{dimension} of $E$ as an $F$-vector space.

\begin{cor}
    Suppose the minimal polynomial of $\alpha$ has degree $d$. Then $[F(\alpha):F] = d$.
\end{cor}

\begin{proposition}
    Suppose $L$ is a finite extension of $E$ and $E$ is a finite extension of $F$. Then $L$ is a finite extension of $F$ and $[L:F] = [L:E][E:F].$
\end{proposition}

\begin{proof}
    Let $\{\alpha_1,\ldots,\alpha_n\}$ be a basis of $L$ over $E$ and let $\{\beta_1,\ldots,\beta_m\}$ be a basis of $E$ over $F$. Then it is easy to check that $$\{\alpha_i\beta_j\colon i = 1,\ldots,n, j = 1,\ldots,m\}$$ is a basis of $L$ over $F$.
\end{proof}

\begin{proposition}
    If $E/F$ is finite, then every $\alpha\in E$ is algebraic.
\end{proposition}

\begin{proof}
    Suppose $d = [E:F]$ and $\alpha\neq 0$. Then $\{1,\alpha,\ldots,\alpha^d\}$ is a set of size $d+1$ and so is not linearly independent. Then $c_0 + c_1\alpha + \cdots + c_d\alpha^d = 0$ for some $c_0,\ldots,c_d\in F$ not all $0$. Then $\alpha$ is a root of the nonzero polynomial $c_0 + c_1x + \cdots + c_dx^d$.
\end{proof}

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Suppose $E/F$ is finite of degree $d$. Suppose $|F|$ is finite. Prove that $|E| = |F|^d$, without using the classification theorem of finite fields. 
    
    This gives another proof that any finite field has size $p^d$ for some prime $p$. It also proves that if $\F_{p^d}$ is a subfield of $\F_{p^n}$, then $d\mid n$.
    \item Find $[\Q(\sqrt{2} + \sqrt{3}):\Q]$. 
    \item Suppose $E/F$ is a field extension. Let $\alpha,\beta$ be elements of $E$. We write $F(\alpha,\beta) = F(\alpha)(\beta)$ for the smallest subfield of $E$ containing $\alpha$, $\beta$ and $F$. Prove that $\Q(\sqrt{2}, \sqrt{3}) = \Q(\sqrt{2}+\sqrt{3})$ (as subfields of $\C$, or $\R$).
    \item Prove that $\Aut_\Q(\Q(\sqrt{2}+\sqrt{3})) \cong C_2\times C_2$.
    \item Let $F$ be a field and consider $E = F(\alpha)$ where $\alpha$ is algebraic over $F$. For any intermediate field $L$  in the extension $E/F$, i.e $F\subseteq L\subseteq E$, we let $f_L(x)\in L[x]$ be the minimal polynomial of $\alpha$ over $L$.
    \begin{enumerate}
        \item Prove that for any intermediate fields $L$ and $K$, we have $L\subseteq K$ if and only if $f_L(x) \in K[x]$.
        \item Prove that for any intermediate fields $L$ and $K$, we have $L= K$ if and only if $f_L(x) = f_K(x)$.
        \item Prove that there are only finitely many intermediate fields in the extension $E/F$.
    \end{enumerate}
    \item Suppose $E/F$ is a finite extension where $F$ is infinite. Suppose there are finitely many intermediate fields in the extension $E/F$. Prove that there exists $\alpha\in E$ such that $E = F(\alpha)$.

    Galois theory implies that if $F$ is a finite field or a field of characteristic $0$, then a finite extension $E/F$ has finitely many intermediate fields. In other words, they are all of the form $F(\alpha)/F$. Extensions of this form are known as \textit{simple extensions}.
    \item Consider $F = \F_p(x,y)$, the field of rational functions in two variables $x,y$ over $\F_p$. Let $E = \F_p(t,s)$ with $t^p = x$ and $s^p = y$. In other words, $E = F[T,S]/(T^p - x, S^p - y).$ Prove that $E/F$ is a finite extension and there does not exist $\alpha\in E$ such that $E = F(\alpha)$.
    \item Let $E/F$ be a field extension. Let $$L=\{\alpha\in E\colon \alpha\mbox{ is algebraic over }F\}.$$
    Prove that $L$ is a field. Such a field is called the \textit{algebraic closure} of $F$ in $E$. 
\end{enumerate}


\section{Cyclotomic extension}
In this section, we consider the Cyclotomic extension $\Q(\zeta_m)$ over $\Q$. Since $\zeta_m$ is a root of $\Phi_m(x)\in\Z[x]$, we see that it is algebraic and $\Q(\zeta_m) = \Q[\zeta_m]$. We begin with the irreducibility of $\Phi_m(x)$.

\begin{theorem}
    For any $m\in\N$, $\Phi_m(x)$ is irreducible in $\Q[x]$.
\end{theorem}

Since $\Phi_m(x)$ is also monic, we see that it is then the minimal polynomial of $\zeta_m$. The roots of $\Phi_m(x)$ are of the form $\zeta_m^k$ where $k\in(\Z/m\Z)^\times$, all of which lie in $\Q(\zeta_m)$, and so there is a bijection between $\Aut_\Q(\Q(\zeta_m))$ and $(\Z/m\Z)^\times.$ We write $\sigma_k$ for the automorphism sending $\zeta_m$ to $\zeta_m^k$. For $j,k\in(\Z/m\Z)^\times$, we see that $$\sigma_j(\sigma_k(\zeta_m)) = \sigma_j(\zeta_m^k) = \zeta_m^{jk} = \sigma_{jk}(\zeta_m).$$
Hence the bijection $j\mapsto \sigma_j$ is also a group isomorphism.

\begin{cor}
    For any integer $m\geq 2$, we have $[\Q(\zeta_m):\Q] = \phi(m)$ and $\Aut_\Q(\Q(\zeta_m)) \cong (\Z/m\Z)^\times$.
\end{cor}

\begin{center}
    \add{Lecture 25 Wed 11/08}
\end{center}

We now work towards the irreducibility of $\Phi_m(x)$. Let $f(x)\in\Q[x]$ be the minimal polynomial of $\zeta_m$. Then $f(x)$ is a monic irreducible polynomial dividing $\Phi_m(x)$. Write $\Phi_m(x) = f(x)g(x)$ for some $g(x)\in\Q[x]$. We prove first that $f(x)$ and $g(x)$ are in $\Z[x]$.

Given any polynomial $a(x)\in\Z[x]$, we define its \textbf{content} to be the $\gcd$ of all of its coefficients. We say $a(x)$ is \textbf{primitive} if its content is $1$. For example, $2x - 3$ is primitive. Any monic polynomial in $\Z[x]$, for example $\Phi_m(x)$, is primitive. For any prime $p$, let $\pi_p$ denote the natural homomorphism $$\pi_p:\Z[x]\rightarrow\F_p[x]:a_nx^n + \cdots + a_0 \mapsto a_nx^n + \cdots + a_0.$$
Note that $a(x)$ is primitive if and only if $\pi_p(a(x))\neq 0$ for all primes $p$.


\begin{lemma}
    (Gauss) If $a(x)$ and $b(x)$ are primitive, then so is $a(x)b(x)$.
\end{lemma}

\begin{proof}
    Let $p$ be any prime. Since $\F_p$ is a field, $\F_p[x]$ is an integral domain. Hence from $\pi_p(a(x))\neq 0$ and $\pi_p(b(x))\neq 0$, we have $\pi_p(a(x)b(x)) = \pi_p(a(x))\pi_p(b(x))\neq 0$.
\end{proof}

\begin{cor}\label{cor:Gauss}
    Suppose $k(x)\in\Z[x]$ and $h(x),j(x)\in\Q[x]$ are monic polynomials such that $k(x) = h(x)j(x)$. Then $h(x),j(x)\in\Z[x]$.
\end{cor}

\begin{proof}
    Let $c_h$ and $c_j$ be the smallest positive integers such that $c_hh(x)\in\Z[x]$ and $c_jj(x)\in\Z[x]$. Let $d\in\N$ be the content of $c_hh(x)$. Then $d$ divides the leading coefficient $c_h$. So now $c_h/d\in\N$ and $(c_h/d)h(x)\in\Z[x]$. By minimality of $c_h$, we have $d = 1$. So $c_hh(x)$ and similarly $c_jj(x)$ are primitive. By Gauss' Lemma, their product $$c_hc_j h(x)j(x) = c_hc_j k(x)$$ is primitive. Since $k(x)\in\Z[x]$, we have $c_hc_j = 1$. Hence $c_h = c_j = 1$.
\end{proof}

\begin{cor}\label{cor:factorQ}
    Suppose $k(x)\in\Z[x]$ and $h(x),j(x)\in\Q[x]$ are polynomials such that $k(x) = h(x)j(x)$. Then there exists $h_1(x),j_1(x)\in\Z[x]$ divisible by $h(x)$ and $j(x)$ in $\Q[x]$ respectively, such that $k(x) = h_1(x)j_1(x)$.
\end{cor}

\begin{proof}
    Let $c_h$ and $c_j$ be the smallest positive integers such that $c_hh(x)\in\Z[x]$ and $c_jj(x)\in\Z[x]$. Let $d_h = C(c_hh(x))$ and $d_j = C(c_jj(x))$. Then $(c_h/d_h)h(x)$ and $(c_j/d_j)j(x)$ are primitive. By Gauss' Lemma, their product $(c_hc_j/(d_hd_j))k(x)$ is primitive. Hence the content of $c_hc_jk(x)$ is $d_hd_j$. Since $k(x)\in\Z[x]$, the content of $c_hc_jk(x)$ is divisible by $c_hc_j$, so we have $c_hc_j \mid d_h d_j$. Now
    $$k(x) = \left(\frac{d_hd_j}{c_hc_j} \cdot \frac{c_h}{d_h}h(x)\right) \frac{c_j}{d_j}j(x)$$
    is a product of polynomials in $\Z[x]$.
\end{proof}

\begin{cor}\label{cor:alg}
    If $\alpha\in\C$ is the root of a monic polynomial in $\Z[x]$, then the minimal polynomial of $\alpha$ over $\Q$ is in $\Z[x]$. They are called \textbf{algebraic integers}.
\end{cor}

\begin{proof}
    Let $h(x)\in\Z[x]$ be a monic polynomial having $\alpha$ as a root. Then $h(x)$ is primitive. Let $j(x)\in\Q[x]$ be the minimal polynomial of $\alpha$ over $\Q$. Since $j(x)$ and $h(x)$ are both monic and $j\mid h$ in $\Q[x]$, there exists a monic polnyomial $k(x)\in\Q[x]$ such that $j(x)k(x) = h(x)$. By Corollary \ref{cor:Gauss}, we have $j(x)\in\Z[x]$.
\end{proof}

Applying Corollary \ref{cor:alg} to $\zeta_m$, we find that $f(x)$ and $g(x)$ are in $\Z[x]$ and are monic.

\begin{proposition}\label{prop:zeta^p}
    Suppose $\zeta$ is a root of $f(x)$. Then for any prime $p\nmid m$, $\zeta^p$ is also a root of $f(x)$.
\end{proposition}

Note that for any positive integer $j$ coprime to $m$, it can be written as a product of primes $p_1\cdots p_r$, none of which divides $m$. Then by repeatedly applying this result, starting from the root $\zeta_m$, we find that $\zeta_m^j = \zeta_m^{p_1\cdots p_r}$ is a root of $f(x)$. Hence all the roots of $\Phi_m(x)$, which are all distinct, are roots of $f(x)$. So $\Phi_m(x) \mid f(x)$. Since $f(x)$ is irreducible and they are both monic, we have $\Phi_m(x) = f(x)$ is irreducible.

\vspace{5pt}
\begin{proof}
    Since $f(x)$ is monic irreducible, we see that it is also the minimal polynomial of $\zeta$. Since $\zeta$ is a root of $\Phi_m$, we know that it is of the form $\zeta_m^k$ for some integer $k$ coprime to $m$. Since $p\nmid m$, we have that $pk$ is also coprime to $m$ and so $\zeta^p = \zeta_m^{pk}$ is a root of $\Phi_m(x)$. Suppose for a contradiction that $\zeta^p$ is not a root of $f(x)$. Then it is a root of $g(x)$. Hence $\zeta$ is a root of $g(x^p)$, which implies that $g(x^p)$ is divisible by $f(x)$ in $\Q[x]$. Since $f(x)$ is monic and and $g(x^p)$ is a monic polynomial in $\Z[x]$, we have $g(x^p) = f(x)h(x)$ for some $h(x)\in\Z[x]$ by Corollary \ref{cor:Gauss}. Recall that $\Phi_m(x)j(x) = x^m - 1$, where $j(x)\in \Z[x]$ is the product of $\Phi_d(x)$ over all positive divisors $d\mid m$ such that $d\neq m$. In other words, we have
    \begin{eqnarray*}
        x^m - 1 &=& f(x)g(x)j(x),\\
        g(x^p) &=& f(x)k(x).
    \end{eqnarray*}
    The trick now is to apply $\pi_p$ to work in $\F_p[x]$. In $\F_p[x]$, we have
    $$\pi_p(g(x))^p = \pi_p(g(x^p)) = \pi_p(f(x))\pi_p(k(x)).$$
    Let $\ell(x)\in\F_p[x]$ be a monic irreducible divisor of $\pi_p(f(x))$. Then we have $\ell(x)\mid \pi_p(g(x))^p$ and so $\ell(x)\mid \pi_p(g(x))$. %(This follows because $(\pi_p(g(x))+(\ell(x)))^p = 0$ in the field $\F_p[x]/(\ell(x)).$) 
    However, this implies that $\ell(x)^2\mid \pi_p(\Phi_m(x))\mid x^m - 1$ in $\F_p[x]$. So $\ell(x)$ divides the derivative $mx^{m-1}$. Since $p\nmid m$, we have $\ell(x) = x$, but it can't divide $x^m - 1$. Contradiction.
\end{proof}

%\begin{center}
    %\alert{The following might be skipped in the interest of time.}
%\end{center}


There is a very nice irreducibility criterion that can be used to prove that $\Phi_p(x)$ is irreducible when $p$ is prime.

\begin{proposition}
    (Eisenstein's criterion) Suppose $f(x)\in\Z[x]$ of degree $n$ and $p$ is a prime. Suppose $\pi_p(f(x)) = \alpha x^n$ for some $\alpha\in\F_p^\times$ and $\nu_p(f(0)) = 1$. Then $f(x)$ is irreducible in $\Q[x]$.
\end{proposition}

\begin{proof}
    Suppose for a contradiction that $f(x) = g(x)h(x)$ where $g(x)\in\Q[x]$ has degree $d\geq1$ and $h(x)\in\Q[x]$ has degree $e\geq1$. By Corollary \ref{cor:factorQ}, we may assume $g(x),h(x)\in\Z[x]$. Now $$\pi_p(g(x))\pi_p(h(x)) = \pi_p(f(x)) = \alpha x^n.$$ So we must have $\pi_p(g(x)) = \beta x^d$ and $\pi_p(h(x)) = \gamma x^e$ for some $\beta,\gamma\in \F_p^\times$. Since $d,e\geq 1$, we have $p\mid g(0)$ and $p\mid h(0)$. Then $\nu_p(g(0)h(0))\geq 2$ contradicting $\nu_p(f(0)) = 1$.
\end{proof}

As an concrete example, for any positive integer $n$, the polynomial $x^n - 2$ is irreducible in $\Q[x]$. Hence, there is an irreducible polynomial in $\Q[x]$ of any degree. Note that $$\Phi_p(x+1) = \frac{(x+1)^p - 1}{x} = x^{p-1} + px^{p-2} + \binom{p}{2}x^{p-3} + \cdots + p$$
satisfies the conditions of Eisenstein's criterion. Hence $\Phi_p(x+1)$ is irreducible, and so is $\Phi_p(x)$.


Let's recall the construction of the polynomial in the proof of Schur's theorem. Let $m$ be a positive integer and let $a\in(\Z/m\Z)^\times$ be an element of order $2$. Fix a subset $S\subseteq (\Z/m\Z)^\times$ such that $(\Z/m\Z)^\times$ is a disjoint union of $S$ and $Sa$. Suppose without loss of generatlity that $1\in S$. Choose an integer $u$ such that
$$\eta_j = (mu - \zeta_m^j)(mu - \zeta_m^{ja})\in\Q(\zeta_m)$$
for $j\in S$ are all distinct. Note that each $\eta_j$ is algebraic.  We defined
$$f(x) = \prod_{j\in S}(x - \eta_j) = \prod_{j\in S}\Big(x - (mu - \zeta_m^j)(mu - \zeta_m^{ja})\Big).$$
\begin{lemma}
    The minimal polynomial of $\eta_1$ over $\Q$ is $f(x)$. In other words, $f(x)\in\Q[x]$ and is irreducible.
\end{lemma}

\begin{proof}
    %Let $d = \phi(m) = [\Q(\zeta_m):\Q]$, we see that the set $\{1,\eta_1,\ldots,\eta_1^d\}$ is not linearly independent. Hence, there exists $c_0,\ldots,c_d\in\Q$ not all $0$ such that $$c_0 + c_1\eta_1 + \cdots + c_d\eta_1^d = 0.$$ In other words, there is a nonzero polynomial $h(x)\in\Q[x]$ such that $h(\eta_1) = 0$. 
Recall that we have a group isomorphism $(\Z/m\Z)^\times\rightarrow\Aut_\Q(\Q(\zeta_m))$ sending $j$ to the automorphism $\sigma_j$ where $\sigma_j(\zeta_m) = \zeta_m^j$. Let $g(x)\in\Q[x]$ denote the minimal polynomial of $\eta_1$ over $\Q$. Then every element of the form $\sigma_j(\eta_1)$ is a root of $g(x)$. Note that for any $j\in S$,
\begin{eqnarray*}
    \sigma_j(\eta_1) &=& (mu - \zeta_m^j)(mu - \zeta_m^{ja}) = \eta_j,\\
    \sigma_{ja}(\eta_1) &=& (mu - \zeta_m^{ja})(mu - \zeta_m^j)= \eta_j.
\end{eqnarray*}
 Then $\eta_j$, for $j\in S$, are all roots of $g(x)$ in $\Q(\zeta_m)$ and we have $f(x)\mid g(x)$ in $\Q(\zeta_m)[x]$. It remains to prove that they have the same degree. 
 
 
\begin{center}
    \add{Lecture 26 Fri 11/10}
\end{center}

Note that
$$[\Q(\eta_1):\Q] = \deg(g) \geq |S| = \frac12\phi(m).$$
Moreover, since $\Q(\eta_1)\subseteq \Q(\zeta_m)$, we have
$$\phi(m) = [\Q(\zeta_m):\Q] = [\Q(\zeta_m):\Q(\eta_1)][\Q(\eta_1):\Q].$$
We now prove that $\Q(\eta_1)\neq\Q(\zeta_m)$. We use $\sigma_a:$
$$\sigma_a(\eta_1) = \eta_1,\qquad\mbox{and}\qquad \sigma_a(\zeta_m) = \zeta_m^a\neq\zeta_m.$$
So $\sigma_a$ fixes $\Q(\eta_1)$, but not $\Q(\zeta_m)$. Hence $[\Q(\zeta_m):\Q(\eta_1)] \geq 2$ and so $[\Q(\eta_1):\Q]\leq \phi(m)/2$. Combining this with the above lower bound gives $\deg(g) = \deg(f) = \phi(m)/2$.
\end{proof}

\noindent\textbf{Remark}: In fact, we have 
$$\Q(\eta_1) = \Q(\zeta_m)^{\langle\sigma_a\rangle}.$$ Since $f(x)$ is fixed by every element in $\Aut_\Q(\Q(\zeta_m))$, Galois theory would also imply immediately that $f(x)\in\Q[x]$.

\vspace{5pt}
We prove next that $f(x)\in\Z[x]$. Consider the ring $$\Z[\zeta_m] = \{j(\zeta_m)\colon j(x)\in\Z[x]\}.$$
In other words, $\Z[\zeta_m]$ is the smallest subring of $\Q(\zeta_m)$ containing ($\Z$ and) $\zeta_m$. Then we see that $\eta_j\in \Z[\zeta_m]$ for all $j\in S$. Hence $f(x)\in \Z[\zeta_m][x]$.

\begin{lemma}
    We have $\Z[\zeta_m]\cap\Q = \Z.$ In particular, $f(x)\in\Z[x]$.
\end{lemma}

\begin{proof}
    Since the minimal polynomial $\Phi_m(x)$ of $\zeta_m$ is monic and has integer coefficients, we know that every element in $\Z[\zeta_m]$ is of the form $j(\zeta_m)$ for some polynomial $j(x)\in\Z[x]$ of degree less than $\phi(m)$. Suppose that there exists some $j(x)\in\Z[x]$ with $\deg(j)<\phi(m)$ and $r,s\in\Z$ with $s\neq 0$ such that $$j(\zeta_m) = \frac{r}{s}.$$
    Then $sj(\zeta_m) - r = 0$. Hence $sj(x) - r\in\Z[x]$ is divisible by $\Phi_m(x)$ in $\Q[x]$ but it has degree less than $\deg(\Phi_m(x))$. So $sj(x) - r = 0$. Setting $x = 0$ gives $r = sj(0)$ and so $j(\zeta_m) = j(0)\in\Z$.
\end{proof}

We now consider the divisibility statements: there exists a nonzero integer $N$ such that
\begin{enumerate}[(a)]
    \item If $p$ is a prime divisor of $f(n)$ for some integer $n$, then $p\mid N$ or $p\equiv 1$ or $a$ mod $m$.
    \item If $p$ is a prime congruent to $a$ mod $m$ and $p\nmid N$, then there exists $b\in\Z$ such that $\nu_p(f(b)) = 1$.
\end{enumerate}
We give a sketch of the idea first. Suppose $p\mid f(n)$ for some $n\in\Z$. Then we have
$$p\mid \prod_{j\in S}(n - \eta_j).$$
We would like to say that $p\mid n - \eta_j$ for some $j\in S$, which is ``like saying'' that $$\eta_j = n \in\F_p\qquad\mbox{and so}\qquad \eta_j^p = \eta_j.$$
Since we are now in characteristic $p$, we have
$$\eta_j^p = (mu - \zeta_m^{jp})(mu - \zeta_m^{jap}) = \eta_{jp}.$$
We know that $$\eta_j = \eta_{jp}\in\C\Longleftrightarrow jp = j\mbox{ or }jp = ja\in(\Z/m\Z)^\times \Longleftrightarrow p\equiv 1\mbox{ or }a\pmod{m}.$$
We need this to also be true in $\F_p$, except for $p\mid N$ for some nonzero integer $N$.

\begin{center}
    \add{Lecture 27 Mon 11/13}
\end{center}

To make the first step rigorous, we are looking at a property of the form $$p\mid ab\Rightarrow p\mid a\mbox{ or }p\mid b.$$
This is exactly Euclid's lemma for primes, but its proof requires the notion of gcd. However, most $\Z[\zeta_m]$ are not Euclidean domains (we will see that they are for $m=3,4$), as most of them are not PIDs. In fact, it is a theorem that $\Z[\zeta_m]$ is a Euclidean domain if and only if it is a PID, and there are only finitely many of them. The way to get around it is to work with prime ideals instead.

\vspace{5pt}
Let $R$ be a commutative ring. An ideal $I$ of $R$ is a \textbf{prime ideal} if it is a proper ideal and whenever $ab\in I$ for some $a,b\in R$, we have $a\in I$ or $b\in I$. In terms of the quotient $R/I$, this means that if $(ab) + I = 0 + I$, then $a + I = 0 + I$ or $b + I = 0 + I$. In other words, $I$ is a prime ideal if and only if $R/I$ is an integral domain.

When $R = \Z$, the prime ideals are $p\Z$ and $(0)$. When $R = F[x]$ for some field $F$, the prime ideals are $(f(x))$ where $f(x)$ is irreducible or $0$. We note that in these two examples, if the prime ideal $I$ is not $(0)$, then $R/I$ is actually a field. When $R = \Z[x]$ and $I = (x)$, we have $R/I \cong \Z$ is an integral domain but not a field.





When $R = \Z[\zeta_m]$ and $p$ is a prime, the ideal $pR$ is not necessarily a prime ideal of $R$. We first note that $R\cong \Z[x]/(\Phi_m(x))$. Indeed, the evaluation homomorphism $\text{ev}_{\zeta_m}:\Z[x]\rightarrow \Z[\zeta_m]$ is surjective. For any $j(x)\in\Z[x]$, we see that
\begin{eqnarray*}
    j(x)\in\ker(\text{ev}_{\zeta_m}) &\Leftrightarrow& j(\zeta_m) = 0\\
    &\Leftrightarrow& \Phi_m(x)\mid j(x)\mbox{ in }\Q[x]\\
    &\Leftrightarrow& \Phi_m(x)\mid j(x)\mbox{ in }\Z[x].
\end{eqnarray*}
Here, the second equivalence follows because $j(x)\in\Q[x]$ and $\Phi_m(x)$ is the minimal polynomial of $\zeta_m$ over $\Q$; and the third equivalence follows because $\Phi_m(x)\in\Z[x]$ is monic. Hence, we have $\ker(\text{ev}_{\zeta_m}) = (\Phi_m(x))$ and we are done by the first isomorphism theorem. To compute the quotient $R/pR$, since $R$ itself is a quotient, we need the third isomorphism theorem (Exercise 8.\ref{exer:8.3}): if $S$ is a commutative ring with proper ideals $I$ and $J$ such that $I\subseteq J$, then $$(S/I)/(J/I)\cong S/J.$$
Using this with $S = \Z[x]$, $I = (\Phi_m(x))$ and $J = (p, \Phi_m(x))$, we have
$$R/pR \cong \Z[x]/(p, \Phi_m(x)).$$
Now we use it again but quotient out by $p$ first. In other words, we take $S = \Z[x]$, $I = (p)$ and $J = (p, \Phi_m(x))$ to get
$$R/pR \cong \Z[x]/(p, \Phi_m(x))\cong \F_p[x]/(\pi_p(\Phi_m(x))),$$
where $\pi_p:\Z[x]\rightarrow\F_p[x]$ is the natural reduction mod $p$ map.
Unfortunately, $R/pR$ is not an integral domain if $\pi_p(\Phi_m(x))$ is not irreducible. As you will prove in HW10, $\pi_p(\Phi_m(x))$ is very often reducible.
\begin{theorem}
    Suppose $p\nmid m$. Then $\pi_p(\Phi_m(x))$ factors into a product of $\phi(m)/o_m(p)$ irreducible polynomials in $\F_p[x]$, where $o_m(p)$ is the order of $p$ mod $m$.
\end{theorem}

Note if $o_m(p) = \phi(m)$, then the group $G = (\Z/m\Z)^\times$ has an element $p$ whose order equals $|G|$, which implies that $(\Z/m\Z)^\times$ is cyclic. You proved in HW9 that this happens only when $m = 2,4,q^k,2q^k$ for some odd prime $q$.

\vspace{5pt}
\noindent\textbf{Example}: Consider $\Phi_8(x) = x^4 + 1$. Let's prove that $x^4 + 1$ is reducible in $\F_p[x]$ for every prime $p$. When $p = 2$, we have $x^4 + 1 = (x + 1)^4$. Suppose $p$ is an odd prime. Then $p^2\equiv 1\pmod{8}$. So $\F_{p^2}$ contains a primitive $8$-th root of unity $\alpha$. The minimal polynomial of $\alpha$ over $\F_p$ then has degree at most $2$ and it divides $x^4 + 1$.

We fix the problem by taking an irreducible factor $g_0(x)$ of $\pi_p(\Phi_m(x))$. Working backwards, we take some $g(x)\in\Z[x]$ so that $\pi_p(g(x)) = g_0(x)$. Then
$$\F_p[x]/(g_0(x)) = \F_p[x]/(g_0(x),\pi_p(\Phi_m(x))) \cong \Z[x]/(p, \Phi_m(x), g(x)) \cong \Z[\zeta_m]/(p, g(\zeta_m)).$$Let $$I_p = (p, g(\zeta_m))$$
be the ideal of $R$ generated by $p$ and $g(\zeta_m)$. Since $p\in I_p$, we see that $I_p$ does not depend on the choice of the lift $g(x)$. Then $R/I_p$ is a finite field of characteristic $p$ and so $I_p$ is a prime ideal. %If $p\nmid m$ is that $x^m - 1$ has no repeated factors in $\F_p[x]$, and the same is true for its divisor $\pi_p(\Phi_m(x))$. To have the same statement for $\pi_p(f(x))$, we need to replace $p\nmid m$ by $p\nmid \Delta(f)$, where $\Delta(f)$ is the discriminant of $f(x)$, to be define next section.
We can now redo the argument from last time using $I_p$.

\begin{comment}
    \begin{lemma}
    Suppose $p\nmid m$. Then $p\notin I_p^2$.
\end{lemma}

\begin{proof}
    Suppose for a contradiction that $p \in I_p^2 = (p^2, pg(\zeta_m), g(\zeta_m)^2).$ Let $a(x),b(x),c(x)\in\Z[x]$ such that $$p = p^2a(\zeta_m) + pg(\zeta_m)b(\zeta_m) + g(\zeta_m)^2c(\zeta_m).$$
    Reducing mod $p$, we see that $$\pi_p(\Phi_m(x))\mid g_0(x)^2\pi_p(c(x)).$$
    Write $\pi_p(\Phi_m(x)) = g_0(x)h_0(x)$ for some $h_0(x)\in\F_p[x]$. Then we have $$h_0(x)\mid g_0(x)\pi_p(c(x)).$$
    Since $\pi_p(\Phi_m(x))$ has no repeated factors, we see that $g_0(x)$ does not divide $h_0(x)$. Since $g_0(x)$ is irreducible, we have $h_0(x)\mid\pi_p(c(x)).$ (\textbf{Exercise}: prove this via $(g_0(x),h_0(x)) = \F_p[x]$.)

    Let $h(x)\in\Z[x]$ be any lift of $h_0(x)$ so that $\Phi_m(x) = g(x)h(x) + pj(x)$  and $c(x) = h(x)k(x) + p\ell(x)$ for some $j(x),k(x), \ell(x)\in\Z[x]$. In other words, we have
    \begin{eqnarray*}
        p &=& p^2a(\zeta_m) + pg(\zeta_m)b(\zeta_m) + g(\zeta_m)^2(h(\zeta_m)k(\zeta_m) + p\ell(\zeta_m))\\
        &=& p^2a(\zeta_m) + pg(\zeta_m)\Big(b(\zeta_m) + g(\zeta_m)\ell(\zeta_m) + j(\zeta_m)+k(\zeta_m)\Big).
    \end{eqnarray*}
    Dividing by $p$ gives $1\in (p, g(\zeta_m)) = I_p$, which contradicts the fact that $I_p$ is a prime ideal.
\end{proof}
\end{comment}

Suppose $p$ is a prime and $p\mid f(n)$ for some integer $n$. Then
$$\prod_{j\in S}(n - \eta_j) \in p\Z \subseteq pR\subseteq I_p.$$
Since $I_p$ is a prime ideal, we see that there exists $j\in S$ such that $n - \eta_j \in I_p$. Write $\bar{r}$ for the coset $r + I_p\in R/I_p$. In other words, $\bar{r}$ is the image of $r$ under the natural map $R\rightarrow R/I_p$. Then we have $\overline{\eta_j} = \bar{n}$. Since $n$ is an integer, we have $\bar{n}\in\F_p$. Hence $$\overline{\eta_j} \in\F_p \qquad\Longrightarrow\qquad \overline{\eta_j}^p = \overline{\eta_j}.$$ On the other hand,
$$\overline{\eta_j}^p = (\overline{mu}^p - \overline{\zeta_m}^{jp})(\overline{mu}^p - \overline{\zeta_m}^{jap}) = \overline{(mu - \zeta_m^{jp})(mu - \zeta_m^{jap})} = \overline{\eta_{jp}},$$
where the first equality holds because $R/I_p$ is a field of characteristic $p$. Hence we have $\eta_j - \eta_{jp}\in I_p$.

\begin{proposition}\label{prop:N}
    There exists a nonzero integer $N$ such that if $p\nmid N$, then for distinct $j,k\in S$, we have $\eta_j - \eta_k\notin I_p$.
\end{proposition}

We remark that this result is also similar to the statement that every nonzero integer is divisible by only finitely many primes.

\v
Let's see how everything follows from this result. From $\eta_j - \eta_{jp}\in I_p$, we see that: if $jp\in S$, then $jp = j$ and so $p\equiv 1\pmod{m}$; if $jp \in Sa$, then $jpa\in S$ and so $jpa = j$, implying that $p\equiv a^{-1}\equiv a\pmod{m}$. In other words, if $p\nmid N$ is a prime divisor of some $f(n)$, then $p$ is congruent to $1$ or $a$ mod $m$.


\vspace{5pt}
Suppose conversely that $p\equiv 1\mbox{ or }a\pmod{m}$ and $p\nmid N$. From $p = 1$ or $p=a$ in $(\Z/m\Z)^\times$, we have $$\overline{\eta_1} = \overline{\eta_{p}} = \overline{\eta_1}^p.$$ 
Hence $\overline{\eta_1}\in\F_p$. Let $n$ be an integer such that $\bar{n} = \overline{\eta_1}$. Then we have $n - \eta_1\in I_p$ and so $f(n) \in I_p$.

\begin{center}
    \add{Lecture 28 Wed 11/15}
\end{center}

\begin{lemma}
    Suppose $I$ is a prime ideal of a commutative ring $R_1$. Let $R_2$ be a subring of $R_1$. Then $I\cap R_2$ is a prime ideal of $R_2$. (Compare this with Exercise 9.\ref{exer:9.4} about maximal ideals.)
\end{lemma}

\begin{proof}
    It is easy to check that $I\cap R_2$ is a proper (because it doesn't contain $1$) ideal of $R_2$. Suppose $a,b\in R_2$ with $ab\in I\cap R_2$. Then from $ab\in I$, we have $a\in I$ or $b\in I$. So $a\in I\cap R_2$ or $b\in I\cap R_2$.
\end{proof}

As an immediate corollary, we have $I_p\cap \Z = p\Z$ since it is a prime ideal of $\Z$ containing $p$. Therefore, we have $p\mid f(n)$. 



What about $p^2\nmid f(n)$? Suppose we have $p^2\mid f(n)$ instead. Then
$$f(n + p) \equiv f(n) + pf'(n) \equiv pf'(n)\pmod{p^2}.$$
So if we have $p\nmid f'(n)$, then $p^2\nmid f(n+p)$ and we can take $n+p$ instead. Using the product rule, we have
$$f'(x) = \frac{d}{dx}\prod_{j\in S}(x - \eta_j) = \sum_{j\in S}\prod_{k\in S, k\neq j}(x - \eta_k) = \prod_{k\in S,k\neq 1}(x - \eta_k) + (x - \eta_1)(\cdots).$$
We set $x = n$. We know that $n - \eta_1\in I_p$ and $n - \eta_k\notin I_p$ for any $k\in S$ different from $1$ since $\eta_1 - \eta_k\notin I_p$. Then we have $f'(n) \notin I_p$ and so $p\nmid f'(n)$.



It now remains to prove Proposition \ref{prop:N}. Since $I_p$ is a prime ideal, we see that in order for each $\eta_j - \eta_k\notin I_p$, it is equivalent to require that $$\prod_{\substack{j, k\in S\\ j\neq k}} (\eta_j-\eta_k) \notin I_p.$$
The punchline is that this product is an integer $N$. By construction, the $\eta_j$ are distinct complex numbers, so $N\neq 0$. If a prime $p$ doesn't divide $N$, then $N\notin p\Z = I_p\cap \Z$. So $N\notin I_p$ and we are done!

We remark that since every element of $\Aut_\Q(\Q(\zeta_m))$ permutes $\eta_j$ for $j\in S$, their product is fixed by every element of $\Aut_\Q(\Q(\zeta_m))$. Hence using Galois theory, we immediately obtain this product is in $\Q$ and since it is also in $\Z[\zeta_m]$, we see that it is an integer.

Without Galois theory, we will use the theory of symmetric polynomials. We note that any permutation of the $\eta_j$'s leaves the above product unchanged.

\subsection*{Exercise}
\begin{enumerate}[\thesection .1]
    \item Prove that if $r\in\Q$ is an algebraic integer. Then $r\in\Z$.
    \item Prove that $\Q(\zeta_8) = \Q(\sqrt{2}, i).$
    \item Prove that $(\Z/8\Z)^\times\cong C_2\times C_2$ as groups.
    \item For which primes $p$ is $x^6 + x^3 + 1$ irreducible in $\F_p[x]$? For which primes $p$ does $x^6 + x^3 + 1$ have a root in $\F_p$?
    \item What are all the prime ideals of $\Z[\zeta_m]$ for some fixed $m\geq 2$?
    \item Let $m\geq2$ be an integer. Prove that $$\prod_{1\leq i < j\leq m} (\zeta_m^i - \zeta_m^j)^2 = (-1)^{(m-1)(m+2)/2}m^m.$$\label{exer:15.6}
    \item Suppose $f(x)\in\Z[x]$ is a monic polynomial dividing $x^m - 1$ for some $m\geq 2$. Let $p$ be a prime not dividing $m$ and let $\zeta$ be a root of $f(x)$. Let $R = \Z[\zeta_m]$ and let $I_p$ be a prime ideal of $R$ containig $p$.
    \begin{enumerate}
        \item Prove that $f(\zeta^p)\in I_p.$
        \item Prove that if $f(\zeta^p)\neq 0$, then $f(\zeta^p)\mid m^m$ in $R$. Conclude that $f(\zeta^p) = 0$.
    \end{enumerate}
    This gives another proof of Proposition \ref{prop:zeta^p}.
\end{enumerate}

\section{Symmetric polynomials}
Let $R$ be a commutative ring. Then we have the polynomial ring $R[x_1,\ldots.x_n]$ in $n$-variables with coefficients in $R$. One can also view this as formed from $R$ inductively via
$$R[x_1,\ldots.x_n] = R[x_1,\ldots,x_{n-1}][x_n].$$
Given any bijection $\sigma:\{1,\ldots,n\}\rightarrow\{1,\ldots,n\}$ and any $f\in R[x_1,\ldots,x_n]$, we define
$$\sigma(f)(x_1,\ldots,x_n) = f(x_{\sigma(1)},\ldots,x_{\sigma(n)}).$$
We say $f(x_1,\ldots,x_n)$ is \textbf{symmetric} in $x_1,\ldots,x_n$ if $$\sigma(f) = f$$ for any such $\sigma$. Here are some examples of symmetric polynomials in $3$ variables:
$$1, \qquad x_1 + x_2 + x_3, \qquad x_1^2 + x_2^2 + x_3^2, \qquad x_1x_2 + x_1x_3 + x_2x_3$$
$$x_1^3+x_2^3+x_3^3,\qquad x_1^2x_2 + x_2^2x_1 + x_2^2x_3 + x_3^2x_2 + x_1^2x_3 + x_3^2x_1,\qquad x_1x_2x_3.$$
The \textbf{elementary symmetric polynomials} are defined as 
$$s_k(x_1,\ldots,x_n) = \sum_{1\leq i_1 < \cdots < i_k \leq n}x_{i_1}\cdots x_{i_k}.$$
For example,
\begin{eqnarray*}
    s_1(x_1,x_2,x_3) &=& x_1 + x_2 + x_3\\
    s_2(x_1,x_2,x_3) &=& x_1x_2 + x_1x_3 + x_2x_3\\
    s_3(x_1,x_2,x_3) &=& x_1x_2x_3
\end{eqnarray*}
Alternatively, we let $$P(t) = (t - x_1)\cdots(t - x_n) \in R[x_1,\ldots,x_n][t].$$
Then $(-1)^ks_k(x_1,\ldots,x_n)$ is the coefficient of $t^{n-k}$ in $P(t)$.

\begin{theorem}\label{thm:elem}
    If $f(x_1,\ldots,x_n)\in R[x_1,\ldots,x_n]$ is symmetric in $x_1,\ldots,x_n$, then there exists a polynomial $g\in R[x_1,\ldots,x_n]$ such that $f(x_1,\ldots,x_n) = g(s_1,\ldots,s_n).$
\end{theorem}
For example, we have
$$x_1^2 + x_2^2 + x_3^2 = (x_1+x_2+x_3)^2 - 2(x_1x_2+x_1x_3+x_2x_3) = s_1^2 - 2s_2.$$
\begin{proof}
    We induct on $n$ and the degree of $f$ viewed as a polynomial in $x_1$ with coefficient in $R[x_2,\ldots,x_n]$. The base case $f(x_1) = cx_1$ is trivial. Suppose we are in the general case. Then $f(x_1,\ldots,x_{n-1},0)$ is symmetric in $x_1,\ldots,x_{n-1}$ and so by induction, there exists $j \in R[x_1,\ldots,x_{n-1}]$ such that
    $$f(x_1,\ldots,x_{n-1},0) = j(s_1(x_1,\ldots,x_{n-1}),\ldots,s_{n-1}(x_1,\ldots,x_{n-1})).$$
    We observe that
    $$s_k(x_1,\ldots,x_{n-1}) = s_k(x_1,\ldots,x_{n-1},0).$$
    Hence $$f(x_1,\ldots,x_{n}) - j(s_1(x_1,\ldots,x_{n}),\ldots, s_{n-1}(x_1,\ldots,x_{n}))$$
    is a polynomial that vanishes when $x_n = 0$. Hence every term has an $x_n$ in it. Since it is symmetric in $x_1,\ldots,x_n$, every term has $x_1\cdots x_n$ in it. Let $h\in R[x_1,\ldots,x_n]$ be a polynomial such that
    $$f(x_1,\ldots,x_{n}) - j(s_1(x_1,\ldots,x_{n}),\ldots, s_{n-1}(x_1,\ldots,x_{n})) = x_1\cdots x_nh(x_1,\ldots,x_n).$$
    Then $h$ is symmetric in $x_1,\ldots,x_n$ of degree than less than $\deg(f)$. So by induction, there exists $k\in R[x_1,\ldots,x_n]$ such that
    $$h(x_1,\ldots,x_n) = k(s_1(x_1,\ldots,x_{n}),\ldots,s_n(x_1,\ldots,x_{n})).$$
    Then we have
    $$f(x_1,\ldots,x_{n}) = j(s_1,\ldots,s_{n-1}) + s_nk(s_1,\ldots,s_n)$$
    is a polynomial in $s_1,\ldots,s_n$.
\end{proof}


%\noindent\textbf{Remark}: The above induction argument also shows that the polynomial $g$ is unique.

\vspace{5pt}
An important example is the polynomial
$$\Delta(x_1,\ldots,x_n) = \prod_{1\leq i < j\leq n}(x_i - x_j)^2 = (-1)^{n(n-1)/2}\prod_{i\neq j}(x_i - x_j) \in\Z[x_1,\ldots,x_n].$$% = (-1)^{n(n+1)/2}.$$
of the product of the difference of the variables, when $n\geq 2$. For example,
$$\Delta(x_1,x_2) = (x_1 - x_2)^2 = (x_1 + x_2)^2 - 4x_1x_2.$$
Since $\Delta(x_1,\ldots,x_n)$ is symmetric in $x_1,\ldots,x_n$, there is a unique polynomial $G \in \Z[x_1,\ldots,x_n]$ such that $$\Delta(x_1,\ldots,x_n) = G(s_1,\ldots,s_n).$$
Now given any polynomial $f(x) = x^n + c_1x^{n-1} + \cdots + c_n \in R[x]$, we define its \textbf{discriminant}
$$\Delta(f) = G(-c_1, c_2,\ldots,(-1)^nc_n) \in R.$$
\begin{center}
    \add{Lecture 29 Fri 11/17}
\end{center}
Suppose now $R = F$ is a field. Let $E/F$ be a splitting field of $f(x)$. In other words, there exist $\alpha_1,\ldots,\alpha_n\in E$ such that $$f(x) = (x - \alpha_1)\cdots (x - \alpha_n).$$
Then we have for $k = 1,\ldots,n$, $$c_k = (-1)^ks_k(\alpha_1,\ldots,\alpha_n).$$
Then
$$\Delta(f) = G(s_1(\alpha_1,\ldots,\alpha_n),\ldots,s_n(\alpha_1,\ldots,\alpha_n)) = \prod_{1\leq i < j\leq n}(\alpha_i - \alpha_j)^2.$$
Hence $\Delta(f) = 0$ if and only if $f(x)$ has repeated roots in some extension of $F$. We note that the polynomial $G$ has integer coefficients. This means that if $f(x)\in\Z[x]$ with $\Delta(f)\in\Z$, then $\pi_p(f(x))\in\F_p[x]$ and $$\Delta(\pi_p(f)) = \pi_p(\Delta(f)).$$
So $f(x)$ has repeated roots in some extension of $\F_p$ if and only if $p\mid \Delta(f)$.

\begin{comment}
\begin{cor}
    Suppose $f(x)\in R[x]$ is a monic polynomial over a commutative ring $R$. Let $F$ be any field and let $\pi:R\rightarrow F$ be a homomorphism. Then $\pi(f)\in F[x]$ has repeated roots in some extension of $F$ if and only if $\pi(\Delta(f)) = 0$. 
\end{cor}

\begin{proof}
    The key observation here is that the defining polynomial $G$ has coefficients in $\Z$, so that it is ``fixed'' by any ring homomorphism. It is then easy to check that $\Delta(\pi(f)) = \pi(\Delta(f))$ in $F$.
\end{proof}
\end{comment}

%Returning to our example of $$f(x) = \prod_{j\in S}(x -\eta_j)\in\Z[x].$$
%Its discriminant $\Delta(f)$ is some integer $D$. Since the $\eta_j$'s are distinct in $\C$, we know that $D\neq 0$. If $p\nmid D$ is some prime, then $\Delta(f)\notin p\Z = I_p \cap \Z$. Since $\Delta(f)$ is a product of elements of the $\eta_j - \eta_k$ for any distinct $j,k\in S$, we see that $\eta_j - \eta_k\notin I_p$ for any distinct $j,k\in S$. We have now completed the proof of Schur's result stated three weeks ago! %Alternatively, since $\Delta(f)\notin I_p$, we see that it is nonzero under the map $\Z\rightarrow \Z[\zeta_m]/I_p$ and so $f(x)$ has no repeated roots in any extension of the field $\Z[\zeta_m]/I_p$. Since

Recall that $x^m - 1$, and its divisor $\Phi_m(x)$, have no repeated factors mod $p$ for any prime $p\nmid m$. This means that discriminants can only be divisible by the primes divisors of $m$. In fact,
\begin{eqnarray*}
    \Delta(x^m - 1) &=& (-1)^{(m-1)(m+2)/2}m^m,\\
    \Delta(\Phi_m(x)) &=& (-1)^{\phi(m)/2}\prod_{p\mid m}p^{\phi(m)(\nu_p(m) - \frac{1}{p-1})},\mbox{ if }m\geq3.
\end{eqnarray*}
The computation of $\Delta(x^m - 1)$ is Exercise 15.\ref{exer:15.6}. The computation of $\Delta(\Phi_m(x))$ when $m = p$ is a prime follows similarly. The more general case is beyond the scope of this course.
Note that when $m = p$ is an odd prime, we have
$$\Delta(\Phi_p(x)) = (-1)^{(p-1)/2}p^{p-2} = p^*(p^{(p-3)/2})^2.$$
From the definition of $\Delta$, we see that
$$\Delta(\Phi_p(x)) = \left(\prod_{1\leq i < j \leq p-1}(\zeta_p^i - \zeta_p^j)\right)^2$$
is a square in $\Q(\zeta_p)$. In other words, $p^*$ is a square in $\Q(\zeta_p)$. This explains why it was more natural to try to find a square root of $p^*$ when we proved quadratic reciprocity. 

In terms of Galois theory, we see that $\Q(\zeta_p)$ contains the quadratic field $\Q(\sqrt{p^*})$ of $\Q$. The automorphism group $\Aut_\Q(\Q(\zeta_p))\cong(\Z/p\Z)^\times = \F_p^\times$ is cyclic of order $p-1$. It has a unique subgroup of order $(p-1)/2$, whose fixed field is a quadratic extension of $\Q$ contained in $\Q(\zeta_p)$. In other words, $\Q(\sqrt{p^*})$ is the unique quadratic extension of $\Q$ contained in $\Q(\zeta_p)$. 

\subsection*{Exercise}
\begin{enumerate}[\thesection .1]
    \item Express $x_1^3 + x_2^3 + x_3^3$ and $x_1^4 + x_2^4 + x_3^4$ in terms of the elementary symmetric polynomials in $x_1, x_2, x_3$.
    \item Prove that the polynomial $g$ in Theorem \ref{thm:elem} is unique.
    \item Find the formula for $\Delta(x^2 + bx + c)$ and $\Delta(x^3 + ax^2 + bx + c).$
    \item Prove that $\Delta(x^n + c_1x^{n-1} + \cdots + c_{n-1}x) = c_{n-1}^2\Delta(x^{n-1} + c_1x^{n-2} + \cdots + c_{n-1})$.
    \item Let $f(x) = x^n + c_1x^{n-1} + \cdots + c_{n-1}x + c_n\in\Z[x]$ be a polynomial of degree $n\geq 2$. Let $p$ be a prime. Suppose that $p^2\mid c_n$ and $p\mid c_{n-1}$. Prove that $p^2\mid\Delta(f)$.
    \item Prove that for any monic polynomial $f(x) = x^n + c_1x^{n-1} + \cdots + c_n\in\C[x]$ with roots $\alpha_1,\ldots,\alpha_n$, we have $$\Delta(f) = (-1)^{n(n-1)/2}\prod_{i=1}^n f'(\alpha_i).$$
    \item Consider the polynomial $f(x) = x^n + ax + b\in\C[x]$. Prove that 
    $$\Delta(x^n + ax + b) = (-1)^{n(n-1)/2}(n^nb^{n-1} - (n-1)^{n-1}(-a)^n).$$
\end{enumerate}


\section{RSA and Shor's algorithm}

In the previous 3 weeks, the assumption $a^2\equiv 1\pmod{m}$ was very important. How many $a$ mod $m$ are there satisfying this condition? Clearly, if $a\equiv \pm1\pmod{m}$, then $a^2\equiv 1\pmod{m}$. We say $a$ is a nontrivial solution to $x^2\equiv 1\pmod{m}$ if $a$ is a solution that is not congruent to $\pm1$ mod $m$. When do they exist?

\begin{lemma}
    For any positive integer $m$, let $s(m)$ denote the number of integers $a =1,\ldots, m$ such that $a^2\equiv 1\pmod{m}$. Let $m = p_1^{k_1}\cdots p_r^{k_r}$ be the prime factorization of $m$. Then
    $$s(m) = s(p_1^{k_1})\cdots s(p_r^{k_r}).$$
    Moreover, if $p$ is an odd prime and $k\in\N$, then $s(p^k) = 2$ and
    $$s(2^k) = \begin{cases}
        1&\mbox{ if }k=1\\
        2&\mbox{ if }k=2\\
        4&\mbox{ if }k\geq3.
    \end{cases}$$
\end{lemma}

\begin{proof}
    The factorization of $s(m)$ follows from the Chinese Remainder Theorem. Suppose now $p$ is an odd prime and $p^k\mid a^2 - 1$. Then $p^k\mid (a+1)(a-1)$. Since $\gcd(a+1,a-1)\mid 2$, we see that $a+1$ and $a-1$ can't both be divisible by $p$. So either $p^k\mid a+1$ or $p^k\mid a-1$. Hence the solutions to $x^2\equiv 1\pmod{p^k}$ are $1$ and $p^k-1$.

    Suppose now $p = 2$. The cases $k = 1$ and $k=2$ can be checked directly. Suppose now $k\geq 3$. Then both $a+1$ and $a-1$ are even. So $\gcd(a+1, a-1) = 2$. Hence either $2\mid a+1$ and $2^{k-1}\mid a-1$; or $2\mid a-1$ and $2^{k-1}\mid a+1$. Since $a+1$ and $a-1$ have the parity, the division by $2$ condition is automatic. So we have $a\equiv\pm1\pmod{2^{k-1}}.$ Hence, we have four solutions mod $2^k$, namely $1$, $2^{k-1}-1$, $2^{k-1}+1$, $2^k-1$.
\end{proof}

\begin{cor}
    We have $s(m) = 2$ if and only if $m = 4, p^k$ or $2p^k$ for odd prime $p$. In particular, if $m$ is odd, then a nontrivial solution exists if and only if $m$ has at least $2$ distinct prime factors.
\end{cor}

This forms the basis for Shor's factorization algorithm. Note that if $m = p_1^{k_1}\cdots p_r^{k_r}$ and $a$ is a nontrivial solution. Then each $p_i^{k_i}$ divides $a-1$ or $a+1$. Hence we have a divisor of $m$ by computing $\gcd(m, a-1)$ and $\gcd(m, a+1)$. In fact $m = \gcd(m, a-1)\gcd(m, a+1)$. Computing gcd using the Euclidean algorithm is very fast. The number of arithmetic operations needed is bounded by some polynomial in the number of digits of $n$. We say that computing gcd can be done in \textbf{polynomial time}. Here is Shor's algorithm for finding a nontrivial solution.
\begin{enumerate}
    \item Pick $b = 1,\ldots,m-1$ at random.
    \item Compute $\gcd(b,m)$. If $\gcd(b,m) > 1$, then it is a nontrivial divisor of $m$ and we are done.
    \item Suppose $\gcd(b,m) = 1$. Compute $d = o_m(b)$. Then $b^d\equiv 1\pmod{m}$.
    \item If $d$ is odd, go back to step 1. If $d$ is even, then $b^{d/2}$ is a solution to $x^2\equiv 1\pmod{m}$. If $b^{d/2}\equiv \pm 1\pmod{m}$, then go back to step 1. If $b^{d/2}\not\equiv \pm 1\pmod{m}$, then we have found a nontrivial solution. (Note that $b^{d/2}\equiv  1\pmod{m}$ is not possible since $d = o_m(b)$.)
\end{enumerate}
You will prove in HW11 that when $m$ has at least 2 odd prime divisors, there are at most $\frac12\phi(m)$ elements $b\in(\Z/m\Z)^\times$ such that $o_m(b)$ is odd or $b^{o_m(b)/2}\equiv -1\pmod{m}$. This means that for a randomly chosen $b$, there is at least a $50\%$ probability that it produces a nontrivial divisor of $m$. Hence the probability that no answer is found after $k$ iterations is at most $1/2^k$. For $k\geq 80$, this is less than $10^{-24}$ which is roughly the probability that a calculation error occurs from a cosmic ray hitting the cpu flipping a bit. 

\begin{center}
    \add{Lecture 30 Mon 11/20}
\end{center}

There are two important computations in Shor's algorithm: computing $o_m(b)$; and computing $b^{d/2}\pmod{m}$. The latter (also known as discrete exponentiation), can be done very quickly using the Square and Multiply method. For example, suppose we want to calculate $452^{1563}$ mod $2023$. Then we first express the exponent $1563$ as a sum of powers of $2$, which it already was when working with a computer:
    $$1563 = 1024 + 512 + 16 + 8 + 2 + 1.$$
    Then we square $452$ repeatedly to find
    $$452, 452^2, 452^4, 452^8,\ldots, 452^{1024}\pmod{2023}.$$
    Note that before computing the next square, we first reduce mod $2023$, so that every step is simply the square of a number at most $2023$. Finally we multiply the ones that show up in the binary representation of $1563$.

The former of finding $o_m(b)$ (also known as discrete logarithm) is very slow on a classical computer but can be done in polynomial time on a quantum computer. A quantum computer can compute $b^n$ mod $m$ for all non-negative integers $n < m$ at the same time, using the fact that a qubit can be $0$ and $1$ at the same time. In the above example, we can use $11$ qubits to store $452^{2^k\cdot(0\text{ or }1)}\text{ mod }2023$ for $k = 0,\ldots,10$. Then multiplying them together to find $452^n\text{ mod }2023$ at the same time for $n = 0,\ldots,2047$.  However, it will be a superposition of states $|n, b^n\mbox{ mod }m\rangle$. Measuring the first registry gives a random $n_0$ and the value $b^{n_0}\mbox{ mod }m$. Measuring the second registry gives a random $c_0$ and a superposition of states $|n\rangle$ such that $b^n\equiv c_0\pmod{m}$.

    The key is that there is a hidden period in this. In other words, the integers $n$ such that $b^n\equiv c_0\pmod{m}$ are of the form
    $$n_1, n_1 + o_m(b), n_1 + 2o_m(b), \ldots$$
 Quantum Fourier Transform can be used to find this hidden period.


\vspace{5pt}
One does not teach a first year intro to number theory course without mentioning RSA. \add{(See also slides on RSA.)} RSA (Rivest-Shamir-Adleman) is a public-key cryptosystem, one of the oldest, that is widely used for secure data transmission. Let's discuss its setup:
\begin{enumerate}
    \item Pick two large distinct primes $p$ and $q$, say on the order of $2^{1024}$ or approximately $300$ digits.
    \item Let $n = pq$ so that $\phi(n) = (p-1)(q-1)$.

    Then for any integer $M$ coprime to $n$, we have $M^{\phi(n)}\equiv 1\pmod{n}$. Now if $N\equiv 1\pmod{\phi(n)}$, then $N = 1 + \phi(n)k$ for some $k\in\Z$ so
    $$M^N = M\cdot M^{\phi(n)k} \equiv M\pmod{n}.$$
    \item Pick an integer $d$ coprime to $\phi(n)$.

    Then there exist integers $e,t$ such that $de + t\phi(n)=1$. The integer $e$ can be easily found using the (Extended) Euclidean algorithm. Note that for any integer $M$ coprime to $n$,
    $$de \equiv 1\pmod{\phi(n)} \qquad\Longrightarrow\qquad M^{de}\equiv M\pmod{n}.$$
    \item Publish $(e,n)$ as the public key. Keep $(d,n)$ (and $p$, $q$) hidden as the private key. It is also customary to replace $e$ and $d$ by their remainders mod $\phi(n)$.
\end{enumerate}
Now when someone wants to send a message $M$ to me, they would take my $(e,n)$ and compute $$C \equiv M^e\pmod{n}$$
and send $C$ to me. When we receive $C$, we can recover $M$ mod $n$ via
$$C^d\equiv M^{de} \equiv M\pmod{n}.$$
If we further require that $M = 1,\ldots, n$, for example by restricting the size of the message or by breaking it up into multiple messages, we would recover $M$ exactly.

\vspace{5pt}
The security of RSA relies on the following:
\begin{enumerate}
    \item Given the public key $(e,n)$, it is practically impossible to find the private key $(d,n)$.

    Note that we can find $d$ by solving $ex\equiv 1\pmod{\phi(n)}$ but this requires finding $p$ and $q$ so we can compute $\phi(n) = (p-1)(q-1)$. In other words, factorization should be hard.
    \item Given the message $M$ and the encrypted $C$, it is practically impossible to find $d$ such that $M\equiv C^d\pmod{n}$.

    This problem is known as discrete logarithm.
\end{enumerate}
In the above, practically impossible means that the current best algorithm would take longer than say 100 years to complete. These algorithms' runtime are exponential in $\log n$, which is basically the number of bits that $n$ has. Even something like $e^{100}$ is already more than $10^{43}$.

\vspace{5pt}
The efficiency of RSA relies on the ability to compute $M^e\pmod{n}$ and $C^d\pmod{n}$ in polynomial time, which we have already seen. It should also be ``easy'' to generate primes. The traditional sieve of Eratosthenes produces all the primes, but is too slow to generate $300$ digit primes. From the prime number theorem, we know that roughtly 1 out of $\log n$ numbers up to $n$ are primes. So it is much more efficient to take a bunch of random large numbers and test for primality.

For the rest of the semester, we will discuss:
\begin{enumerate}
    \item Fermat and Miller-Rabin primality tests. These are polynomial time but probabilistic. However, similar to Shor's algorithm, the chance of them failing is lower than the chance of computation error.
    \item AKS primality test. This is deterministic and in polynomial time. 
    \item Lucas-Lehmer primality test. This only works for Mersenne primes $2^p - 1$.
    \item The cyclotomic fields $\Q(\zeta_3)$ and $\Q(\zeta_4)$ and $x^3 + y^3 = z^3$.
\end{enumerate}

\begin{comment}

It turns out that factorization can be reduced to the discrete logarithm problem! First we note that it is easy to check if a positive integer is a perfect power. If $n = a^k$ for some $a,k\geq2$, then $k\leq \log_2 n$. For each $k\leq\log_2n$, we can do a binary search to see if $n = a^k$ for some integer $a$. Here is the algorithm:
\begin{enumerate}
    \item Set $a_L = 2$ and $a_H = n-1$. So any solution will lie in $[a_L, a_H]$.
    \item Let $c = (a_L + a_H)/2$.
    \item If $c^k = n$, then we are done. If $c^k > n$, then $c$ is too big and we replace $a_H$ by $c$. If $c^k < n$, then $c$ is too small and we replace $a_L$ by $c$. Go back to step 2. 
\end{enumerate}
Suppose we have tested that $n$ is not a prime power. The key idea is to consider the congruence equation $x^2\equiv 1\pmod{n}$. It always has $\pm1$ as solutions. A nontrivial solution is an integer $a$ such that $a^2\equiv 1\pmod{n}$ but $a\not\equiv\pm1\pmod{n}$.

\begin{lemma}
    Let $n>1$ be an odd integer with at least $2$ prime divisors. The equation $x^2\equiv 1\pmod{n}$ has a nontrivial solution. Let $a$ be one such solution. Then $\gcd(a+1,n)$ and $\gcd(a-1,n)$ are divisors of $n$ different from $1$ or $n$.
\end{lemma}

\begin{proof}
    There is a factorization of $n$ as $dk$ where $\gcd(d,k) = 1$ and $d,k > 2$. By the Chinese Remainder Theorem, there exists an integer $a$ such that $a\equiv -1\pmod{d}$ and $a\equiv 1\pmod{k}$. Since $d,k>2$, we see that $a\not\equiv 1\pmod{d}$ and $a\not\equiv -1\pmod{k}$. Hence $a\not\equiv\pm1\pmod{n}$. However, $a^2\equiv 1\pmod{d}$ and $a^2\equiv 1\pmod{k}$ and so $a^2\equiv 1\pmod{n}$.

    The second statement is clear from $n\mid (a-1)(a+1)$ and $n\nmid a-1$ and $n\nmid a+1$ using prime factorization. In fact, we have $n = \gcd(a+1,n)\gcd(a-1,n)$. The proof is left as an exercise.
\end{proof}


\vspace{5pt}
How to find a nontrivial solution?
\begin{enumerate}
    \item Pick $b = 1,\ldots,n-1$ at random.
    \item Compute $\gcd(b,n)$. If $\gcd(b,n) > 1$, then it is a nontrivial divisor of $n$.
    \item Suppose $\gcd(b,n) = 1$. Compute $d = o_n(b)$. Note this is basically solving the discrete logarithm problem $b^d\equiv 1\pmod{n}$.
    \item If $d$ is odd, go back to step 1. If $d$ is even, then $b^{d/2}$ is a solution to $x^2\equiv 1\pmod{n}$. If $b^{d/2}\equiv \pm 1\pmod{n}$, then go back to step 1. If $b^{d/2}\not\equiv \pm 1\pmod{n}$, then we have found a nontrivial solution. (Note that $b^{d/2}\equiv  1\pmod{n}$ is not possible since $d = o_n(b)$.)
\end{enumerate}
You will prove in HW11 that when $n$ has at least 2 odd prime divisors, there are at most $\frac12\phi(n)$ elements $b\in(\Z/n\Z)^\times$ such that $o_n(b)$ is odd or $b^{o_n(b)/2}\equiv -1\pmod{n}$. This means that for a randomly chosen $b$, there is at least a $50\%$ probability that it produces a nontrivial divisor of $n$. Hence the probability that no answer is found after $k$ iterations is at most $1/2^k$. For $k\geq 80$, this is less than $10^{-24}$ which is roughly the probability that a cosmic ray flipping a bit in the computer causing a calculation error. So as long as each iteration is polynomial in the number of digits of $n$, then we are in good shape. 

\vspace{5pt}
What can a quantum computer do?
\begin{enumerate}
    \item It can compute $b^m$ mod $n$ for all non-negative integers $m < n$ at the same time.

    However, it will be a superposition of states $|m, b^m\mbox{ mod }n\rangle$. Measuring the first registry gives a random $m_0$ and the value $b^{m_0}\mbox{ mod }n$. Measuring the second registry gives a random $c_0$ and a superposition of states $|m\rangle$ such that $b^m\equiv c_0\pmod{n}$.

    The key is that there is a hidden period in this. In other words, the integers $m$ such that $b^m\equiv c_0\pmod{n}$ are of the form
    $$m_0, m_0 + o_n(b), m_0 + 2o_n(b), \ldots$$
    \item Quantum Fourier Transform can be used to find this hidden period.
\end{enumerate}

A similar method can be used for the general discrete logarithm problem: given $M$, $C$ and $n$, find $d$ such that $M\equiv C^d\pmod{n}$. We use a two variable version of the above. 
\begin{enumerate}
    \item Compute $M^\alpha C^{-\beta}$ mod $n$ for all non-negative integers $\alpha,\beta < o_n(C)$ at the same time.

    We get a superposition of $|\alpha, \beta, M^\alpha C^{-\beta}\mbox{ mod }n\rangle.$ Measuring the third registry gives a random $c_0$ and superposition of states $|\alpha,\beta\rangle$ such that $M^\alpha C^{-\beta}\equiv c_0\pmod{n}.$ These pairs of integers $(\alpha,\beta)$ are of the form
    $$(\alpha_0,\beta_0), (\alpha_0 + 1, \beta_0 + d), (\alpha_0 + 2, \beta_0 + 2d), \ldots$$
    \item Apply QFT.
\end{enumerate}

\subsection*{Exercises}
\begin{enumerate}[\thesection .1]
    \item Prove that if $n$ is an odd prime power, then $x^2 \equiv 1\pmod{n}$ if and only if $x\equiv\pm1\pmod{n}$.
    \item Suppose $n = pq$ is a product of two distinct odd primes. Find the number of $b\in (\Z/n\Z)^\times$ such that $o_n(b)$ is odd or $b^{o_n(b)/2}\equiv -1\pmod{n}$.
\end{enumerate}
\end{comment}


\begin{center}
    \add{Lecture 31 Wed 11/22}
\end{center}

\section{Probabilistic primality test}
In this section, we consider two probabilistic primality tests, the Fermat test and the Miller-Rabin test. They both build upon Fermat's little theorem: $a^{p-1}\equiv 1\pmod{p}$ if $p$ is a prime and $a = 1,\ldots,p-1$.

\begin{lemma}
    If $a^{n-1}\equiv 1\pmod{n}$ for every $a = 1,\ldots,n-1$, then $n$ is a prime.
\end{lemma}

\begin{proof}
    Every $a = 1,\ldots,n-1$ is invertible in $\Z/n\Z$.
\end{proof}

It is not practical to test all integers less than $n$ (we might as well just check for division in this case). So we use the same probabilistic idea as in Shor's algorithm: 
\begin{enumerate}
    \item Pick $a = 1,\ldots,n-1$ at random.
    \item Compute $\gcd(a,n)$. If it is bigger than $1$, then $n$ is not a prime.
    \item Compute $a^{n-1}$ mod $n$. If it is not $1$, then $n$ is not a prime. Otherwise, return to step 1.
\end{enumerate}
Let $$F_n = \{a\in (\Z/n\Z)^\times \colon a^{n-1} = 1\}.$$
We need to know how big $F_n$ is in order to know the probability that a randomly chosen $a$ can be used to prove that $n$ is not a prime.

\begin{lemma}
    The set $F_n$ is a subgroup of $(\Z/n\Z)^\times$.
\end{lemma}

\begin{proof}
    Clearly $1\in F_n$. If $a,b\in F_n$, then $(ab)^{n-1} = a^{n-1}b^{n-1} = 1$ and $(a^{-1})^{n-1} = (a^{n-1})^{-1} = 1$. 
\end{proof}

Since the order of a subgroup divides the order of the group, we see that if $F_n\neq(\Z/n\Z)^\times$, then $|F_n| \leq \frac12\phi(n)$ and we have a probability of at least $1/2$ that a randomly chosen $a$ can be used to prove that $n$ is not a prime. Unfortunately, there exists (infinitely many) odd composite numbers $n$ where $F_n = (\Z/n\Z)^\times$. These numbers are called \textbf{Carmichael} numbers. The smallest Carmichael number is $561 = 3\cdot 11\cdot 17.$ If we attempt to run the Fermat test on a Carmichael number, then we are just hoping to hit integers $a$ that share a prime factor with $n$. If $n$ is a product of very few large primes, we are in trouble. Carmichael numbers are all squarefree and so have at least 2 distinct prime divisors. In HW11, you will show that they have at least 3 distinct prime divisors.

\begin{proposition}
    If $p^2\mid n$ for some prime $p\geq 3$, then $n$ is not a Carmichael number.
\end{proposition}

\begin{proof}
    The key observation is that $$(1 + p)^{n-1} = 1 + (n-1)p + \sum_{r=2}^{n-1}\binom{n-1}{r}p^r\equiv 1 + (n-1)p\pmod{p^2}.$$
    Since $p\mid n$, we have $p\nmid n-1$ and so $(1+p)^{n-1}\not\equiv 1\pmod{p^2}$. Hence $(1+p)^{n-1}\not\equiv 1\pmod{n}$.
\end{proof}

The Miller-Rabin test builds upon this idea and the earlier idea of nontrivial solutions of $x^2\equiv 1\pmod{n}$. Since $n$ is assumed to be odd, we write $n - 1 = u\cdot 2^k$ where $u$ is odd and $k\in\N$. Let $$b_0\equiv a^u\pmod{n}, \qquad b_i\equiv b_{i-1}^2\equiv a^{u\cdot 2^{i}}\pmod{n}\mbox{ for }i = 1,\ldots,k.$$
%Suppose $b_0\not\equiv 1\pmod{n}$ and $b_i\not\equiv -1\pmod{n}$ for all $i = 0,\ldots,k-1$. If $b_k\not\equiv 1\pmod{n}$, then we get $n$ is not a prime from the Fermat test. If $b_k\equiv1\pmod{n}$, then we let $\ell\geq1$ be the largest index such that $b_\ell\equiv 1\pmod{n}$. Now $b_{\ell-1}\not\equiv\pm1\pmod{n}$ and $b_{\ell-1}^2\equiv 1\pmod{n}$. If $n$ is prime, then from $n\mid (b_{\ell-1}-1)(b_{\ell-1}+1)$, we have $n\mid b_{\ell-1}-1$ or $n\mid b_{\ell-1}+1$, and so $b_{\ell-1}\equiv \pm1\pmod{n}$. Contradiction. 

Here is the algorithm for the Miller-Rabin test
\begin{enumerate}
    \item Pick $a = 1,\ldots,n-1$ at random.
    \item Compute $\gcd(a,n)$. If it is bigger than $1$, then $n$ is not a prime.
    \item Compute $b_0\equiv a^u$ mod $n$. If $b_0\equiv 1$ mod $n$, return to step 1.
    \item Repeatedly compute $b_{i+1}\equiv b_i^2$ mod $n$. If $-1$ mod $n$ is reached before $1$ mod $n$, return to step 1. If $1$ mod $n$ is reached before $-1$ mod $n$, then $n$ is not prime because we have a nontrivial solution to $x^2\equiv 1\pmod{n}$. If none of $b_0,\ldots, b_{k-1}$ equals $-1$ mod $n$, then $n$ is not a prime.
\end{enumerate}
We now consider the bad set for the Miller-Rabin test. Let 
$$M_n = \{a\in(\Z/n\Z)^\times\colon a^u = 1\mbox{ or }a^{u2^i} = -1\mbox{ for some }i=0,\ldots,k-1\}.$$
For any $a\in M_n$, if $a^u = 1$, we set $i(a) = -1$; otherwise, we set $i(a)$ to be the integer $i = 0,\ldots,k-1$ such that $a^{u2^i} = -1$. Note that $(-1)^u = -1$ and $(-1)^{2u} = 1$ and so $i(-1) = 0$. Let $j\leq k-1$ be the largest $i(a)$ over $a\in M_n$. Then $j\geq i(-1) = 0$. For any $a\in M_n$, since $i(a)\leq j$, we have $a^{u2^j} = \pm 1$. In other words, $M_n$ is a subset of
$$E_n = \{a\in (\Z/n\Z)^\times\colon a^{u\cdot2^j} = \pm 1\}.$$ 
It is easy to see that $E_n$ is a subgroup of $(\Z/n\Z)^\times$.

\begin{proposition}
    Suppose $n$ is a positive odd number with at least two distinct prime divisors (for example if $n$ is a Carmichael number). Then $E_n$ is a proper subgroup of $(\Z/n\Z)^\times$. As a result, $|M_n|/\phi(n) \leq\frac12.$
\end{proposition}

\begin{proof}
    We write $n = m_1m_2$ where $m_1$ and $m_2$ are coprime odd integers. Let $a_0\in M_n$ with $i(a_0) = j$. Then $a_0^{u2^j} = -1$ in $(\Z/n\Z)^\times$. By the Chinese Remainder Theorem, there exists an integer $a$ such that \begin{eqnarray*}
        a&\equiv& a_0\pmod{m_1}\\
        a&\equiv&1\pmod{m_2}.
    \end{eqnarray*}
    Then $a^{u\cdot2^j}$ is $-1$ mod $m_1$ and $1$ mod $m_2$. So it can't be $\pm1$ mod $m_1m_2$. Hence $a\notin E_n$.
\end{proof}

\section*{Exercises}
\begin{enumerate}
    \item Let $G$ be a finite group and let $H$ be a non-empty subset. Prove that if $\forall a,b\in H, ab\in H$, then $H$ is a subgroup.
    \item Let $n$ be an odd positive integer. Let $$F_n = \{a\in(\Z/n\Z)^\times\colon a^{(n-1)/2} = \lg{a}{n}\}$$
    where $\lg{a}{n}$ is the Jacobi symbol. Prove that $F_n$ is a subgroup of $(\Z/n\Z)^\times$, and that it is a proper subgroup when $n$ is composite.

    Since the Jacobi symbols can be quickly computed using quadratic reciprocity (see HW 7 Problem 2), this gives another probabilistic primality test (Solovay-Strassen) with polynomial runtime.
    \item Let $n>1$ be an integer. Let $a\in\N$ and let $p$ be a prime number such that:
    \begin{itemize}
        \item $a^{n-1}\equiv 1\pmod{n}$;
        \item $p\mid n-1$ and $p>\sqrt{n}-1$;
        \item $\gcd(a^{(n-1)/p}-1, n) = 1$.
    \end{itemize}
    Prove that $n$ is a prime.

    This result can be used to recursively generate candidates for primes with deterministic proofs: given a large prime $p$, consider $n = 2pq + 1$ where $q$ is some large random natural number less than $p/2$.
\end{enumerate}


\section{Agrawal-Kayal-Saxena primality test}
The AKS primality test is a deterministic primality test whose run time is polynomial in $\log n$. %It uses pretty much exactly everything we have learned in this class!

For any commutative ring $R$ and any $a,b,m_1,\ldots,m_r\in R$, we write $$a\equiv b\pmod{m_1,\ldots,m_r}\qquad\Longleftrightarrow\qquad a - b \in (m_1,\ldots,m_r).$$ Recall that when $n = p$ is a prime, we have for any $a\in\Z$, the following congruence in $\Z[x]$, $$(x + a)^p\equiv x^p + a^p\equiv x^p + a\pmod{p}.$$
\begin{center}
    \add{Lecture 32 Fri 11/24}
\end{center}
\begin{lemma}\label{lem:np}
    Let $n\geq 2$ be an integer such that for some $a\in\Z$ coprime to $n$,
    $$(x + a)^n \equiv x^n + a\pmod{n}.$$
    Then $n$ is a prime.
\end{lemma}

\begin{proof}
    Suppose for a contradiction that $n$ is not a prime. Let $p<n$ be a prime divisor of $n$. Let $k$ be a positive integer such that $p^k \leq n < p^{k+1}$. Then by Corollary \ref{cor:notdiv}, we have $p\nmid \binom{n}{p^k}$. Since $a$ is coprime to $n$, we have $p\nmid \binom{n}{p^k}a^{n-p^k}$. This gives a nonzero middle term if $p^k < n$. If $p^k = n$, then by Corollary \ref{cor:ndivp}, we have $\nu_p(\binom{n}{p}) = k-1 < \nu_p(n)$ and so $n\nmid \binom{n}{p}a^{n-p}.$
\end{proof}



The key idea of the AKS test is to check the congruence
$$(x + a)^n \equiv x^n + a\pmod{x^r -1, n}$$
for a suitably chosen $r \leq (\log_2 n)^5$ and for positive integers $a\leq \sqrt{\phi(r)}\log_2n \leq (\log_2n)^{3.5}.$ We can use the usual square and multiply method to compute $(x+a)^n$ mod $(x^r - 1,n)$ in polynomial time for each $a$. Hence the full algorithm is in polynomial time. In what follows, we write $\log n$ for $\log_2 n$.

\begin{lemma}
    For $n\geq 3$, there exists a positive integer $r\leq (\log n)^5$ such that either $\gcd(r,n) > 1$ or $o_r(n) > (\log n)^2.$
\end{lemma}

\begin{proof}
    Suppose for a contradiction that for all positve integer $r\leq (\log n)^5$, we have $\gcd(r,n) = 1$ and $r\mid n^d - 1$ for some $d\leq (\log n)^2$. Let $m = \lfloor(\log n)^5\rfloor$. Then $L_m = \lcm(1,2,\ldots,m)$ divides
    $$\prod_{1\leq d\leq (\log n)^2} (n^d - 1) \leq n^{\sum_{1\leq d\leq (\log n)^2}d} \leq n^{(\log n)^4 - 1} = 2^{(\log n)^5 - (\log n)}.$$
    Recall from HW 2 that $L_{m}\geq 2^m$ for any integer $m\geq7$. From $n\geq 3$, we have $m\geq 10$, so $$L_m\geq 2^m\geq 2^{(\log n)^5 - 1}.$$
    We now have a contradiction because $(\log n)^5 - 1 > (\log n)^5 - (\log n)$ for $n\geq 4$.
\end{proof}

\noindent\textbf{Remark}: The bound $$\displaystyle\sum_{1\leq d\leq (\log n)^2}d \leq (\log n)^4 - 1$$ can be improved to about $\frac12(\log n)^4$for large $n$ and we can improve the bound on $r$ to about $\frac12(\log n)^5.$

\vspace{5pt}
\noindent\textbf{Step 1 of AKS}: Find the smallest positive integer $r$ such that $\gcd(r,n) > 1$ or $o_r(n) > (\log n)^2$. 

\v
We know we only need to test at most $(\log n)^5$ different $r$. For each $r$, we simply compute $r, r^2, r^3, \ldots r^{\lfloor(\log n)^2\rfloor}$ mod $n$ to see if any of them is $1$. Hence this step can be done in polynomial time. If $n<(\log n)^5$ is small (only happens when $n < 10^7$) so that this step does not terminate before $r \geq n$, then we have checked that $\gcd(r,n) = 1$ for all $r < n$ and so $n$ is prime. If this step terminates at an $r$ with $\gcd(r,n) > 1$, then $n$ is composite. Suppose now we have found a positive integer $r\leq (\log n)^5$ coprime with $n$ with $o_r(n) > (\log n)^2$. Note this also implies that $\phi(r) > (\log n)^2$. Since $n\not\equiv 1\pmod{r}$, we see that $n$ has a prime divisor $p\not\equiv1\pmod{r}$ so that $o_r(p) > 1$.

\vspace{5pt}
\noindent\textbf{Step 2 of AKS}: For every positive integer $a \leq r$, check if $\gcd(a,n) = 1$.

\v
Suppose Step 2 is passed. Then that means we may assume $p > r$. So we have
$$\sqrt{\phi(r)}\log n < \phi(r) < r < p.$$

\vspace{5pt}
\noindent\textbf{Step 3 of AKS}: For every positive integer $a \leq \sqrt{\phi(r)}\log n$, check if $\gcd(a,n) = 1$ and if so, check the congruence
$$(x + a)^n \equiv x^n + a\pmod{x^r -1, n}.$$
\begin{theorem}\label{thm:mainAKS}
    Suppose positive integers $n,r$ and prime $p$ satisfy:
    \begin{itemize}
        \item $o_r(n) > (\log n)^2$
        \item $p\mid n$, $p> r$ and $o_r(p) > 1$
        \item For all positive integers $a < \sqrt{\phi(r)}\log n$, the congruence
        $(x + a)^n \equiv x^n + a\pmod{x^r -1, p}.$
    \end{itemize}
    Then $n$ is a power of $p$.
\end{theorem}

\noindent\textbf{Step 0 of AKS}: Check if $n$ is a perfect power.


\vspace{5pt}
It remains now to prove Theorem \ref{thm:mainAKS}. We may assume that $n\geq 4$. The congruence mod $(x^r - 1,p)$ suggests to look inside $\F_p[x]$ and consider $r$-th roots of unities. Let $d = o_r(p) > 1$. We know that the finite field $\F_{p^d}$ is the smallest field that contains a primitive $r$-th root of unity $\alpha_0$, and thus all the $r$-th roots of unities as powers of $\alpha_0$. Let $$\mu_r = \langle \alpha_0\rangle = \{\alpha_0^k\colon k\in\Z/r\Z\}$$ be the subgroup of all $r$-th roots of unities. Let $\ell = \lfloor \sqrt{\phi(r)}\log n\rfloor < p$. The congruence $$(x + a)^n\equiv x^n + a\pmod{x^r -1, p}$$
translates to: for every $f(x) \in S :=\{x, x+1, \ldots, x+\ell\} \subseteq \F_p[x]$,
$$f(x)^n - f(x^n) = j(x)(x^r - 1)$$
for some $j(x)\in\F_p[x]$. In other words, we have for every $f(x)\in S$, $$f(\alpha)^n = f(\alpha^n) \in \F_{p^d},\mbox{ for every }\alpha\in\mu_r.$$
Note since $\ell < p$, the set $S$ contains $\ell+1$ distinct linear polynomials.

We say a polynomial $g(x)\in\F_p[x]$ \textit{commutes} with a positive integer $m$ if 
$$g(\alpha)^m = g(\alpha^m) \in \F_{p^d},\mbox{ for every }\alpha\in\mu_r.$$
Hence, every element in $S$ commutes with $n$. The following lemmas are immediate:
\begin{lemma}
    Any $g\in \F_p[x]$ commutes with $p$ and $1$.
\end{lemma}

\begin{lemma}
    If $g_1,g_2\in\F_p[x]$ both commute with $m$, then $g_1g_2$ commutes with $m$
\end{lemma}
\begin{center}
    \add{Lecture 33 Mon 11/27}
\end{center}
The next two are less immediate.
\begin{lemma}
    If $g\in\F_p[x]$ commutes with $m_1$ and $m_2$, then $g$ commutes with $m_1m_2$.
\end{lemma}

\begin{proof}
    For any $\alpha\in\mu_r$, we have
    $$g(\alpha)^{m_1m_2} = (g(\alpha^{m_1}))^{m_2} = g(\alpha^{m_1m_2})$$
    since $\alpha^{m_1}\in\mu_r$.
\end{proof}

\begin{lemma}
    If $g\in\F_p[x]$ commutes with $m$ and $p\mid m$, then $g$ commutes with $m/p$.
\end{lemma}

\begin{proof}
    For any $\alpha\in\mu_r$, we have
    $$\big(g(\alpha)^{m/p}\big)^p = g(\alpha)^m =  g(\alpha^m) = g(\alpha^{m/p})^p.$$
    Hence $g(\alpha)^{m/p} = g(\alpha^{m/p})$ because raising to the power $p$ is an automorphism and thus injective on $\F_{p^d}.$
\end{proof}

Let $\bar{S}$ denote the set of polynomials in $\F_p[x]$ that are products of elements in $S$. So $$\bar{S} = \{x^{n_0}(x+1)^{n_1}\cdots(x+\ell)^{n_\ell}\colon n_0,\ldots,n_\ell\geq 0\}.$$ Then every element in $\bar{S}$ commutes with every positive integer of the form $(n/p)^i p^j$. Suppose for a contradiction that $n$ is not a power of $p$. Then the integers $(n/p)^ip^j$ are all distinct for distinct pairs $(i,j)$. However, $\alpha_0^m$ only takes $r$ possible values. In other words, the set
$$T = \{\alpha_0^{(n/p)^ip^j}\colon i,j\geq0\}\subseteq\mu_r$$
is finite. Let $m_1>m_2$ to two integers of the form $(n/p)^ip^j$ such that $\alpha_0^{m_1} = \alpha_0^{m_2}$. Note that this condition is equivalent to $m_1\equiv m_2\pmod{r}$. Then for any $g\in \bar{S}$, we have
$$g(\alpha_0)^{m_1} = g(\alpha_0^{m_1}) = g(\alpha_0^{m_2}) = g(\alpha_0)^{m_2}.$$
Recall that $F_{p^d}$ is the smallest field that contains a primitive $r$-th root of unity and any $g\in \bar{S}$ splits in $\F_p$. Hence all the roots of $g(x)$ are in $\F_p$ while $\alpha_0\notin\F_p$. So $g(\alpha_0)\neq 0$ and we have
$$g(\alpha_0)^{m_1-m_2} = 1.$$

On the other hand, when can $g(\alpha_0) = h(\alpha_0)$ for $g,h\in \bar{S}$? We know that for every integer $m$ of the form $(n/p)^ip^j$, we have
$$g(\alpha_0^m) = g(\alpha_0)^m = h(\alpha_0)^m = h(\alpha_0^m).$$
In other words, every $\alpha\in T$ is a root of $g(x) - h(x)$. Hence if we further require that $\deg(g)$ and $\deg(h)$ are less than $|T|$, then $g = h$. Let $N = |T|$ and let $C(\ell+1,N-1)$ be the number of elements in $\bar{S}$ of degree at most $N-1$. Then we have
$$|\{g(\alpha_0)\colon g\in\bar{S}\}| \geq C(\ell+1,N-1).$$
Hence, if we can find $m_1$ and $m_2$ so that $$m_1 - m_2 < C(\ell+1, N-1),$$ then we would have too many solutions to $x^{m_1-m_2} = 1$, which is a contradiction!

We note that $$N = |\{\alpha_0^{(n/p)^ip^j}\colon i,j\geq 0\}| = |\{(n/p)^ip^j\mbox{ mod }r\colon i,j\geq 0\}|.$$
For $i,j = 0,\ldots,\lfloor\sqrt{N}\rfloor$, we have $(\lfloor\sqrt{N}\rfloor + 1)^2 > N$ distinct integers of the form $(n/p)^ip^j$. There are only $N$ possible congruence classes mod $r$ that they can take. Hence, by the Pigeonhole principle, there exist two distinct integers $m_1>m_2$ among them that are congruent mod $r$. Moreover, $$m_1 - m_2 < m_1 \leq (n/p)^{\lfloor\sqrt{N}\rfloor}p^{\lfloor\sqrt{N}\rfloor} = n^{\lfloor\sqrt{N}\rfloor}.$$
Therefore, it remains to prove that $$n^{\lfloor\sqrt{N}\rfloor}\leq C(\ell+1, N-1).$$
Let's estimate the sizes of the variables involved. By taking $i = j$, we see that $(n/p)^ip^j = n^i$. So we have
$$\{n^i\mbox{ mod }r\colon i\geq 0\} \subseteq \{(n/p)^ip^j\mbox{ mod }r\colon i,j\geq 0\} \subseteq (\Z/r\Z)^\times.$$
In other words,
$$(\log n)^2 < o_r(n) \leq N \leq \phi(r).$$
Let $M = \lfloor\lfloor\sqrt{N}\rfloor\log n\rfloor.$ Then
\begin{eqnarray*}
    n^{\lfloor\sqrt{N}\rfloor} &=& 2^{\lfloor\sqrt{N}\rfloor\log n} \leq 2^{M+1},\\
    \ell + 1  &=& \lfloor\sqrt{\phi(r)}\log n\rfloor + 1 \geq \lfloor \sqrt{N}\log n \rfloor + 1 \geq M + 1,\\
    N - 1 &> &\sqrt{N}\log n - 1 \geq M - 1,\\
    C(\ell+1,N-1) &\geq& C(M+1, M).
\end{eqnarray*}
Hence, it is enough to prove that $$C(M+1, M) \geq 2^{M+1}.$$


Since $x, x+1,\ldots,x+M$ are all distinct linear polynomials in $\F_p[x]$, $C(M+1, M)$ is the same as the number of monomials of the form $x_1^{a_1}\cdots x_{M+1}^{a_{M+1}}$ in $M+1$ variables of degree $a_1 + \cdots + a_{M+1}$ at most $M$. By adding in one more variable $x_0$ and setting $a_0 = M - (a_1 + \cdots + a_{M+1})$, this is the same as the number of monomials of the form $x_0^{a_0}x_1^{a_1}\cdots x_{M+1}^{a_{M+1}}$ in $M+2$ variables of degree exactly $M$.

\begin{theorem}\label{thm:sb}
    The number of monomials of the form $x_1^{a_1}\cdots x_k^{a_k}$ in $k$ variables of degree $d = a_1 + \cdots + a_k$ is $\binom{d+k-1}{k-1}.$
\end{theorem}

In particular, we have
$$C(M+1, M) = \binom{2M+1}{M+1} = \binom{2M+1}{M} > \frac{4^M}{M+1}\geq 2^{M+1}$$
when $2^M \geq 2(M+1)$, which is true for $M\geq3$. Since $n\geq 4$, we have $\log n \geq 2$ and $M\geq 4$.

\vspace{5pt}
The standard proof of Theorem \ref{thm:sb} is the stars and bars method. Imagining placing $d$ stars and $k-1$ bars in $d + k - 1$ slots. The number of ways to do this is $\binom{d+k-1}{k-1}$. The number of stars before the first bar is the exponent of $x_1$. The number of stars between the $i$-th bar and the $(i+1)$-st bar is the exponent of $x_{i+1}$ for $i=1,\ldots,k-2$. The number of stars after the last bar is the exponent of $x_k$.

%\subsection*{Exercises}
%\begin{enumerate}[\thesection .1]
%    \item 
%\end{enumerate}

\begin{center}
    \add{Lecture 34 Wed 11/29}
\end{center}

\section{Lucas-Lehmer primality test}
A Mersenne number is a number of the form $M_n = 2^n - 1$ for some $n\in\N$. Note since $2^d - 1\mid 2^n - 1$ whenever $d\mid n$, in order for $2^n - 1$ to be a prime, $n$ itself must be a prime. However,  when $n=p$ is a prime, $M_p = 2^p - 1$ is not necessarily a prime. For example, $M_{11} = 2047 = 23\times 89$.

A Sophie Germain prime is a prime $p$ such that $2p + 1$ is also prime. The above $p = 11$ is one such example with $2p+1 = 23$ appearing in the factorization of $M_p$. The infinitude of Sophie Germain primes is an open conjecture. The heuristic count for the number of them less than $x$ is about $1.32032\,x/(\ln x)^2.$

\begin{proposition}
    Suppose $p\equiv 3\pmod{4}$ is a Sophie Germain prime. Then $2p+1\mid M_p$ and so $M_p$ is not prime for $p > 3$.
\end{proposition}

\begin{proof}
    From $p\equiv 3\pmod{4}$, we get $2p+1\equiv 7\pmod{8}$. Hence $2$ is a quadratic residue mod $2p+1$. Let $a$ be an integer such that $2\equiv a^2\pmod{2p+1}.$ Then
    $$2^p \equiv a^{2p} \equiv 1\pmod{2p+1}$$
    by Fermat's little theorem. Then $2p+1\mid 2^p - 1$.
\end{proof}

The Lucas-Lehmer primality test is used in general to see whether a Mersenne number $M_p = 2^p - 1$ is prime. The current record for the largest proved prime number is $$2^{82589933} - 1.$$  In the Lucas-Lehmer test, we define the sequence
$$a_0 = 4,\qquad a_{n+1} = a_n^2 - 2\mbox{ for }n\geq 0.$$
We let $\omega = 2 + \sqrt{3}$. Then $\omega^{-1} = 2 - \sqrt{3}$. In other words, $\omega$ is a unit in the ring $$R = \Z[\sqrt{3}] = \{j(\sqrt{3})\colon j(x)\in \Z[x]\} = \{a + b\sqrt{3}\colon a,b\in\Z\} \cong \Z[x]/(x^2 - 3).$$
It is easy to check via induction that $$a_n = \omega^{2^n} + \omega^{-2^n} = \omega^{-2^n}(\omega^{2^{n+1}}+1).$$
Consider $$a_{p-2} = \omega^{-2^{p-2}}(\omega^{2^{p-1}}+1).$$

\begin{theorem}
    Let $p$ be an odd prime. The Mersenne number $M_p = 2^p - 1$ is prime if and only if $a_{p-2}\equiv 0\pmod{M_p}.$
\end{theorem}

\begin{proof}
    Let $q = M_p$. Then $qR = \{qa + qb\sqrt{3}\colon a,b\in\Z\}.$ Hence we see that
    $$a_{p-2}\in q\Z \Longleftrightarrow a_{p-2} \in qR \Longleftrightarrow \omega^{2^{p-1}}=-1\mbox{ in }R/qR \Longleftrightarrow\omega^{\frac{q+1}{2}}=-1\mbox{ in }R/qR.$$

    Suppose first that $a_{p-2}\in q\Z$ and suppose for a contradiction that $q$ is not a prime. Let $r \leq \sqrt{q}$ be a prime divisor of $q$. Then we also have $a_{p-2} \in r\Z$ and so $\omega^{2^{p-1}}=-1$ in $R/rR.$ Then $\omega^{2^p} = 1$ in $R/rR$. The order $o(\omega)$ of $\omega$ in $(R/rR)^\times$ is then a divisor of $2^p$ that doesn't divide $2^{p-1}$. Hence it equals $2^p$, which then must divide $|(R/rR)^\times|$. However, we have a contradiction now because $$|(R/rR)^\times| \leq |R/rR| - 1 = r^2 - 1 \leq q - 1 = 2^p - 2.$$

    Suppose conversely that $q$ is a prime. Since $p$ is odd, we see that $$2^p - 1\equiv 7\pmod{12},\qquad 2^p - 1\equiv 7\pmod{8}.$$
    So by quadratic reciprocity,
    $$\lg{3}{q} = -1,\qquad \lg{2}{q} = 1.$$
    This means that the polynomial $x^2 - 3$ is irreducible in $\F_q[x]$ and so $$R/qR \cong \F_q[x]/(x^2 - 3) \cong\F_{q^2}.$$ The Frobenius map $a\mapsto a^q$ sends $\sqrt{3}$ to $-\sqrt{3}$. This can also be seen from $$\sqrt{3}^{q-1} = 3^{(q-1)/2} = -1 \in R/qR.$$
    For any $a + b\sqrt{3}$ in $R/qR$, we then have
    $$(a + b\sqrt{3})^q = a^q + b^q\sqrt{3}^q = a - b\sqrt{3}$$
    and so
    $$(a + b\sqrt{3})^{q+1} = (a + b\sqrt{3})^q (a + b\sqrt{3}) = (a - b\sqrt{3})(a + b\sqrt{3}) = a^2 - 3b^2.$$
    We note that $(3 + \sqrt{3})^2 = 12 + 6\sqrt{3} = 6\,\omega$. Hence
    $$\omega^{(q+1)/2} = \frac{(3 + \sqrt{3})^{q+1}}{6^{(q-1)/2}\cdot 6} = \frac{3^2 - 3\cdot 1^2}{2^{(q-1)/2}3^{(q-1)/2}\cdot 6} = \frac{6}{-6} = -1,$$
    as desired.
\end{proof}

In the above proof, the fact that $(a + b\sqrt{3})^{q+1}\in\F_q$ is a consequence of a more general construction. We note that $\Aut_{\F_q}(\F_{q^2}) = \{\text{id}, \tau\}$ where $\tau$ denotes the Frobenius map and
$$(a + b\sqrt{3})^{q+1} = \text{id}(a + b\sqrt{3})\cdot\tau(a + b\sqrt{3}) = \prod_{\sigma\in\Aut_{\F_q}(\F_{q^2})}\sigma(a + b\sqrt{3}).$$
It is then not surprising that it is fixed by every element in $\Aut_{\F_q}(\F_{q^2})$ and so it must lie in $\F_q$. In general, given a Galois extension $E/F$, we have the norm
$$N_{E/F}(\alpha) = \prod_{\sigma\in\Aut_F(E)}\sigma(\alpha) \in F.$$
For $\C/\R$, this is simply $$N_{\C/\R}(z) = z\cdot\bar{z} = |z|^2.$$
We next consider $\Q(\zeta_4)$ and $\Q(\zeta_3)$, which both have degree $2$ over $\Q$, and where the non-identity automorphism is complex conjugation. So their norm maps are also just the complex modulus squared.

\begin{center}
    \add{Lecture 35 Fri 12/01}
\end{center}
\section{$\Q(\zeta_4)$ and $\Q(\zeta_3)$}
In this section, we consider the two cyclotomic extensions of degree $2$. We have
\begin{eqnarray*}
    \Q[x]/(x^2 + 1) &\cong& \Q(\zeta_4) = \{a + bi\colon a,b\in\Q\} = \Q(i)\\
    \Q[x]/(x^2 + x + 1) &\cong& \Q(\zeta_3) = \{a + b\zeta_3\colon a,b\in\Q\} = \Q(-\frac12 + \frac{\sqrt{3}}{2}i)\\
\end{eqnarray*}
Note that $\phi(6) = 2$ so $\Q(\zeta_6)$ also has degree $2$, but $\zeta_6 = \frac12 + \frac{\sqrt{3}}{2}i = \zeta_3 + 1$. So $\Q(\zeta_6) = \Q(\zeta_3)$. Let $\tau$ denote the non-identity element of the automorphism groups $\Aut_\Q(\Q(\zeta_4))$ and $\Aut_\Q(\Q(\zeta_3)).$ For $\Q(\zeta_4)$, we have for any $a,b\in\Q$,
$$\tau(i) = i^3 = -i\qquad\Longrightarrow\qquad \tau(a + bi) = a - bi,$$
and for $\Q(\zeta_3)$, we have
$$\tau(\zeta_3) = \zeta_3^2 = -1 - \zeta_3 = -\frac12 - \frac{\sqrt{3}}{2}i = \overline{\zeta_3}\qquad\Longrightarrow\qquad \tau(a + b\zeta_3) = a - b - b\zeta_3.$$
In other words, $\tau$ is complex conjugation for both of them. Define the \textbf{norm} of an element in either field as
$$N(\alpha) = \tau(\alpha)\alpha = |\alpha|^2:\qquad N(a + bi) = a^2 + b^2,\qquad N(a + b\zeta_3) = (a - \frac{b}{2})^2 + \frac34b^2 = a^2 - ab + b^2.$$
Note that the norm function is multiplicative: $N(\alpha\beta) = N(\alpha)N(\beta)$. So from 
$$(a + bi)(c + di) = ac - bd + (ad + bc)i$$
we have the well-known formula
$$(a^2 + b^2)(c^2 + d^2) = (ac - bd)^2 + (ad + bc)^2;$$
and from 
$$(a + b\zeta_3)(c + d\zeta_3) = ac + (bc + ad)\zeta_3 + bd(-1-\zeta_3) = ac - bd + (bc + ad - bd)\zeta_3$$
we have the less-known formula
$$(a^2 - ab + b^2)(c^2 - cd + d^2) = (ac - bd)^2 - (ac - bd)(bc + ad - bd) + (bc + ad - bd)^2.$$
If we use the above formula with $a,b,c,d\in\Z$, we see that the sets
\begin{eqnarray*}
    S_4 &=& \{a^2 + b^2\colon a,b\in\Z\}\\
    S_3 &=& \{a^2 - ab + b^2\colon a,b\in\Z\}
\end{eqnarray*}
are closed under multiplication. Hence to understand what they are, it remains to understand which prime powers do $S_4$ and $S_3$ contain. They clearly contain $p^2$ for every prime $p$ by taking $a = p$ and $b = 0$. It is easy to check that $2\in S_4$, $2\notin S_3$ and $3\in S_3$.

Suppose $p>2$ is a prime and $p = a^2 + b^2$ for some $a,b\in\Z$. Then $a^2\equiv -b^2\pmod{p}$. If $p\mid b$, then $p\mid a^2$ implying that $p\mid a$ and so $p^2\mid a^2 + b^2$ which is not possible. So $p\nmid b$ and we have $(ab^{-1})^2\equiv -1\pmod{p}$. Hence $p\equiv 1\pmod{4}$.
Similarly, if $p = a^2 - ab + b^2$ for $a,b\in\Z$ and $p>2$ prime. We have $p\nmid b$ and $(2ab^{-1} - 1)^2\equiv -3\pmod{p}$. It then follows from quadratic reciprocity that $p=3$ or $p\equiv 1\pmod{3}$. The converse is also true.

\begin{theorem}\label{thm:p14}
    If $p$ is a prime congruent to $1$ mod $4$, then there exist $a,b\in\Z$ such that $p = a^2 + b^2$.
\end{theorem}

\begin{theorem}\label{thm:p23}
    If $p$ is a prime congruent to $1$ mod $3$, then there exist $a,b\in\Z$ such that $p = a^2 - ab + b^2$.
\end{theorem}

We give a ring-theoretic proof of these results. There is also a ``descent''-type proof. We note that if $p\equiv 1\pmod{m}$, then $m\mid p-1$ so $\F_p$ contains a primitive $m$-th root of unity. In other words, $\pi_p(\Phi_m(x))$ splits completely in $\F_p[x]$. Let $x - n$ be an irreducible factor of it. Then we have a prime ideal $I_p = (p, \zeta_m - n)$ in $\Z[\zeta_m]$.

\begin{proposition}\label{prop:34Euc}
    The rings $\Z[\zeta_4]$ and $\Z[\zeta_3]$ are Euclidean domains with respect to the norm function.
\end{proposition}

As a consequence, we see that $\Z[\zeta_m]$ is a PID for $m = 3$ and $4$. There then exists some $\alpha\in\Z[\zeta_m]$ such that $I_p = (\alpha)$. We write $p = \alpha\beta$ for some $\beta\in\Z[\zeta_m]$. Taking norm gives $p^2 = N(\alpha)N(\beta)$. Next we note that if $N(\gamma) = 1$ for some $\gamma\in\Z[\zeta_m]$, then $\gamma\cdot \tau(\gamma) = 1$ and so $\gamma$ is a unit. (\textbf{Exercise}: Conversely, if $\gamma$ is a unit, then $N(\gamma) = 1$.) Since $I_p$ is a proper ideal, we see that $\alpha$ can't be a unit. If $\beta$ is a unit, then $I_p = (p)$ but $p\nmid \zeta_m - n$. So neither $N(\alpha)$ nor $N(\beta)$ can be $1$ but they multiply to $p^2$ and $p$ is a prime. So $N(\alpha) = N(\beta) = p$. Upon writing $\alpha = a + b\zeta_m$ for $a,b\in\Z$, we have
$$p = a^2 + b^2\mbox{ for }m=4,\qquad\mbox{and}\qquad p = a^2 - ab + b^2\mbox{ for }m=3.$$


\noindent\textbf{Proof of Proposition \ref{prop:34Euc}}:
    Let $\alpha,\beta\in \Z[\zeta_m]$ where $m = 3$ or $4$ and $\alpha\neq 0$. We divide $\beta$ by $\alpha$ in the field $\Q(\zeta_m) = \Q[\zeta_m]$ to get $$\frac{\beta}{\alpha} = t + s\zeta_m,\qquad r,s\in\Q.$$
    Let $a\in\Z$ be an integer that is the closest to $t$ and let $b\in\Z$ be an integer that is the closest to $s$. (In other words, either the floor or ceiling of $t$ and $s$.) Hence
    $$\frac{\beta}{\alpha} = (a + b\zeta_m) + \big((t - a) + (s - b)\zeta_m\big),\qquad |t-a| \leq \frac12,\qquad |s - b| \leq \frac12.$$
    Then
    $$N\big((t - a) + (s - b)\zeta_m\big) \leq |t-a|^2 + |t-a||s-b| + |s-b|^2 \leq \frac34 < 1.$$
    We let $q =  a+ b\zeta_m \in\Z[\zeta_m]$ and $r = \beta - \alpha q = \alpha\big((t - a) + (s - b)\zeta_m\big) \in\Z[\zeta_m].$ Then
    $N(r) < N(\alpha).$ $\Box$

\vspace{5pt}
\noindent\textbf{Remark}: When $t = 1/2$ for example, there are two choices for $a$. Hence the ``quotient'' and ``remainder'' are not unique in this division algorithm. The same argument also works for $\Z[\sqrt{2}i]$, $\Z[\sqrt{2}]$ and $\Z[\sqrt{3}].$



\begin{center}
    \add{Lecture 36 Mon 12/04}
\end{center}
The units in $\Z[\zeta_m]$ for $m=3,4$ are elements of the form $a+b\zeta_m$ with norm dividing $1$, and so equaling $1$ since it is non-negative. It is easy to check that
\begin{eqnarray*}
    \Z[i]^\times &=& \{1, -1, i, -i\} = \mu_4,\\
    \Z[\zeta_3]^\times &=& \{1, -1, \zeta_3, -\zeta_3, 1 + \zeta_3, -1 - \zeta_3\} = \mu_6.
\end{eqnarray*}
There is an intrinsic reason for this. The roots of unities are clearly units. The norms for these rings are sums of squares and so there are only finitely many integer solutions to $N = 1$, implying that the group of units is finite. Every element of a finite group has a finite order, and is thus a root of unity.

Since $\Z[i]$ and $\Z[\zeta_3]$ are PIDs, we can define prime elements (generate a prime ideal), gcds and we have unique factorization into primes up to units. We use this property of $\Z[\zeta_3]$ to prove that there are no integer solutions to $x^3 + y^3 = z^3$ with $xyz\neq 0$. We write $\zeta$ for $\zeta_3$ and write $\gcd(\alpha,\beta)$ for some element that generates the ideal $(\alpha,\beta)$ in $\Z[\zeta]$.

\begin{theorem}
    There do not exist nonzero $\alpha,\beta,\gamma\in\Z[\zeta]$ and a unit $\epsilon\in\Z[\zeta]^\times$ such that $$\alpha^3 + \beta^3 + \epsilon\gamma^3 = 0.$$
\end{theorem}

Suppose a solution $(\alpha,\beta,\gamma,\epsilon)$ exists. We take one so that $N(\alpha\beta\gamma)$ is the smallest. If there is a prime $\pi\in\Z[\zeta]$ dividing two of $\alpha,\beta,\gamma$, then it divides the cube of the third and so also the third,  but then $(\alpha/\pi,\beta/\pi,\gamma/\pi,\epsilon)$ is a smaller solution. Hence $\alpha,\beta,\gamma$ are pairwise coprime. We use a descent argument: we construct another solution $(\alpha',\beta',\gamma',\epsilon')$ with $N(\alpha'\beta'\gamma')<N(\alpha\beta\gamma)$.

Let $\pi = \sqrt{3}\,i = 1 + 2\zeta$. Then $N(\pi) = 1-2+2^2 =3$ and $\pi^2 = -3$. Hence $\pi$ is a prime and we have an isomorphism $$\Z[\zeta]/(\pi)\cong \F_3$$
sending $a + b\zeta + (\pi)$ to $b - 2a$.

\begin{lemma}
    If $\delta\equiv e\pmod{\pi}$ where $e = \pm1$, then $\delta^3\equiv e \pmod{9}$.
\end{lemma}

\begin{proof}
    Suppose $\delta = e + \pi\eta$ for some $\eta\in\Z[\zeta]$. Using $e^2 = 1$ and $e^3 = e$, we have
    $$\delta^3 = e + 3\pi\eta + 3e(-3)\eta^2 - 3\pi\eta^3 \equiv e + 3\pi(\eta-\eta^3) \pmod{9}.$$
    Since $\Z[\zeta]/(\pi)\cong \F_3$, we have $\eta^3\equiv \eta\pmod{\pi}$ and so $3\pi^2\mid 3\pi(\eta-\eta^3)$ but $3\pi^2 = -9$.
\end{proof}

\begin{lemma}
    If $\epsilon\in\Z[\zeta]^\times$, then $\pm1\pm1\pm\epsilon\not\equiv 0\pmod{9}$. Moreover, if $\pm1 + \epsilon(\pm1)\equiv 0\pmod{3}$, then  $\epsilon = \pm1 = \epsilon^3$.
\end{lemma}

As a result, we see that $\pi$ divides exactly one of $\alpha,\beta,\gamma$. If $\pi\mid\alpha$ so that $3\mid \alpha^3$, then we have $\epsilon = \epsilon^3$ so that $(\beta,\epsilon\gamma,\alpha,1)$ is a solution where $\pi$ divides the third argument. %We prove first that we may assume 
 Hence, we may assume without loss of generality that $\pi\mid\gamma$. Now from $\pi\mid \alpha^3 + \beta^3$, we have $\pi\mid \alpha + \beta$ since $(\alpha^3 + \beta)^3 \equiv (\alpha+\beta)^3\pmod{\pi}.$ So we may assume $\alpha\equiv 1\pmod{\pi}$ and $\beta\equiv -1\pmod{\pi}.$ This then gives $\alpha^3 + \beta^3\equiv 0\pmod{9}$ and so we must have $\pi^2\mid\gamma$. In other words, we have $$\alpha\equiv 1\pmod{\pi},\qquad\beta\equiv -1\pmod{\pi},\qquad\pi^2\mid\gamma.$$
 We now factor
$$
    -\epsilon\gamma^3 = (\alpha+\beta)(\alpha^2 - \alpha\beta + \beta^2)= (\alpha + \beta)(\alpha + \beta\zeta)(\alpha - \beta(1+\zeta)).
$$
Note that since $\zeta\equiv 1\pmod{\pi}$, we see that all three factors are divisible by $\pi$. Hence we have
$$(\pi) \supseteq (\alpha+\beta, \alpha+\beta\zeta) \supseteq (\alpha(\zeta-1),\beta(\zeta-1)) = (\zeta-1) = (\pi).$$
The same is true for any two terms in the product. In other words, once we remove one factor of $\pi$ from each of them, we have three pairwise coprime elements that multiply to a cube, up to a unit. Hence they must each be a cube, up to a unit. In other words, we have the following factorization: 
\begin{eqnarray*}
    \alpha + \beta &=& \epsilon_1\pi\delta^3\\
    \alpha + \beta\zeta &=& \epsilon_2\pi\eta^3\\
    \alpha - \beta(1+\zeta) &=& \epsilon_3\pi\rho^3\\
    \gamma &=&\pi\delta\eta\rho
\end{eqnarray*}
where $\delta,\eta,\rho\in\Z[\zeta]$ are pairwise coprime and $\epsilon_1,\epsilon_2,\epsilon_3$ are units. Note since $\pi^2\mid\gamma$, axactly one of $\delta, \eta, \rho$ is divisible by $\pi$.
Multiplying the second equation by $\zeta$ and the third by $\zeta^2$, which are both units, we have
\begin{eqnarray*}
    \alpha + \beta &=& \epsilon_1\pi\delta^3\\
    \alpha\zeta + \beta\zeta^2 &=& \epsilon_4\pi\eta^3\\
    \alpha\zeta^2 + \beta\zeta &=& \epsilon_5\pi\rho^3
\end{eqnarray*}
for some units $\epsilon_4,\epsilon_5$. Adding them gives
$$\epsilon_1\pi\delta^3 + \epsilon_4\pi\eta^3 + \epsilon_5\pi\rho^3 = 0$$
which looks very much like the original equation! Suppose without loss of generality that $\pi\mid\rho$ and $\pi\nmid\delta,\eta$. We divide the above equation by $\epsilon_1\pi$ to get
$$\delta^3 + \epsilon_6\eta^3 + \epsilon_7\rho^3 = 0,$$
for some units $\epsilon_6,\epsilon_7$. From $\pi\mid\rho$, we get $\pm1+\epsilon_6(\pm1)\equiv 0\pmod{3}$ and so $\epsilon_6 = \pm1 = \epsilon_6^3$. Then $(\delta, \epsilon_6\eta, \rho, \epsilon_7)$ is another but smaller solution:
$$N(\delta\cdot\epsilon_6\eta\cdot\rho) = N(\delta\eta\rho)  = N(\gamma/\pi) < N(\gamma) \leq N(\alpha\beta\gamma).$$

\end{document}

